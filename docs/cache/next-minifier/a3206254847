{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{\"6Joi\":function(t,e,n){\"use strict\";(function(t){Object.defineProperty(e,\"__esModule\",{value:!0});var r,i,o=(r=n(\"wj3C\"))&&\"object\"===typeof r&&\"default\"in r?r.default:r,a=n(\"q/0M\"),s=n(\"mrSG\"),u=n(\"zVF4\"),c=n(\"x7I3\"),h=o.SDK_VERSION,l=new a.Logger(\"@firebase/firestore\");function f(){return l.logLevel===a.LogLevel.DEBUG?i.DEBUG:l.logLevel===a.LogLevel.SILENT?i.SILENT:i.ERROR}function p(t){switch(t){case i.DEBUG:l.logLevel=a.LogLevel.DEBUG;break;case i.ERROR:l.logLevel=a.LogLevel.ERROR;break;case i.SILENT:l.logLevel=a.LogLevel.SILENT;break;default:l.error(\"Firestore (\"+h+\"): Invalid value passed to `setLogLevel`\")}}function d(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=a.LogLevel.DEBUG){var i=n.map(y);l.debug.apply(l,[\"Firestore (\"+h+\") [\"+t+\"]: \"+e].concat(i))}}function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(l.logLevel<=a.LogLevel.ERROR){var r=e.map(y);l.error.apply(l,[\"Firestore (\"+h+\"): \"+t].concat(r))}}function y(t){if(\"string\"===typeof t)return t;var e=b.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}function g(t){var e=\"FIRESTORE (\"+h+\") INTERNAL ASSERTION FAILED: \"+t;throw m(e),new Error(e)}function v(t,e){t||g(e)}!function(t){t[t.DEBUG=0]=\"DEBUG\",t[t.ERROR=1]=\"ERROR\",t[t.SILENT=2]=\"SILENT\"}(i||(i={}));var b=function(){function t(){}return t.setPlatform=function(e){t.platform&&g(\"Platform already defined\"),t.platform=e},t.getPlatform=function(){return t.platform||g(\"Platform not set\"),t.platform},t}();function w(){return b.getPlatform().emptyByteString}var E={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},T=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name=\"FirebaseError\",r.toString=function(){return r.name+\": [code=\"+r.code+\"]: \"+r.message},r}return s.__extends(e,t),e}(Error);function I(t,e){function n(){var t=\"This constructor is private.\";throw e&&(t+=\" \",t+=e),new T(E.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function C(t,e){return void 0!==t?t:e}function _(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function A(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N(t){for(var e in v(null!=t&&\"object\"===typeof t,\"isEmpty() expects object parameter.\"),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function D(t,e){if(0!==e.length)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() does not support arguments, but was called with \"+G(e.length,\"argument\")+\".\")}function k(t,e,n){if(e.length!==n)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires \"+G(n,\"argument\")+\", but was called with \"+G(e.length,\"argument\")+\".\")}function O(t,e,n){if(e.length<n)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires at least \"+G(n,\"argument\")+\", but was called with \"+G(e.length,\"argument\")+\".\")}function R(t,e,n,r){if(e.length<n||e.length>r)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires between \"+n+\" and \"+r+\" arguments, but was called with \"+G(e.length,\"argument\")+\".\")}function M(t,e,n,r){F(t,e,W(n)+\" argument\",r)}function P(t,e,n,r){void 0!==r&&M(t,e,n,r)}function L(t,e,n,r){F(t,e,n+\" option\",r)}function x(t,e,n,r){void 0!==r&&L(t,e,n,r)}function q(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+e+\" option to be an array, but it was: \"+B(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires all \"+e+\" elements to be \"+n+\", but the value at index \"+o+\" was: \"+B(r[o]))}(t,e,n,r,i)}function V(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(B(u))}var c=B(r);throw new T(E.INVALID_ARGUMENT,\"Invalid value \"+c+\" provided to function \"+t+'() for option \"'+n+'\". Acceptable values: '+o.join(\", \"))}(t,0,n,r,i)}function F(t,e,n,r){if(!(\"object\"===e?U(r):\"non-empty string\"===e?\"string\"===typeof r&&\"\"!==r:typeof r===e)){var i=B(r);throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+n+\" to be of type \"+e+\", but it was: \"+i)}}function U(t){return\"object\"===typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function B(t){if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"string\"===typeof t)return t.length>20&&(t=t.substring(0,20)+\"...\"),JSON.stringify(t);if(\"number\"===typeof t||\"boolean\"===typeof t)return\"\"+t;if(\"object\"===typeof t){if(t instanceof Array)return\"an array\";var e=function(t){if(t.constructor){var e=/function\\s+([^\\s(]+)\\s*\\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?\"a custom \"+e+\" object\":\"an object\"}return\"function\"===typeof t?\"a function\":g(\"Unknown wrong type: \"+typeof t)}function j(t,e,n){if(void 0===n)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires a valid \"+W(e)+\" argument, but it was undefined.\")}function K(t,e,n){A(e,function(e,r){if(n.indexOf(e)<0)throw new T(E.INVALID_ARGUMENT,\"Unknown option '\"+e+\"' passed to function \"+t+\"(). Available options: \"+n.join(\", \"))})}function Q(t,e,n,r){var i=B(r);return new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+W(n)+\" argument to be a \"+e+\", but it was: \"+i)}function W(t){switch(t){case 1:return\"first\";case 2:return\"second\";case 3:return\"third\";default:return t+\"th\"}}function G(t,e){return t+\" \"+e+(1===t?\"\":\"s\")}var z=function(){function t(){}return t.newId=function(){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",e=\"\",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return v(20===e.length,\"Invalid auto ID: \"+e),e},t}();function H(t,e){return t<e?-1:t>e?1:0}function Y(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function X(t){return t+\"\\0\"}function J(){if(\"undefined\"===typeof Uint8Array)throw new T(E.UNIMPLEMENTED,\"Uint8Arrays are not available in this environment.\")}function $(){if(!b.getPlatform().base64Available)throw new T(E.UNIMPLEMENTED,\"Blobs are unavailable in Firestore in this environment.\")}var Z,tt=function(){function t(t){$(),this._binaryString=t}return t.fromBase64String=function(e){k(\"Blob.fromBase64String\",arguments,1),M(\"Blob.fromBase64String\",\"string\",1,e),$();try{return new t(b.getPlatform().atob(e))}catch(n){throw new T(E.INVALID_ARGUMENT,\"Failed to construct Blob from Base64 string: \"+n)}},t.fromUint8Array=function(e){if(k(\"Blob.fromUint8Array\",arguments,1),J(),!(e instanceof Uint8Array))throw Q(\"Blob.fromUint8Array\",\"Uint8Array\",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(\"\"))},t.prototype.toBase64=function(){return k(\"Blob.toBase64\",arguments,0),$(),b.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){k(\"Blob.toUint8Array\",arguments,0),J();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return\"Blob(base64: \"+this.toBase64()+\")\"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return H(this._binaryString,t._binaryString)},t}(),et=I(tt,\"Use Blob.fromUint8Array() or Blob.fromBase64String() instead.\"),nt=function(){return function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}(),rt=\"(default)\",it=function(){function t(t,e){this.projectId=t,this.database=e||rt}return Object.defineProperty(t.prototype,\"isDefaultDatabase\",{get:function(){return this.database===rt},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return H(this.projectId,t.projectId)||H(this.database,t.database)},t}(),ot=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),at=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&g(\"offset \"+e+\" out of range \"+t.length),void 0===n?n=t.length-e:n>t.length-e&&g(\"length \"+n+\" out of range \"+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,\"length\",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):\"string\"===typeof e?n.push(e):g(\"Unknown parameter type for Path.child(): \"+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,v(this.length>=t,\"Can't call popFirst() with less segments\"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return v(!this.isEmpty(),\"Can't call popLast() on empty path\"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return v(!this.isEmpty(),\"Can't call firstSegment() on empty path\"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return v(t<this.length,\"Index out of range\"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.canonicalString=function(){return this.toArray().join(\"/\")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf(\"//\")>=0)throw new T(E.INVALID_ARGUMENT,\"Invalid path (\"+t+\"). Paths must not contain // in them.\");return new e(t.split(\"/\").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(at),ut=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.isValidIdentifier=function(t){return ut.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(\"\\\\\",\"\\\\\\\\\").replace(\"`\",\"\\\\`\"),e.isValidIdentifier(t)||(t=\"`\"+t+\"`\"),t}).join(\".\")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&\"__name__\"===this.get(0)},e.keyField=function(){return new e([\"__name__\"])},e.fromServerFormat=function(t){for(var n=[],r=\"\",i=0,o=function(){if(0===r.length)throw new T(E.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\");n.push(r),r=\"\"},a=!1;i<t.length;){var s=t[i];if(\"\\\\\"===s){if(i+1===t.length)throw new T(E.INVALID_ARGUMENT,\"Path has trailing escape character: \"+t);var u=t[i+1];if(\"\\\\\"!==u&&\".\"!==u&&\"`\"!==u)throw new T(E.INVALID_ARGUMENT,\"Path has invalid escape sequence: \"+t);r+=u,i+=2}else\"`\"===s?(a=!a,i++):\".\"!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new T(E.INVALID_ARGUMENT,\"Unterminated ` in path: \"+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(at),ht=function(){function t(e){this.path=e,v(t.isDocumentKey(e),\"Invalid DocumentKey with an odd number of segments: \"+e.toArray().join(\"/\"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===st.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return st.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2===0},t.fromSegments=function(e){return new t(new st(e.slice()))},t.fromPathString=function(e){return new t(st.fromString(e))},t.EMPTY=new t(new st([])),t}(),lt=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}();!function(t){t.All=\"all\",t.ListenStreamIdle=\"listen_stream_idle\",t.ListenStreamConnectionBackoff=\"listen_stream_connection_backoff\",t.WriteStreamIdle=\"write_stream_idle\",t.WriteStreamConnectionBackoff=\"write_stream_connection_backoff\",t.OnlineStateTimeout=\"online_state_timeout\",t.ClientMetadataRefresh=\"client_metadata_refresh\",t.LruGarbageCollection=\"lru_garbage_collection\"}(Z||(Z={}));var ft=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new T(E.CANCELLED,\"Operation cancelled\"+(t?\": \"+t:\"\"))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),pt=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||\"\";throw m(\"INTERNAL UNHANDLED ERROR: \",n),n.indexOf(\"Firestore Test Simulated Error\")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),v(e>=0,\"Attempted to schedule an operation with a negative delay of \"+e),v(!this.containsDelayedOperation(t),\"Attempted to schedule multiple operations with timer id \"+t+\".\");var i=ft.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&g(\"AsyncQueue is already failed: \"+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){v(this.operationInProgress,\"verifyOpInProgress() called when no op in progress on this queue.\")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){if(n[e].timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){v(t===Z.All||e.containsDelayedOperation(t),\"Attempted to drain to missing operation \"+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==Z.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);v(e>=0,\"Delayed operation not found.\"),this.delayedOperations.splice(e,1)},t}(),dt=\"\\x01\",mt=\"\\x01\",yt=\"\\x10\",gt=\"\\x11\";function vt(t){for(var e=\"\",n=0;n<t.length;n++)e.length>0&&(e=wt(e)),e=bt(t.get(n),e);return wt(e)}function bt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case\"\\0\":n+=dt+yt;break;case dt:n+=dt+gt;break;default:n+=o}}return n}function wt(t){return t+dt+mt}function Et(t){var e=t.length;if(v(e>=2,\"Invalid path \"+t),2===e)return v(t.charAt(0)===dt&&t.charAt(1)===mt,\"Non-empty path \"+t+\" had length 2\"),st.EMPTY_PATH;for(var n=e-2,r=[],i=\"\",o=0;o<e;){var a=t.indexOf(dt,o);switch((a<0||a>n)&&g('Invalid encoded resource path: \"'+t+'\"'),t.charAt(a+1)){case mt:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=\"\"),r.push(u);break;case yt:i+=t.substring(o,a),i+=\"\\0\";break;case gt:i+=t.substring(o,a+1);break;default:g('Invalid encoded resource path: \"'+t+'\"')}o=a+2}return new st(r)}var Tt=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new T(E.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(e>=1e9)throw new T(E.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(t<-62135596800)throw new T(E.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t);if(t>=253402300800)throw new T(E.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?H(this.nanoseconds,t.nanoseconds):H(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return\"Timestamp(seconds=\"+this.seconds+\", nanoseconds=\"+this.nanoseconds+\")\"},t}(),It=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Tt(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return\"SnapshotVersion(\"+this.timestamp.toString()+\")\"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Tt(0,0)),t}(),St=function(){function t(t,e){this.comparator=t,this.root=e||_t.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+\":\"+n),!1}),\"{\"+t.join(\", \")+\"}\"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ct(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ct(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ct(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ct(this.root,t,this.comparator,!0)},t}(),Ct=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){v(this.nodeStack.length>0,\"getNext() called on iterator when hasNext() is false.\");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),_t=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw g(\"Red node has red child(\"+this.key+\",\"+this.value+\")\");if(this.right.isRed())throw g(\"Right child of (\"+this.key+\",\"+this.value+\") is red\");var t=this.left.check();if(t!==this.right.check())throw g(\"Black depths differ\");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),At=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new _t(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();_t.EMPTY=new At;var Nt=function(){function t(t){this.comparator=t,this.data=new St(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Dt(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Dt(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),\"SortedSet(\"+t.toString()+\")\"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Dt=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),kt=new St(ht.comparator);function Ot(){return kt}function Rt(){return Ot()}var Mt=new St(ht.comparator);function Pt(){return Mt}var Lt=new St(ht.comparator);function xt(){return Lt}var qt=new Nt(ht.comparator);function Vt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=qt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ft=new Nt(H);function Ut(){return Ft}var Bt=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,v(r.length>0,\"Cannot create an empty mutation batch\")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&v(e.key.isEqual(t),\"applyToRemoteDocument: key \"+t+\" should match maybeDoc key\\n        \"+e.key);var r=n.mutationResults;v(r.length===this.mutations.length,\"Mismatch between mutations length\\n      (\"+this.mutations.length+\") and mutation results length\\n      (\"+r.length+\").\");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&v(e.key.isEqual(t),\"applyToLocalDocument: key \"+t+\" should match maybeDoc key\\n        \"+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime))}for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Vt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Y(this.mutations,t.mutations)&&Y(this.baseMutations,t.baseMutations)},t}(),jt=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){v(e.mutations.length===r.length,\"Mutations sent \"+e.mutations.length+\" must equal results received \"+r.length);for(var o=xt(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),Kt=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&g(\"Called next() or catch() twice for PersistencePromise\"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Qt=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return v(\"\"!==e.uid,\"UserID must not be an empty string.\"),new t(e.isAuthenticated()?e.uid:\"\",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ht(t).iterate({index:Pe.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=zt(n),Xt(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=zt(e),Xt(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Yt(t),a=Ht(t);return a.add({}).next(function(s){v(\"number\"===typeof s,\"Auto-generated key is not a number\");var u=new Bt(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u);i.documentKeysByBatchId[s]=u.keys();for(var h=[],l=0,f=r;l<f.length;l++){var p=f[l],d=Le.key(i.userId,p.key.path,s);h.push(a.put(c)),h.push(o.put(d,Le.PLACEHOLDER)),h.push(i.indexManager.addToCollectionParentIndex(t,p.key.path.popLast()))}return Kt.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Ht(t).get(e).next(function(t){return t?(v(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?Kt.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ht(t).iterate({index:Pe.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(v(e.batchId>=r,\"Should have found mutation after \"+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ht(t).loadAll(Pe.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Le.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Yt(t).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],c=r[2],h=Et(u);if(s===n.userId&&e.path.isEqual(h))return Ht(t).get(c).next(function(t){if(!t)throw g(\"Dangling document-mutation reference found: \"+r+\" which points to \"+c);v(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+c),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Nt(H),i=[];return e.forEach(function(e){var o=Le.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Yt(t).iterate({range:a},function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Et(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),Kt.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;v(!e.isDocumentQuery(),\"Document queries shouldn't go down this path\"),v(!e.isCollectionGroupQuery(),\"CollectionGroup queries should be handled in LocalDocumentsView\");var r=e.path,i=r.length+1,o=Le.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Nt(H);return Yt(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=Et(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ht(t).get(e).next(function(t){if(null===t)throw g(\"Dangling document-mutation reference found, which points to \"+e);v(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),Kt.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return Gt(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),Kt.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Kt.resolve();var r=IDBKeyRange.lowerBound(Le.prefixForUser(e.userId)),i=[];return Yt(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=Et(t[1]);i.push(o)}else r.done()}).next(function(){v(0===i.length,\"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: \"+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return Wt(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return Xt(t).get(this.userId).next(function(t){return t||new Me(e.userId,-1,\"\")})},t}();function Wt(t,e,n){var r=Le.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Yt(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()}).next(function(){return a})}function Gt(t,e,n){var r=t.store(Pe.store),i=t.store(Le.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(t,e,n){return s++,n.delete()});o.push(u.next(function(){v(1===s,\"Dangling document-mutation reference found: Missing batch \"+n.batchId)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Le.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Kt.waitFor(o).next(function(){return c})}function zt(e){return e instanceof Uint8Array?(v(\"YES\"===t.env.USE_MOCK_PERSISTENCE,\"Persisting non-string stream tokens is only supported with mock persistence.\"),e.toString()):e}function Ht(t){return fn.getStore(t,Pe.store)}function Yt(t){return fn.getStore(t,Le.store)}function Xt(t){return fn.getStore(t,Me.store)}var Jt,$t=1;!function(t){t[t.QueryCache=0]=\"QueryCache\",t[t.SyncEngine=1]=\"SyncEngine\"}(Jt||(Jt={}));var Zt=function(){function t(t,e){this.generatorId=t,v((t&$t)===t,\"Generator ID \"+t+\" contains more than \"+$t+\" reserved bits\"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<$t,t},t.prototype.after=function(t){return this.seek(t+(1<<$t)),this.next()},t.prototype.seek=function(t){v((t&$t)===this.generatorId,\"Cannot supply target ID from different generator ID\"),this.nextId=t},t.forQueryCache=function(){return new t(Jt.QueryCache,2)},t.forSyncEngine=function(){return new t(Jt.SyncEngine)},t}(),te=\"SimpleDb\",ee=function(){function e(t){this.db=t,12.2===e.getIOSVersion(u.getUA())&&m(\"Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\")}return e.openOrCreate=function(t,n,r){return v(e.isAvailable(),\"IndexedDB not supported in current environment.\"),d(te,\"Opening database:\",t),new Kt(function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){var n=t.target.result;i(new e(n))},a.onblocked=function(){o(new T(E.FAILED_PRECONDITION,\"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed.\"))},a.onerror=function(t){var e=t.target.error;\"VersionError\"===e.name?o(new T(E.FAILED_PRECONDITION,\"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.\")):o(e)},a.onupgradeneeded=function(e){d(te,'Database \"'+t+'\" requires upgrade from version:',e.oldVersion);var n=e.target.result,i=new re(a.transaction);r.createOrUpgrade(n,i,e.oldVersion,De).next(function(){d(te,\"Database upgrade to version \"+De+\" complete\")})}}).toPromise()},e.delete=function(t){return d(te,\"Removing database:\",t),oe(window.indexedDB.deleteDatabase(t)).toPromise()},e.isAvailable=function(){if(null==window.indexedDB)return!1;if(void 0===window.navigator)return\"YES\"===t.env.USE_MOCK_PERSISTENCE;var n=u.getUA(),r=e.getIOSVersion(n),i=0<r&&r<10,o=e.getAndroidVersion(n),a=0<o&&o<4.5;return!(n.indexOf(\"MSIE \")>0||n.indexOf(\"Trident/\")>0||n.indexOf(\"Edge/\")>0||i||a)},e.getStore=function(t,e){return t.store(e)},e.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\\d_]+)/i),n=e?e[1].split(\"_\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.getAndroidVersion=function(t){var e=t.match(/Android ([\\d.]+)/i),n=e?e[1].split(\".\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},e.prototype.runTransaction=function(t,e,n){var r=re.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),Kt.reject(t)}).toPromise();return i.catch(function(){}),r.completionPromise.then(function(){return i})},e.prototype.close=function(){this.db.close()},e}(),ne=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,\"isDone\",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"skipToKey\",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"cursor\",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return oe(this.dbCursor.delete())},t}(),re=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new lt,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=se(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,\"completionPromise\",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(d(te,\"Aborting transaction:\",t?t.message:\"Client-initiated abort\"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return v(!!e,\"Object store not part of transaction: \"+t),new ie(e)},t}(),ie=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d(te,\"PUT\",this.store.name,t,e),n=this.store.put(e,t)):(d(te,\"PUT\",this.store.name,\"<auto-key>\",t),n=this.store.put(t)),oe(n)},t.prototype.add=function(t){return d(te,\"ADD\",this.store.name,t,t),oe(this.store.add(t))},t.prototype.get=function(t){var e=this;return oe(this.store.get(t)).next(function(n){return void 0===n&&(n=null),d(te,\"GET\",e.store.name,t,n),n})},t.prototype.delete=function(t){return d(te,\"DELETE\",this.store.name,t),oe(this.store.delete(t))},t.prototype.count=function(){return d(te,\"COUNT\",this.store.name),oe(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){d(te,\"DELETE ALL\",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new Kt(function(n,r){e.onerror=function(t){var e=se(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new Kt(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ne(i),a=e(i.primaryKey,i.value,o);if(a instanceof Kt){var s=a.catch(function(t){return o.done(),Kt.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Kt.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&(\"string\"===typeof t?n=t:(v(void 0===e,\"3rd argument must not be defined if 2nd is a range.\"),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e=\"next\";if(t.reverse&&(e=\"prev\"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function oe(t){return new Kt(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=se(t.target.error);n(e)}})}var ae=!1;function se(t){var e=ee.getIOSVersion(u.getUA());if(e>=12.2&&e<13){var n=\"An internal error was encountered in the Indexed Database server\";if(t.message.indexOf(n)>=0){var r=new T(\"internal\",\"IOS_INDEXEDDB_BUG1: IndexedDb has thrown '\"+n+\"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\");return ae||(ae=!0,setTimeout(function(){throw r},0)),r}}return t}var ue=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=Zt.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return It.fromTimestamp(new Tt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return le(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return ce(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return v(e.targetCount>0,\"Removing from an empty query cache\"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return ce(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return Kt.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return ce(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return he(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,fn.getStore(n,je.store)).put(je.key,e);var n},t.prototype.saveQueryData=function(t,e){return ce(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ce(t).iterate({range:i,index:Ue.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=fe(t);return e.forEach(function(e){var a=vt(e.path);i.push(o.put(new Be(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=fe(t);return Kt.forEach(e,function(e){var o=vt(e.path);return Kt.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=fe(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=fe(t),i=Vt();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=Et(t[1]),o=new ht(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=vt(e.path),r=IDBKeyRange.bound([n],[X(n)],!1,!0),i=0;return fe(t).iterate({index:Be.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return ce(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function ce(t){return fn.getStore(t,Ue.store)}function he(t){return ee.getStore(t,je.store).get(je.key).next(function(t){return v(null!==t,\"Missing metadata row.\"),t})}function le(t){return he(t).next(function(t){return t.highestListenSequenceNumber})}function fe(t){return fn.getStore(t,Be.store)}var pe=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return ht.comparator(t.key,e.key)},t}(),de=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n)||this;return a.data=r,a.proto=o,a.hasLocalMutations=!!i.hasLocalMutations,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return s.__extends(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return\"Document(\"+this.key+\", \"+this.version+\", \"+this.data.toString()+\", {hasLocalMutations: \"+this.hasLocalMutations+\"}), {hasCommittedMutations: \"+this.hasCommittedMutations+\"})\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):g(\"Trying to compare documents on fields that don't exist\")},e}(pe),me=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s.__extends(e,t),e.prototype.toString=function(){return\"NoDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(pe),ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.toString=function(){return\"UnknownDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(pe),ge=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){A(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return N(this.inner)},t}(),ve=function(){function t(){this.changes=Ot(),this.documentSizes=new ge(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges().get(e);return r?Kt.resolve(r):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return v(null!==this.changes,\"Changes have already been applied.\"),this.changes},t}(),be=\"The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.\",we=function(){function t(t,e,n){this.serializer=t,this.indexManager=e,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,\"lastProcessedDocumentChangeId\",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=ee.getStore(t,We.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r=[];if(e.length>0){for(var i=Ie(t),o=Vt(),a=0,s=e;a<s.length;a++){var u=s[a],c=u.key,h=u.doc;r.push(i.put(Ce(c),h)),o=o.add(c),r.push(this.indexManager.addToCollectionParentIndex(t,c.path.popLast()))}this.keepDocumentChangeLog&&r.push(Se(t).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(t,n))}return Kt.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=Ie(t),r=Ce(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return _e(t)}):Kt.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return Ie(t).get(Ce(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return Ie(t).get(Ce(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:_e(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Rt();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Rt(),i=new St(ht.comparator);return this.forEachDbEntry(t,e,function(t,e){e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i=i.insert(t,_e(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return Kt.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Ie(t).iterate({range:r},function(t,e,r){for(var a=ht.fromSegments(t);o&&ht.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this;v(!e.isCollectionGroupQuery(),\"CollectionGroup queries should be handled in LocalDocumentsView\");var r=Pt(),i=e.path.length+1,o=e.path.toArray(),a=IDBKeyRange.lowerBound(o);return Ie(t).iterate({range:a},function(t,o,a){if(t.length===i){var s=n.serializer.fromDbRemoteDocument(o);e.path.isPrefixOf(s.key.path)?s instanceof de&&e.matches(s)&&(r=r.insert(s.key,s)):a.done()}}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;v(this.keepDocumentChangeLog,\"Can only call getNewDocumentChanges() when document change log is enabled\");var n=Vt(),r=Ot(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=Se(t);return a.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(a).next(function(){return Kt.reject(new T(E.DATA_LOSS,be))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new me(n,It.forDeletedDoc());r=r.insert(n,e)}))}),Kt.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return Se(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new Te(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ee(t).get(Fe.key).next(function(t){return v(!!t,\"Missing document cache metadata\"),t})},t.prototype.setMetadata=function(t,e){return Ee(t).put(Fe.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();function Ee(t){return fn.getStore(t,Fe.store)}var Te=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentCache.serializer.toDbRemoteDocument(n),a=e.documentSizes.get(t);v(void 0!==a,\"Attempting to change document \"+t.toString()+\" without having read it first\");var s=_e(o);r+=s-a,i.push({key:t,doc:o})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(ve);function Ie(t){return fn.getStore(t,Ve.store)}function Se(t){return fn.getStore(t,We.store)}function Ce(t){return t.path.toArray()}function _e(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw g(\"Unknown remote document type\");e=t.noDocument}return JSON.stringify(e).length}var Ae=function(){function t(){this.collectionParentIndex=new Ne}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),Kt.resolve()},t.prototype.getCollectionParents=function(t,e){return Kt.resolve(this.collectionParentIndex.getEntries(e))},t}(),Ne=function(){function t(){this.index={}}return t.prototype.add=function(t){v(t.length%2===1,\"Expected a collection path.\");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Nt(st.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.getEntries=function(t){return(this.index[t]||new Nt(st.comparator)).toArray()},t}(),De=8,ke=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;v(n<r&&n>=0&&r<=De,\"Unexpected schema upgrade from v\"+n+\" to v{toVersion}.\"),n<1&&r>=1&&(function(t){t.createObjectStore(Re.store)}(t),function(t){t.createObjectStore(Me.store,{keyPath:Me.keyPath}),t.createObjectStore(Pe.store,{keyPath:Pe.keyPath,autoIncrement:!0}).createIndex(Pe.userMutationsIndex,Pe.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Le.store)}(t),Qe(t),function(t){t.createObjectStore(Ve.store)}(t));var o=Kt.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(Be.store),t.deleteObjectStore(Ue.store),t.deleteObjectStore(je.store)}(t),Qe(t)),o=o.next(function(){return function(t){var e=t.store(je.store),n=new je(0,0,It.MIN.toTimestamp(),0);return e.put(je.key,n)}(e)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return function(t,e){return e.store(Pe.store).loadAll().next(function(n){t.deleteObjectStore(Pe.store);var r=t.createObjectStore(Pe.store,{keyPath:Pe.keyPath,autoIncrement:!0});r.createIndex(Pe.userMutationsIndex,Pe.userMutationsKeyPath,{unique:!0});var i=e.store(Pe.store),o=n.map(function(t){return i.put(t)});return Kt.waitFor(o)})}(t,e)})),o=o.next(function(){!function(t){t.createObjectStore(Ge.store,{keyPath:Ge.keyPath})}(t),function(t){t.createObjectStore(We.store,{keyPath:\"id\",autoIncrement:!0})}(t)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(e)})),n<6&&r>=6&&(o=o.next(function(){return function(t){t.createObjectStore(Fe.store)}(t),i.addDocumentGlobal(e)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(e)})),n<8&&r>=8&&(o=o.next(function(){return i.createCollectionParentIndex(t,e)})),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ve.store).iterate(function(t,n){e+=_e(n)}).next(function(){var n=new Fe(e);return t.store(Fe.store).put(Fe.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Me.store),r=t.store(Pe.store);return n.loadAll().next(function(n){return Kt.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(Pe.userMutationsIndex,i).next(function(r){return Kt.forEach(r,function(r){v(r.userId===n.userId,\"Cannot process batch \"+r.batchId+\" from unexpected user\");var i=e.serializer.fromDbMutationBatch(r);return Gt(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Be.store),n=t.store(Ve.store);return le(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new st(n),a=function(t){return[0,vt(t)]}(o);r.push(e.get(a).next(function(n){return n?Kt.resolve():function(n){return e.put(new Be(0,vt(n),t))}(o)}))}).next(function(){return Kt.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ke.store,{keyPath:Ke.keyPath});var n=e.store(Ke.store),r=new Ne,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:vt(i)})}};return e.store(Ve.store).iterate({keysOnly:!0},function(t,e){var n=new st(t);return i(n.popLast())}).next(function(){return e.store(Le.store).iterate({keysOnly:!0},function(t,e){t[0];var n=t[1],r=(t[2],Et(n));return i(r.popLast())})})},t}();var Oe=function(){return function(t,e){this.seconds=t,this.nanoseconds=e}}(),Re=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store=\"owner\",t.key=\"owner\",t}();var Me=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store=\"mutationQueues\",t.keyPath=\"userId\",t}(),Pe=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store=\"mutations\",t.keyPath=\"batchId\",t.userMutationsIndex=\"userMutationsIndex\",t.userMutationsKeyPath=[\"userId\",\"batchId\"],t}();var Le=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,vt(e)]},t.key=function(t,e,n){return[t,vt(e),n]},t.store=\"documentMutations\",t.PLACEHOLDER=new t,t}();var xe=function(){return function(t,e){this.path=t,this.readTime=e}}(),qe=function(){return function(t,e){this.path=t,this.version=e}}(),Ve=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store=\"remoteDocuments\",t}(),Fe=function(){function t(t){this.byteSize=t}return t.store=\"remoteDocumentGlobal\",t.key=\"remoteDocumentGlobalKey\",t}();var Ue=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store=\"targets\",t.keyPath=\"targetId\",t.queryTargetsIndexName=\"queryTargetsIndex\",t.queryTargetsKeyPath=[\"canonicalId\",\"targetId\"],t}(),Be=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,v(0===t===(void 0!==n),\"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number\")}return t.store=\"targetDocuments\",t.keyPath=[\"targetId\",\"path\"],t.documentTargetsIndex=\"documentTargetsIndex\",t.documentTargetsKeyPath=[\"path\",\"targetId\"],t}(),je=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key=\"targetGlobalKey\",t.store=\"targetGlobal\",t}(),Ke=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store=\"collectionParents\",t.keyPath=[\"collectionId\",\"parent\"],t}();function Qe(t){t.createObjectStore(Be.store,{keyPath:Be.keyPath}).createIndex(Be.documentTargetsIndex,Be.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ue.store,{keyPath:Ue.keyPath}).createIndex(Ue.queryTargetsIndexName,Ue.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(je.store)}var We=function(){function t(t){this.changes=t}return t.store=\"remoteDocumentChanges\",t.keyPath=\"id\",t}();var Ge=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store=\"clientMetadata\",t.keyPath=\"clientId\",t}();var ze,He=[Me.store,Pe.store,Le.store,Ve.store,Ue.store,Re.store,je.store,Be.store].concat([Ge.store,We.store]).concat([Fe.store]).concat([Ke.store]),Ye=function(){function t(){this.collectionParentsCache=new Ne}return t.prototype.addToCollectionParentIndex=function(t,e){if(v(e.length%2===1,\"Expected a collection path.\"),this.collectionParentsCache.add(e)){v(e.length>=1,\"Invalid collection path.\");var n=e.lastSegment(),r=e.popLast();return Xe(t).put({collectionId:n,parent:vt(r)})}return Kt.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,\"\"],[X(e),\"\"],!1,!0);return Xe(t).loadAll(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Et(o.parent))}return n})},t}();function Xe(t){return fn.getStore(t,Ke.store)}!function(t){t[t.Listen=0]=\"Listen\",t[t.ExistenceFilterMismatch=1]=\"ExistenceFilterMismatch\",t[t.LimboResolution=2]=\"LimboResolution\"}(ze||(ze={}));var Je=function(){function t(t,e,n,r,i,o){void 0===i&&(i=It.MIN),void 0===o&&(o=w()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),$e=function(){function e(t){this.remoteSerializer=t}return e.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ht.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new me(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=ht.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new ye(e,n)}return g(\"Unexpected DbRemoteDocument\")},e.prototype.toDbRemoteDocument=function(t){if(t instanceof de){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new Ve(null,null,e,n)}if(t instanceof me){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);n=t.hasCommittedMutations;return new Ve(null,new xe(r,i),null,n)}if(t instanceof ye){r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return new Ve(new qe(r,i),null,null,!0)}return g(\"Unexpected MaybeDocumment\")},e.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new Oe(e.seconds,e.nanoseconds)},e.prototype.fromDbTimestamp=function(t){var e=new Tt(t.seconds,t.nanoseconds);return It.fromTimestamp(e)},e.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Pe(t,e.batchId,e.localWriteTime.toMillis(),r,i)},e.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=Tt.fromMillis(t.localWriteTimeMs);return new Bt(t.batchId,i,n,r)},e.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(vt(t.path))}),e},e.prototype.fromDbResourcePaths=function(t){for(var e=Vt(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new ht(Et(i)))}return e},e.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Je(e,t.targetId,ze.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},e.prototype.toDbTarget=function(e){v(ze.Listen===e.purpose,\"Only queries with purpose \"+ze.Listen+\" may be stored, got \"+e.purpose);var n,r,i=this.toDbTimestamp(e.snapshotVersion);return n=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query),e.resumeToken instanceof Uint8Array?(v(\"YES\"===t.env.USE_MOCK_PERSISTENCE,\"Persisting non-string stream tokens is only supported with mock persistence .\"),r=e.resumeToken.toString()):r=e.resumeToken,new Ue(e.targetId,e.query.canonicalId(),i,r,e.sequenceNumber,n)},e}();function Ze(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=H(n,i);return 0===a?H(r,o):a}var tn=function(){function t(t){this.maxElements=t,this.buffer=new Nt(Ze),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ze(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,\"maxValue\",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),en={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nn=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),rn=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){v(null===this.gcTask,\"Cannot start an already started LruScheduler\"),this.garbageCollector.params.cacheSizeCollectionThreshold!==nn.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,\"started\",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;v(null===this.gcTask,\"Cannot schedule GC while a task is pending\");var e=this.hasRun?3e5:6e4;d(\"LruGarbageCollector\",\"Garbage collection scheduled in \"+e+\"ms\"),this.gcTask=this.asyncQueue.enqueueAfterDelay(Z.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(pn)})},t}(),on=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Kt.resolve(ot.INVALID);var r=new tn(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===nn.COLLECTION_DISABLED?(d(\"LruGarbageCollector\",\"Garbage collection skipped; disabled\"),Kt.resolve(en)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(d(\"LruGarbageCollector\",\"Garbage collection skipped; Cache size \"+r+\" is lower than threshold \"+n.params.cacheSizeCollectionThreshold),en):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,a,s,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>h.params.maximumSequenceNumbersToCollect?(d(\"LruGarbageCollector\",\"Capping sequence numbers to collect down to the maximum of \"+h.params.maximumSequenceNumbersToCollect+\" from \"+e),r=h.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),h.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)}).next(function(e){return o=e,u=Date.now(),h.removeOrphanedDocuments(t,n)}).next(function(t){(c=Date.now(),f()<=i.DEBUG)&&d(\"LruGarbageCollector\",\"LRU Garbage Collection\\n\\tCounted targets in \"+(a-l)+\"ms\\n\\tDetermined least recently used \"+r+\" in \"+(s-a)+\"ms\\n\\tRemoved \"+o+\" targets in \"+(u-s)+\"ms\\n\\tRemoved \"+t+\" documents in \"+(c-u)+\"ms\\nTotal Duration: \"+(c-l)+\"ms\");return Kt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})})},t}(),an=function(){return function(){}}(),sn=\"IndexedDbPersistence\",un=\"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.\",cn=\"Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.\",hn=\"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.\",ln=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return s.__extends(e,t),e}(an),fn=function(){function t(e,n,r,i,o,a,s){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new T(E.UNIMPLEMENTED,hn);if(this.referenceDelegate=new vn(this,a),this.dbName=e+t.MAIN_DATABASE,this.serializer=new $e(o),this.document=r.document,this.allowTabSynchronization=void 0!==s,this.queryCache=new ue(this.referenceDelegate,this.serializer),this.indexManager=new Ye,this.remoteDocumentCache=new we(this.serializer,this.indexManager,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new T(E.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof ln)return ee.getStore(t.simpleDbTransaction,e);throw g(\"IndexedDbPersistence must use instances of IndexedDbTransaction\")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return s.__awaiter(this,void 0,void 0,function(){var u;return s.__generator(this,function(s){switch(s.label){case 0:return[4,(u=new t(e,n,r,i,o,a)).start()];case 1:return s.sent(),[2,u]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,u){return s.__awaiter(this,void 0,void 0,function(){var c;return s.__generator(this,function(s){switch(s.label){case 0:return[4,(c=new t(e,n,r,i,o,a,u)).start()];case 1:return s.sent(),[2,c]}})})},t.prototype.start=function(){var t=this;return v(!this.started,\"IndexedDbPersistence double-started!\"),v(null!==this.window,\"Expected 'window' to be defined\"),ee.openOrCreate(this.dbName,De,new ke(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.startRemoteDocumentCache()}).then(function(){return t.simpleDb.runTransaction(\"readonly\",[je.store],function(e){return le(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new ot(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction(\"readonly\",He,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction(\"readwrite\",He,function(e){return mn(e).put(new Ge(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return dn(t).get(Re.key).next(function(t){return Kt.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return mn(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return s.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return s.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction(\"maybeGarbageCollectMultiClientState\",\"readwrite-primary\",function(i){var o=t.getStore(i,Ge.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return Kt.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if((e=e.filter(function(t){return t.clientId!==r.clientId})).length>0){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(Z.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return dn(t).get(Re.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new T(E.FAILED_PRECONDITION,cn);return!1}}return!(!e.networkEnabled||!e.inForeground)||mn(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&d(sn,\"Client \"+(t?\"is\":\"is not\")+\" eligible for a primary lease.\"),t})},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction(\"readwrite\",[Re.store,Ge.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction(\"readonly\",[Ge.store],function(e){return mn(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,ee.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,\"started\",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return v(this.started,\"Cannot initialize MutationQueue before persistence is started.\"),Qt.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getQueryCache=function(){return v(this.started,\"Cannot initialize QueryCache before persistence is started.\"),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return v(this.started,\"Cannot initialize RemoteDocumentCache before persistence is started.\"),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return v(this.started,\"Cannot initialize IndexManager before persistence is started.\"),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;return d(sn,\"Starting transaction:\",t),this.simpleDb.runTransaction(\"readonly\"===e?\"readonly\":\"readwrite\",He,function(i){return\"readwrite-primary\"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw m(\"Failed to obtain primary lease for action '\"+t+\"'.\"),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new T(E.FAILED_PRECONDITION,un);return n(new ln(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new ln(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return dn(t).get(Re.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new T(E.FAILED_PRECONDITION,cn)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new Re(this.clientId,this.allowTabSynchronization,Date.now());return dn(t).put(Re.key,e)},t.isAvailable=function(){return ee.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+=\".\"+t.databaseId.database),\"firestore/\"+t.persistenceKey+\"/\"+e+\"/\"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=dn(t);return n.get(Re.key).next(function(t){return e.isLocalClient(t)?(d(sn,\"Releasing primary lease.\"),n.delete(Re.key)):Kt.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(m(\"Detected an update time that is in the future: \"+t+\" > \"+n),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&\"function\"===typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground=\"visible\"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener(\"visibilitychange\",this.documentVisibilityHandler),this.inForeground=\"visible\"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(v(null!==this.document&&\"function\"===typeof this.document.addEventListener,\"Expected 'document.addEventListener' to be a function\"),this.document.removeEventListener(\"visibilitychange\",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;\"function\"===typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener(\"unload\",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(v(\"function\"===typeof this.window.removeEventListener,\"Expected 'window.removeEventListener' to be a function\"),this.window.removeEventListener(\"unload\",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return d(sn,\"Client '\"+t+\"' \"+(e?\"is\":\"is not\")+\" zombied in LocalStorage\"),e}catch(n){return m(sn,\"Failed to get zombied client id.\",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){m(\"Failed to set zombie client id.\",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return\"firestore_zombie_\"+this.persistenceKey+\"_\"+t},t.MAIN_DATABASE=\"main\",t}();function pn(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){if(!function(t){return t.code===E.FAILED_PRECONDITION&&t.message===un}(t))throw t;return d(sn,\"Unexpectedly lost primary lease\"),[2]})})}function dn(t){return t.store(Re.store)}function mn(t){return t.store(Ge.store)}var yn,gn,vn=function(){function t(t,e){this.db=t,this.garbageCollector=new on(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return bn(t,e)},t.prototype.removeReference=function(t,e){return bn(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return bn(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?Kt.resolve(!0):function(t,e){var n=!1;return Xt(t).iterateSerial(function(r){return Wt(t,r,e).next(function(t){return t&&(n=!0),Kt.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,a).next(function(t){i+=t})});o.push(u)}}).next(function(){return Kt.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n,r=0,i=this.db.getRemoteDocumentCache();return Kt.waitFor([fe(t).delete((n=e,[0,vt(n.path)])),i.removeEntry(t,e).next(function(t){r+=t})]).next(function(){return r})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return bn(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=fe(t),i=ot.INVALID;return r.iterate({index:Be.documentTargetsIndex},function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==ot.INVALID&&e(new ht(Et(n)),i),i=s,n=a):i=ot.INVALID}).next(function(){i!==ot.INVALID&&e(new ht(Et(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function bn(t,e){return fe(t).put(function(t,e){return new Be(0,vt(t.path),e)}(e,t.currentSequenceNumber))}!function(t){t[t.NullValue=0]=\"NullValue\",t[t.BooleanValue=1]=\"BooleanValue\",t[t.NumberValue=2]=\"NumberValue\",t[t.TimestampValue=3]=\"TimestampValue\",t[t.StringValue=4]=\"StringValue\",t[t.BlobValue=5]=\"BlobValue\",t[t.RefValue=6]=\"RefValue\",t[t.GeoPointValue=7]=\"GeoPointValue\",t[t.ArrayValue=8]=\"ArrayValue\",t[t.ObjectValue=9]=\"ObjectValue\"}(yn||(yn={})),function(t){t[t.Default=0]=\"Default\",t[t.Estimate=1]=\"Estimate\",t[t.Previous=2]=\"Previous\"}(gn||(gn={}));var wn=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case\"estimate\":return new t(gn.Estimate,n);case\"previous\":return new t(gn.Previous,n);case\"none\":case void 0:return new t(gn.Default,n);default:return g(\"fromSnapshotOptions() called with invalid options.\")}},t}(),En=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?\"null\":t.toString()},t.prototype.defaultCompareTo=function(t){return v(this.typeOrder!==t.typeOrder,\"Default compareTo should not be used for values of same type.\"),H(this.typeOrder,t.typeOrder)},t}(),Tn=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=yn.NullValue,e.internalValue=null,e}return s.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(En),In=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.BooleanValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?H(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(En),Sn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.NumberValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue,r=t.internalValue,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.defaultCompareTo(t);var n,r},e}(En);function Cn(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}var _n,An=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Cn(this.internalValue,t.internalValue)},e}(Sn),Nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Cn(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Sn),Dn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.StringValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?H(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(En),kn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.TimestampValue,n}return s.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof On?-1:this.defaultCompareTo(t)},e}(En),On=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=yn.TimestampValue,r}return s.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===gn.Estimate?new kn(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===gn.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof kn?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return\"<ServerTimestamp localTime=\"+this.localWriteTime.toString()+\">\"},e}(En),Rn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.BlobValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(En),Mn=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=yn.RefValue,r}return s.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ht.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(En),Pn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.GeoPointValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(En),Ln=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.ObjectValue,n}return s.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=H(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return H(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(v(!t.isEmpty(),\"Cannot set field for empty path on ObjectValue\"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(v(!t.isEmpty(),\"Cannot delete field for empty path on ObjectValue\"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){v(!t.isEmpty(),\"Can't get field of empty path\");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t):null}),n},e.prototype.fieldMask=function(){var t=new Nt(ct.comparator);return this.internalValue.forEach(function(n,r){var i=new ct([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach(function(e){t=t.add(i.child(e))})}else t=t.add(i)}),qn.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new St(H)),e}(En),xn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=yn.ArrayValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++){if(n[e].isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return H(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return\"[\"+this.internalValue.map(function(t){return t.toString()}).join(\",\")+\"]\"},e}(En),qn=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Nt(ct.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),Vn=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),Fn=function(){return function(t,e){this.version=t,this.transformResults=e}}();!function(t){t[t.Set=0]=\"Set\",t[t.Patch=1]=\"Patch\",t[t.Transform=2]=\"Transform\",t[t.Delete=3]=\"Delete\"}(_n||(_n={}));var Un=function(){function t(t,e){this.updateTime=t,this.exists=e,v(void 0===t||void 0===e,'Precondition can specify \"exists\" or \"updateTime\" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,\"isNone\",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof de&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof de:(v(this.isNone,\"Precondition should be empty\"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!==e&&void 0!==e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Bn=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&v(t.key.isEqual(this.key),\"Can only apply a mutation to a document with the same key\")},t.getPostMutationVersion=function(t){return t instanceof de?t.version:It.MIN},t}(),jn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=_n.Set,i}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),v(null==e.transformResults,\"Transform results received by SetMutation.\");var n=e.version;return new de(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Bn.getPostMutationVersion(t);return new de(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Bn),Kn=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=_n.Patch,o}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null==e.transformResults,\"Transform results received by PatchMutation.\"),!this.precondition.isValidFor(t))return new ye(this.key,e.version);var n=this.patchDocument(t);return new de(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Bn.getPostMutationVersion(t),i=this.patchDocument(t);return new de(this.key,r,i,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof de?t.data:Ln.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}}),t},e}(Bn),Qn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=_n.Transform,r.precondition=Un.exists(!0),r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null!=e.transformResults,\"Transform results missing for TransformMutation.\"),!this.precondition.isValidFor(t))return new ye(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new de(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data,i);return new de(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof de?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?Ln.EMPTY.set(i.field,a):e.set(i.field,a))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&Y(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){v(t instanceof de,\"Unknown MaybeDocument type \"+t);var e=t;return v(e.key.isEqual(this.key),\"Can only transform a document with the same key\"),e},e.prototype.serverTransformResults=function(t,e){var n=[];v(this.fieldTransforms.length===e.length,\"server transform result count (\"+e.length+\") should match field transform count (\"+this.fieldTransforms.length+\")\");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof de&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof de&&(u=e.field(a.field)),null===u&&n instanceof de&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},e.prototype.transformObject=function(t,e){v(e.length===this.fieldTransforms.length,\"TransformResults length mismatch.\");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(Bn),Wn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=_n.Delete,r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),v(null==e.transformResults,\"Transform results received by DeleteMutation.\"),new me(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&v(t.key.isEqual(this.key),\"Can only apply mutation to document with same key\"),new me(this.key,It.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Bn),Gn=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].applyToLocalView(e,t)}return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Rt();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].applyToLocalView(t,e)}r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Ot();return i.forEach(function(t,e){e||(e=new me(t,It.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ht(e)).next(function(t){var e=Pt();return t instanceof de&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e){var n=this;v(e.path.isEmpty(),\"Currently we only support collection group queries at the root.\");var r=e.collectionGroup,i=Pt();return this.indexManager.getCollectionParents(t,r).next(function(o){return Kt.forEach(o,function(o){var a=e.asCollectionQueryAtPath(o.child(r));return n.getDocumentsMatchingCollectionQuery(t,a).next(function(t){t.forEach(function(t,e){i=i.insert(t,e)})})}).next(function(){return i})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r,i=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(r){return n=r,i.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return r=e,i.addMissingBaseDocuments(t,r,n).next(function(t){n=t;for(var e=0,i=r;e<i.length;e++)for(var o=i[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=n.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);n=l instanceof de?n.insert(c,l):n.remove(c)}})}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Vt(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Kn&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof de&&(c=c.insert(t,e))}),c})},t}(),zn=function(){function t(){this.refsByKey=new Nt(Hn.compareByKey),this.refsByTarget=new Nt(Hn.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Hn(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Hn(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ht.EMPTY,r=new Hn(n,t),i=new Hn(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=ht.EMPTY,n=new Hn(e,t),r=new Hn(e,t+1),i=Vt();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Hn(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Hn=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ht.comparator(t.key,e.key)||H(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return H(t.targetOrBatchId,e.targetOrBatchId)||ht.comparator(t.key,e.key)},t}(),Yn=function(){function t(t,e){this.persistence=t,this.localViewReferences=new zn,this.queryDataByTarget={},v(t.started,\"LocalStore was passed an unstarted persistence implementation\"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Gn(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction(\"Handle user change\",\"readonly\",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new Gn(e.remoteDocuments,e.mutationQueue,e.persistence.getIndexManager()),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],a=Vt(),s=0,u=r;s<u.length;s++){var c=u[s];i.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p];o.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){f=y[m];a=a.add(f.key)}}return e.localDocuments.getDocuments(n,a).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this,n=Tt.now(),r=t.reduce(function(t,e){return t.add(e.key)},Vt());return this.persistence.runTransaction(\"Locally write mutations\",\"readwrite\",function(i){return e.localDocuments.getDocuments(i,r).next(function(r){for(var o=[],a=0,s=t;a<s.length;a++){var u=s[a],c=u.extractBaseValue(r.get(u.key));null!=c&&o.push(new Kn(u.key,c,c.fieldMask(),Un.exists(!0)))}return e.mutationQueue.addMutationBatch(i,n,o,t).next(function(t){var e=t.applyToLocalDocumentSet(r);return{batchId:t.batchId,changes:e}})})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction(\"Lookup mutation documents\",\"readonly\",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):Kt.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction(\"Acknowledge batch\",\"readwrite-primary\",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction(\"Reject batch\",\"readwrite-primary\",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return v(null!==t,\"Attempt to reject nonexistent batch!\"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction(\"Get last stream token\",\"readonly\",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction(\"Set last stream token\",\"readwrite-primary\",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction(\"Get last remote snapshot version\",\"readonly\",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction(\"Apply remote event\",\"readwrite-primary\",function(i){var o=[],a=Vt();_(e.targetChanges,function(r,s){var u=n.queryDataByTarget[r];if(u){s.addedDocuments.forEach(function(t){a=a.add(t)}),s.modifiedDocuments.forEach(function(t){a=a.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,s.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,s.addedDocuments,r)}));var c=s.resumeToken;if(c.length>0){var h=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(h,u,s)&&o.push(n.queryCache.updateQueryData(i,u))}}});var s=Ot(),u=Vt();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var h=t.get(u);null==h||c.version.isEqual(It.MIN)||a.has(c.key)&&!h.hasPendingWrites||c.version.compareTo(h.version)>=0?(r.addEntry(c),s=s.insert(u,c)):d(\"LocalStore\",\"Ignoring outdated watch update for \",u,\". Current version:\",h.version,\" Watch version:\",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(It.MIN)){var h=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return v(c.compareTo(t)>=0,\"Watch stream reverted to previous snapshot?? \"+c+\" < \"+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(h)}return Kt.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,s)})})},t.shouldPersistQueryData=function(t,e,n){return 0!==e.resumeToken.length&&(0===t.resumeToken.length||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0))},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction(\"notifyLocalViewChanges\",\"readwrite\",function(n){return Kt.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),Kt.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction(\"Get next mutation batch\",\"readonly\",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction(\"read document\",\"readonly\",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction(\"Allocate query\",\"readwrite\",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,Kt.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new Je(t,i,ze.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return v(!e.queryDataByTarget[r.targetId],\"Tried to allocate an already allocated query: \"+t),e.queryDataByTarget[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?\"readwrite\":\"readwrite-primary\";return this.persistence.runTransaction(\"Release query\",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){v(null!=i,\"Tried to release nonexistent query: \"+t);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?Kt.resolve():Kt.forEach(s,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction(\"Execute query\",\"readonly\",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction(\"Remote document keys\",\"readonly\",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=Kt.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);v(null!==a,\"ackVersions should contain every doc in the write.\"),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):v(!t,\"Mutation batch \"+i+\" applied to document \"+t+\" resulted in null\"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction(\"Collect garbage\",\"readwrite-primary\",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction(\"Get query data\",\"readonly\",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction(\"Get new document changes\",\"readonly\",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Xn=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=w(),this.batchesByDocumentKey=new Nt(Hn.compareByKey)}return t.prototype.checkEmpty=function(t){return Kt.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,\"acknowledged\");v(0===i,\"Can only acknowledge the first batch in the mutation queue\");var o=this.mutationQueue[i];return v(r===o.batchId,\"Queue ordering failure: expected batch \"+r+\", got batch \"+o.batchId),this.lastStreamToken=n,Kt.resolve()},t.prototype.getLastStreamToken=function(t){return Kt.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Kt.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){v(0!==r.length,\"Mutation batches should not be empty\");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&v(this.mutationQueue[this.mutationQueue.length-1].batchId<i,\"Mutation batchIDs must be monotonically increasing order\");var o=new Bt(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Hn(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return Kt.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Kt.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return v(null!=n,\"Failed to find local mutation batch.\"),Kt.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Kt.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return Kt.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Hn(e,0),i=new Hn(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){v(e.isEqual(t.key),\"Should only iterate over a single key's batches\");var r=n.findMutationBatch(t.targetOrBatchId);v(null!==r,\"Batches in the index must exist in the main table\"),o.push(r)}),Kt.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Nt(H);return e.forEach(function(t){var e=new Hn(t,0),i=new Hn(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){v(t.isEqual(e.key),\"For each key, should only iterate over a single key's batches\"),r=r.add(e.targetOrBatchId)})}),Kt.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){v(!e.isCollectionGroupQuery(),\"CollectionGroup queries should be handled in LocalDocumentsView\");var n=e.path,r=n.length+1,i=n;ht.isDocumentKey(i)||(i=i.child(\"\"));var o=new Hn(new ht(i),0),a=new Nt(H);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),Kt.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;v(0===this.indexOfExistingBatchId(e.batchId,\"removed\"),\"Can only remove the first entry of the mutation queue\"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Kt.forEach(e.mutations,function(i){var o=new Hn(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new Hn(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Kt.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&v(this.batchesByDocumentKey.isEmpty(),\"Document leak -- detected dangling mutation references when queue is empty.\"),Kt.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return v(n>=0&&n<this.mutationQueue.length,\"Batches must exist to be \"+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return v(n.batchId===t,\"If found batch must match\"),n},t}(),Jn=function(){function t(t){this.persistence=t,this.queries=new ge(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=It.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new zn,this.targetCount=0,this.targetIdGenerator=Zt.forQueryCache()}return t.prototype.getTargetCount=function(t){return Kt.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),Kt.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Kt.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Kt.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,Kt.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),Kt.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return v(!this.queries.has(e.query),\"Adding a query that already exists\"),this.saveQueryData(e),this.targetCount+=1,Kt.resolve()},t.prototype.updateQueryData=function(t,e){return v(this.queries.has(e.query),\"Updating a non-existent query\"),this.saveQueryData(e),Kt.resolve()},t.prototype.removeQueryData=function(t,e){return v(this.targetCount>0,\"Removing a target from an empty cache\"),v(this.queries.has(e.query),\"Removing a non-existent target from the cache\"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,Kt.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=e&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),Kt.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return Kt.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Kt.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return g(\"Not yet implemented.\")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Kt.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Kt.resolve(n)},t.prototype.containsKey=function(t,e){return Kt.resolve(this.references.containsKey(e))},t}();var $n=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new St(ht.comparator),this.newDocumentChanges=Vt(),this.size=0}return t.prototype.addEntries=function(t,e,n){for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=a.maybeDocument.key;this.docs=this.docs.insert(s,a),this.newDocumentChanges=this.newDocumentChanges.add(s),r.push(this.indexManager.addToCollectionParentIndex(t,s.path.popLast()))}return this.size+=n,Kt.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,Kt.resolve(n.size)):Kt.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Kt.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return Kt.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=Rt();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),Kt.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=Rt(),i=new St(ht.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),Kt.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){v(!e.isCollectionGroupQuery(),\"CollectionGroup queries should be handled in LocalDocumentsView\");for(var n=Pt(),r=new ht(e.path.child(\"\")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!e.path.isPrefixOf(a.path))break;s instanceof de&&e.matches(s)&&(n=n.insert(s.key,s))}return Kt.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return Kt.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Ot();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new me(t,It.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=Vt(),Kt.resolve(n)},t.prototype.newChangeBuffer=function(){return new Zn(this.sizer,this)},t.prototype.getSize=function(t){return Kt.resolve(this.size)},t}(),Zn=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentSizes.get(t);v(void 0!==o,\"Attempting to change document \"+t.toString()+\" without having read it first\");var a=e.sizer(n);r+=a-o,i.push({maybeDocument:n,size:a})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(ve),tr=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new ot(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new Jn(this);this.indexManager=new Ae,this.remoteDocumentCache=new $n(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new rr(t,new $e(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new nr(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,\"started\",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Xn(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;d(\"MemoryPersistence\",\"Starting transaction:\",t);var i=new er(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return Kt.or(function(t){var e=[];return A(t,function(t,n){return e.push(n)}),e}(this.mutationQueues).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),er=function(){return function(t){this.currentSequenceNumber=t}}(),nr=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),Kt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),Kt.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),Kt.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return Kt.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?Kt.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return Kt.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return Kt.resolve(n.inMemoryPins.containsKey(e))}])},t}(),rr=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new ge(function(t){return vt(t.path)}),this.garbageCollector=new on(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return Kt.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return Kt.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?Kt.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?Kt.resolve():(r++,i.removeEntry(t,o).next())})}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw g(\"Unknown remote document type\");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return Kt.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return Kt.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return Kt.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),ir=Number,or=ir.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),ar=ir.MAX_SAFE_INTEGER||Math.pow(2,53)-1,sr=ir.isInteger||function(t){return\"number\"===typeof t&&isFinite(t)&&Math.floor(t)===t};function ur(t){return null===t||void 0===t}function cr(t){return sr(t)&&t<=ar&&t>=or}var hr,lr=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&d(\"ExponentialBackoff\",\"Backing off for \"+i+\" ms (base delay: \"+this.currentBaseMs+\" ms, delay with jitter: \"+n+\" ms, last attempt: \"+r+\" ms ago)\"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]=\"Initial\",t[t.Starting=1]=\"Starting\",t[t.Open=2]=\"Open\",t[t.Error=3]=\"Error\",t[t.Backoff=4]=\"Backoff\"}(hr||(hr={}));var fr,pr,dr=1e3,mr=6e4,yr=1.5,gr=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=hr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new lr(t,e,dr,yr,mr)}return t.prototype.isStarted=function(){return this.state===hr.Starting||this.state===hr.Open||this.state===hr.Backoff},t.prototype.isOpen=function(){return this.state===hr.Open},t.prototype.start=function(){this.state!==hr.Error?(v(this.state===hr.Initial,\"Already started\"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(hr.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){v(!this.isStarted(),\"Can only inhibit backoff in a stopped state\"),this.state=hr.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.isOpen()?[2,this.close(hr.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(n){switch(n.label){case 0:return v(this.isStarted(),\"Only started streams should be closed.\"),v(t===hr.Error||ur(e),\"Can't provide an error when not in an error state.\"),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==hr.Error?this.backoff.reset():e&&e.code===E.RESOURCE_EXHAUSTED?(m(e.toString()),m(\"Using maximum backoff delay to prevent overloading the backend.\"),this.backoff.resetToMax()):e&&e.code===E.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;v(this.state===hr.Initial,\"Must be in initial state to auth\"),this.state=hr.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new T(E.UNKNOWN,\"Fetching auth token failed: \"+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;v(this.state===hr.Starting,\"Trying to start stream in a non-starting state\");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return v(e.state===hr.Starting,\"Expected stream to be in state Starting, but was \"+e.state),e.state=hr.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;v(this.state===hr.Error,\"Should only perform backoff when in Error state\"),this.state=hr.Backoff,this.backoff.backoffAndRun(function(){return s.__awaiter(t,void 0,void 0,function(){return s.__generator(this,function(t){return v(this.state===hr.Backoff,\"Backoff elapsed but state is now: \"+this.state),this.state=hr.Initial,this.start(),v(this.isStarted(),\"PersistentStream should have started\"),[2]})})})},t.prototype.handleStreamClose=function(t){return v(this.isStarted(),\"Can't handle server close on non-started stream\"),d(\"PersistentStream\",\"close with error: \"+t),this.stream=null,this.close(hr.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(d(\"PersistentStream\",\"stream callback skipped by getCloseGuardedDispatcher.\"),Promise.resolve())})}},t}(),vr=function(t){function e(e,n,r,i,o){var a=t.call(this,e,Z.ListenStreamConnectionBackoff,Z.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return s.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream(\"Listen\",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(gr),br=function(t){function e(e,n,r,i,o){var a=t.call(this,e,Z.WriteStreamConnectionBackoff,Z.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return s.__extends(e,t),Object.defineProperty(e.prototype,\"handshakeComplete\",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream(\"Write\",t)},e.prototype.onMessage=function(t){if(v(!!t.streamToken,\"Got a write response without a stream token\"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return v(!t.writeResults||0===t.writeResults.length,\"Got mutation results for handshake\"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){v(this.isOpen(),\"Writing handshake requires an opened stream\"),v(!this.handshakeComplete_,\"Handshake already completed\");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;v(this.isOpen(),\"Writing mutations requires an opened stream\"),v(this.handshakeComplete_,\"Handshake must be complete before writing mutations\"),v(this.lastStreamToken.length>0,\"Trying to write mutation without a token\");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(gr),wr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new br(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new vr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC(\"Commit\",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC(\"BatchGetDocuments\",n).then(function(n){var r=Ot();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);v(!!e,\"Missing entity in write response for \"+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===E.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===E.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),Er=function(){function t(t){this.datastore=t,this.readVersions=xt(),this.mutations=[],this.committed=!1,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new T(E.INVALID_ARGUMENT,\"Firestore transactions require all reads to be executed before all writes.\");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach(function(t){t instanceof me||t instanceof de?n.recordVersion(t):g(\"Document in a transaction was a \"+t.constructor.name)}),[2,e]}})})},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Wn(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach(function(e){t=t.remove(e.key)}),!t.isEmpty())throw new T(E.INVALID_ARGUMENT,\"Every document read in a transaction must also be written.\");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t instanceof de)e=t.version;else{if(!(t instanceof me))throw g(\"Document in a transaction was a \"+t.constructor.name);e=It.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new T(E.ABORTED,\"Document version changed between two reads.\")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?Un.updateTime(e):Un.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(It.forDeletedDoc()))throw new T(E.INVALID_ARGUMENT,\"Can't update a document that doesn't exist.\");return Un.updateTime(e)}return Un.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){v(!this.committed,\"A transaction object cannot be used after its update callback has been invoked.\")},t}();!function(t){t[t.Unknown=0]=\"Unknown\",t[t.Online=1]=\"Online\",t[t.Offline=2]=\"Offline\"}(fr||(fr={})),function(t){t[t.RemoteStore=0]=\"RemoteStore\",t[t.SharedClientState=1]=\"SharedClientState\"}(pr||(pr={}));var Tr,Ir=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=fr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(fr.Unknown),v(null===this.onlineStateTimer,\"onlineStateTimer shouldn't be started yet\"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(Z.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,v(t.state===fr.Unknown,\"Timer should be canceled if we transitioned to a different state.\"),t.logClientOfflineWarningIfNecessary(\"Backend didn't respond within 10 seconds.\"),t.setAndBroadcast(fr.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===fr.Online?(this.setAndBroadcast(fr.Unknown),v(0===this.watchStreamFailures,\"watchStreamFailures must be 0\"),v(null===this.onlineStateTimer,\"onlineStateTimer must be null\")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(\"Connection failed 1 times. Most recent error: \"+t.toString()),this.setAndBroadcast(fr.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===fr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e=\"Could not reach Cloud Firestore backend. \"+t+\"\\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.\";this.shouldWarnClientIsOffline?(m(e),this.shouldWarnClientIsOffline=!1):d(\"OnlineStateTracker\",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function Sr(t){switch(t){case E.OK:return g(\"Treated status OK as error\");case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0;default:return g(\"Unknown status code: \"+t)}}function Cr(t){if(void 0===t)return m(\"GRPC error has no .code\"),E.UNKNOWN;switch(t){case Tr.OK:return E.OK;case Tr.CANCELLED:return E.CANCELLED;case Tr.UNKNOWN:return E.UNKNOWN;case Tr.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case Tr.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case Tr.INTERNAL:return E.INTERNAL;case Tr.UNAVAILABLE:return E.UNAVAILABLE;case Tr.UNAUTHENTICATED:return E.UNAUTHENTICATED;case Tr.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case Tr.NOT_FOUND:return E.NOT_FOUND;case Tr.ALREADY_EXISTS:return E.ALREADY_EXISTS;case Tr.PERMISSION_DENIED:return E.PERMISSION_DENIED;case Tr.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case Tr.ABORTED:return E.ABORTED;case Tr.OUT_OF_RANGE:return E.OUT_OF_RANGE;case Tr.UNIMPLEMENTED:return E.UNIMPLEMENTED;case Tr.DATA_LOSS:return E.DATA_LOSS;default:return g(\"Unknown status code: \"+t)}}function _r(t){if(void 0===t)return Tr.OK;switch(t){case E.OK:return Tr.OK;case E.CANCELLED:return Tr.CANCELLED;case E.UNKNOWN:return Tr.UNKNOWN;case E.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case E.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case E.INTERNAL:return Tr.INTERNAL;case E.UNAVAILABLE:return Tr.UNAVAILABLE;case E.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case E.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case E.NOT_FOUND:return Tr.NOT_FOUND;case E.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case E.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case E.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case E.ABORTED:return Tr.ABORTED;case E.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case E.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case E.DATA_LOSS:return Tr.DATA_LOSS;default:return g(\"Unknown status code: \"+t)}}!function(t){t[t.OK=0]=\"OK\",t[t.CANCELLED=1]=\"CANCELLED\",t[t.UNKNOWN=2]=\"UNKNOWN\",t[t.INVALID_ARGUMENT=3]=\"INVALID_ARGUMENT\",t[t.DEADLINE_EXCEEDED=4]=\"DEADLINE_EXCEEDED\",t[t.NOT_FOUND=5]=\"NOT_FOUND\",t[t.ALREADY_EXISTS=6]=\"ALREADY_EXISTS\",t[t.PERMISSION_DENIED=7]=\"PERMISSION_DENIED\",t[t.UNAUTHENTICATED=16]=\"UNAUTHENTICATED\",t[t.RESOURCE_EXHAUSTED=8]=\"RESOURCE_EXHAUSTED\",t[t.FAILED_PRECONDITION=9]=\"FAILED_PRECONDITION\",t[t.ABORTED=10]=\"ABORTED\",t[t.OUT_OF_RANGE=11]=\"OUT_OF_RANGE\",t[t.UNIMPLEMENTED=12]=\"UNIMPLEMENTED\",t[t.INTERNAL=13]=\"INTERNAL\",t[t.UNAVAILABLE=14]=\"UNAVAILABLE\",t[t.DATA_LOSS=15]=\"DATA_LOSS\"}(Tr||(Tr={}));var Ar,Nr,Dr=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ht.comparator(e.key,n.key)}:function(t,e){return ht.comparator(t.key,e.key)},this.keyedMap=Pt(),this.sortedSet=new St(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?\"DocumentSet ()\":\"DocumentSet (\\n  \"+t.join(\"  \\n\")+\"\\n)\"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();!function(t){t[t.Added=0]=\"Added\",t[t.Removed=1]=\"Removed\",t[t.Modified=2]=\"Modified\",t[t.Metadata=3]=\"Metadata\"}(Ar||(Ar={})),function(t){t[t.Local=0]=\"Local\",t[t.Synced=1]=\"Synced\"}(Nr||(Nr={}));var kr,Or=function(){function t(){this.changeMap=new St(ht.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Ar.Added&&n.type===Ar.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Ar.Metadata&&n.type!==Ar.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Ar.Modified&&n.type===Ar.Modified?this.changeMap=this.changeMap.insert(e,{type:Ar.Modified,doc:t.doc}):t.type===Ar.Modified&&n.type===Ar.Added?this.changeMap=this.changeMap.insert(e,{type:Ar.Added,doc:t.doc}):t.type===Ar.Removed&&n.type===Ar.Added?this.changeMap=this.changeMap.remove(e):t.type===Ar.Removed&&n.type===Ar.Modified?this.changeMap=this.changeMap.insert(e,{type:Ar.Removed,doc:n.doc}):t.type===Ar.Added&&n.type===Ar.Removed?this.changeMap=this.changeMap.insert(e,{type:Ar.Modified,doc:t.doc}):g(\"unsupported combination of changes: \"+JSON.stringify(t)+\" after \"+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Rr=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Ar.Added,doc:t})}),new t(e,n,Dr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.syncStateChanged!==t.syncStateChanged||!this.mutatedKeys.isEqual(t.mutatedKeys)||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Mr=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=Pr.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(It.MIN,i,Ut(),Ot(),Vt())},t}(),Pr=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(w(),n,Vt(),Vt(),Vt())},t}(),Lr=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),xr=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}();!function(t){t[t.NoChange=0]=\"NoChange\",t[t.Added=1]=\"Added\",t[t.Removed=2]=\"Removed\",t[t.Current=3]=\"Current\",t[t.Reset=4]=\"Reset\"}(kr||(kr={}));var qr=function(){return function(t,e,n,r){void 0===n&&(n=w()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),Vr=function(){function t(){this.pendingResponses=0,this.documentChanges=Br(),this._resumeToken=w(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,\"current\",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"resumeToken\",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"isPending\",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"hasPendingChanges\",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Vt(),e=Vt(),n=Vt();return this.documentChanges.forEach(function(r,i){switch(i){case Ar.Added:t=t.add(r);break;case Ar.Modified:e=e.add(r);break;case Ar.Removed:n=n.add(r);break;default:g(\"Encountered invalid change type: \"+i)}}),new Pr(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Br()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),Fr=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Ot(),this.pendingDocumentTargetMapping=Ur(),this.pendingTargetResets=new Nt(H)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof de?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof me&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case kr.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case kr.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case kr.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),v(!t.cause,\"WatchChangeAggregator does not handle errored targets\");break;case kr.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case kr.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:g(\"Unknown target watch change state: \"+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):_(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new ht(i.path);this.removeDocumentFromTarget(e,o,new me(o,It.forDeletedDoc()))}else v(1===n,\"Single document existence filter with count: \"+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};_(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new ht(o.query.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new me(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=Vt();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===ze.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Mr(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Ot(),this.pendingDocumentTargetMapping=Ur(),this.pendingTargetResets=new Nt(H),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Ar.Modified:Ar.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Ar.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new Vr),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Nt(H),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;v(!this.targetStates[t].isPending,\"Should only reset active targets\"),this.targetStates[t]=new Vr,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function Ur(){return new St(ht.comparator)}function Br(){return new St(ht.comparator)}var jr=\"RemoteStore\",Kr=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return s.__awaiter(o,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(d(jr,\"Restarting streams for network reachability change.\"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new Ir(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(fr.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(fr.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(d(jr,\"Stopping write stream with \"+this.writePipeline.length+\" pending writes\"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return d(jr,\"RemoteStore shutting down.\"),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(fr.Unknown),[2]}})})},t.prototype.listen=function(t){v(!S(this.listenTargets,t.targetId),\"listen called with duplicate targetId!\"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){v(S(this.listenTargets,t),\"unlisten called without assigned target ID!\"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),N(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(fr.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){v(this.shouldStartWatchStream(),\"startWatchStream() called when shouldStartWatchStream() is false.\"),this.watchChangeAggregator=new Fr(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!N(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){return _(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return void 0===t&&v(!this.shouldStartWatchStream(),\"Watch stream was stopped gracefully while still needed.\"),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(fr.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(fr.Online),t instanceof qr&&t.state===kr.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Lr?this.watchChangeAggregator.handleDocumentChange(t):t instanceof xr?this.watchChangeAggregator.handleExistenceFilter(t):(v(t instanceof qr,\"Expected watchChange to be an instance of WatchTargetChange\"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(It.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;v(!t.isEqual(It.MIN),\"Can't raise event for unknown SnapshotVersion\");var n=this.watchChangeAggregator.createRemoteEvent(t);return _(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:w()}),e.sendUnwatchRequest(t);var r=new Je(n.query,t,ze.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;v(!!t.cause,\"Handling target error without a cause\");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return S(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e;return s.__generator(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){v(this.canAddToWritePipeline(),\"addToWritePipeline called when pipeline is full\"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){v(this.shouldStartWriteStream(),\"startWriteStream() called when shouldStartWriteStream() is false.\"),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(pn)},t.prototype.onMutationResult=function(t,e){var n=this;v(this.writePipeline.length>0,\"Got result for empty write pipeline\");var r=this.writePipeline.shift(),i=jt.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){var e=this;return s.__generator(this,function(n){return void 0===t&&v(!this.shouldStartWriteStream(),\"Write stream was stopped gracefully while still needed.\"),t&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return Sr(t.code)?(d(jr,\"RemoteStore error before completed handshake; resetting stream token: \",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=w(),[2,this.localStore.setLastStreamToken(w()).catch(pn)]):[2]})})},t.prototype.handleWriteError=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){return Sr(i=t.code)&&i!==E.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new Er(this.datastore)},t.prototype.restartNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(fr.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(d(jr,\"RemoteStore restarting streams for new credential\"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(fr.Unknown),e.label=4;case 4:return[2]}})})},t}(),Qr=function(){function t(t,e){if(k(\"GeoPoint\",arguments,2),M(\"GeoPoint\",\"number\",1,t),M(\"GeoPoint\",\"number\",2,e),!isFinite(t)||t<-90||t>90)throw new T(E.INVALID_ARGUMENT,\"Latitude must be a number between -90 and 90, but was: \"+t);if(!isFinite(e)||e<-180||e>180)throw new T(E.INVALID_ARGUMENT,\"Longitude must be a number between -180 and 180, but was: \"+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,\"latitude\",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"longitude\",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return H(this._lat,t._lat)||H(this._long,t._long)},t}(),Wr=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,\"orderBy\",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[ri]:this.memoizedOrderBy=[new ni(t),ri];else{v(null===t||null!==e&&t.isEqual(e),\"First orderBy should match inequality field.\"),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:ti.ASCENDING;this.memoizedOrderBy.push(a===ti.ASCENDING?ri:ii)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){v(null==this.getInequalityFilterField()||!(e instanceof Hr)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),\"Query must only have one inequality field.\"),v(!this.isDocumentQuery(),\"No filtering allowed for document query\");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){v(!this.startAt&&!this.endAt,\"Bounds must be set after orderBy\");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();this.isCollectionGroupQuery()&&(t+=\"|cg:\"+this.collectionGroup),t+=\"|f:\";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=\",\"}t+=\"|ob:\";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=\",\"}ur(this.limit)||(t+=\"|l:\",t+=this.limit),this.startAt&&(t+=\"|lb:\",t+=this.startAt.canonicalId()),this.endAt&&(t+=\"|ub:\",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t=\"Query(\"+this.path.canonicalString();return this.isCollectionGroupQuery()&&(t+=\" collectionGroup=\"+this.collectionGroup),this.filters.length>0&&(t+=\", filters: [\"+this.filters.join(\", \")+\"]\"),ur(this.limit)||(t+=\", limit: \"+this.limit),this.explicitOrderBy.length>0&&(t+=\", orderBy: [\"+this.explicitOrderBy.join(\", \")+\"]\"),this.startAt&&(t+=\", startAt: \"+this.startAt.canonicalId()),this.endAt&&(t+=\", endAt: \"+this.endAt.canonicalId()),t+\")\"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return v(n,\"orderBy used that doesn't compare on key field\"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!ur(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Hr&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Hr&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return ht.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):ht.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){v(t.position.length<=this.orderBy.length,\"Bound is longer than orderBy\")},t}(),Gr=function(){return function(){}}(),zr=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case\"<\":return t.LESS_THAN;case\"<=\":return t.LESS_THAN_OR_EQUAL;case\"==\":return t.EQUAL;case\">=\":return t.GREATER_THAN_OR_EQUAL;case\">\":return t.GREATER_THAN;case\"array-contains\":return t.ARRAY_CONTAINS;case\"in\":return t.IN;case\"array-contains-any\":return t.ARRAY_CONTAINS_ANY;default:return g(\"Unknown FieldFilter operator: \"+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t(\"<\"),t.LESS_THAN_OR_EQUAL=new t(\"<=\"),t.EQUAL=new t(\"==\"),t.GREATER_THAN=new t(\">\"),t.GREATER_THAN_OR_EQUAL=new t(\">=\"),t.ARRAY_CONTAINS=new t(\"array-contains\"),t.IN=new t(\"in\"),t.ARRAY_CONTAINS_ANY=new t(\"array-contains-any\"),t}(),Hr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return s.__extends(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===zr.IN?(v(r instanceof xn,\"Comparing on key with IN, but filter value not an ArrayValue\"),v(r.internalValue.every(function(t){return t instanceof Mn}),\"Comparing on key with IN, but an array value was not a RefValue\"),new Xr(t,r)):(v(r instanceof Mn,\"Comparing on key, but filter value not a RefValue\"),v(n!==zr.ARRAY_CONTAINS&&n!==zr.ARRAY_CONTAINS_ANY,\"'\"+n.toString()+\"' queries don't make sense on document keys.\"),new Yr(t,n,r));if(r.isEqual(Tn.INSTANCE)){if(n!==zr.EQUAL)throw new T(E.INVALID_ARGUMENT,\"Invalid query. Null supports only equality comparisons.\");return new e(t,n,r)}if(r.isEqual(Nn.NAN)){if(n!==zr.EQUAL)throw new T(E.INVALID_ARGUMENT,\"Invalid query. NaN supports only equality comparisons.\");return new e(t,n,r)}return n===zr.ARRAY_CONTAINS?new Jr(t,r):n===zr.IN?(v(r instanceof xn,\"IN filter has invalid value: \"+r.toString()),new $r(t,r)):n===zr.ARRAY_CONTAINS_ANY?(v(r instanceof xn,\"ARRAY_CONTAINS_ANY filter has invalid value: \"+r.toString()),new Zr(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case zr.LESS_THAN:return t<0;case zr.LESS_THAN_OR_EQUAL:return t<=0;case zr.EQUAL:return 0===t;case zr.GREATER_THAN:return t>0;case zr.GREATER_THAN_OR_EQUAL:return t>=0;default:return g(\"Unknown FieldFilter operator: \"+this.op)}},e.prototype.isInequality=function(){return[zr.LESS_THAN,zr.LESS_THAN_OR_EQUAL,zr.GREATER_THAN,zr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+\" \"+this.op+\" \"+this.value.value()},e}(Gr),Yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=ht.comparator(t.key,e.key);return this.matchesComparison(n)},e}(Hr),Xr=function(t){function e(e,n){var r=t.call(this,e,zr.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){return this.value.internalValue.some(function(e){return t.key.isEqual(e.key)})},e}(Hr),Jr=function(t){function e(e,n){return t.call(this,e,zr.ARRAY_CONTAINS,n)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof xn&&e.contains(this.value)},e}(Hr),$r=function(t){function e(e,n){var r=t.call(this,e,zr.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(Hr),Zr=function(t){function e(e,n){var r=t.call(this,e,zr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof xn&&n.internalValue.some(function(t){return e.value.contains(t)})},e}(Hr),ti=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t(\"asc\"),t.DESCENDING=new t(\"desc\"),t}(),ei=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?\"b:\":\"a:\",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){v(this.position.length<=t.length,\"Bound has more components than query's orderBy\");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())v(o instanceof Mn,\"Bound has a non-key value where the key path is being used.\"),n=ht.comparator(o.key,e.key);else{var a=e.field(i.field);v(void 0!==a,\"Field should exist since document matched the orderBy already.\"),n=o.compareTo(a)}if(i.dir===ti.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),ni=function(){function t(t,e){this.field=t,void 0===e&&(e=ti.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?de.compareByKey(t,e):de.compareByField(this.field,t,e);switch(this.dir){case ti.ASCENDING:return n;case ti.DESCENDING:return-1*n;default:return g(\"Unknown direction: \"+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+\" (\"+this.dir+\")\"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),ri=new ni(ct.keyField(),ti.ASCENDING),ii=new ni(ct.keyField(),ti.DESCENDING),oi=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new On(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),ai=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=ci(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new xn(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Y(e.elements,this.elements)},t}(),si=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=ci(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new xn(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Y(e.elements,this.elements)},t}(),ui=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof An&&this.operand instanceof An){var r=n.internalValue+this.operand.internalValue;return new An(r)}r=n.internalValue+this.operand.internalValue;return new Nn(r)},t.prototype.applyToRemoteDocument=function(t,e){return v(null!==e,\"Didn't receive transformResult for NUMERIC_ADD transform\"),e},t.prototype.computeBaseValue=function(t){return t instanceof Sn?t:new An(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function ci(t){return t instanceof xn?t.internalValue.slice():[]}var hi=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),li=function(){var t={};return t[ti.ASCENDING.name]=\"ASCENDING\",t[ti.DESCENDING.name]=\"DESCENDING\",t}(),fi=function(){var t={};return t[zr.LESS_THAN.name]=\"LESS_THAN\",t[zr.LESS_THAN_OR_EQUAL.name]=\"LESS_THAN_OR_EQUAL\",t[zr.GREATER_THAN.name]=\"GREATER_THAN\",t[zr.GREATER_THAN_OR_EQUAL.name]=\"GREATER_THAN_OR_EQUAL\",t[zr.EQUAL.name]=\"EQUAL\",t[zr.ARRAY_CONTAINS.name]=\"ARRAY_CONTAINS\",t[zr.IN.name]=\"IN\",t[zr.ARRAY_CONTAINS_ANY.name]=\"ARRAY_CONTAINS_ANY\",t}(),pi=new RegExp(/^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.(\\d+))?Z$/);function di(t,e){v(!ur(t),e+\" is missing\")}function mi(t){return\"number\"===typeof t?t:\"string\"===typeof t?Number(t):g(\"can't parse \"+t)}var yi=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?\"\":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?E.UNKNOWN:Cr(t.code);return new T(e,t.message||\"\")},t.prototype.toInt32Value=function(t){return ur(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return ur(e=\"object\"===typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:\"\"+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if(\"string\"===typeof t)return this.fromIso8601String(t);v(!!t,\"Cannot deserialize null or undefined timestamp.\");var e=mi(t.seconds||\"0\"),n=t.nanos||0;return new Tt(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=pi.exec(t);if(v(!!n,\"invalid timestamp: \"+t),n[1]){var r=n[1];r=(r+\"000000000\").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Tt(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return\"string\"===typeof t?(v(this.options.useProto3Json,\"Expected bytes to be passed in as Uint8Array, but got a string instead.\"),tt.fromBase64String(t)):(v(!this.options.useProto3Json,\"Expected bytes to be passed in as Uint8Array, but got a string instead.\"),tt.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return v(!!t,\"Trying to deserialize version that isn't set\"),It.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child(\"documents\").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=st.fromString(t);return v(this.isValidResourceName(e),\"Tried to deserialize invalid key \"+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return v(e.get(1)===this.databaseId.projectId,\"Tried to deserialize key from different project: \"+e.get(1)+\" vs \"+this.databaseId.projectId),v(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,\"Tried to deserialize key from different database: \"+e.get(3)+\" vs \"+this.databaseId.database),new ht(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?st.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,\"encodedDatabaseId\",{get:function(){return new st([\"projects\",this.databaseId.projectId,\"databases\",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new st([\"projects\",t.projectId,\"databases\",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return v(t.length>4&&\"documents\"===t.get(4),\"tried to deserialize invalid key \"+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&\"projects\"===t.get(0)&&\"databases\"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Tn)return{nullValue:\"NULL_VALUE\"};if(t instanceof In)return{booleanValue:t.value()};if(t instanceof An)return{integerValue:\"\"+t.value()};if(t instanceof Nn){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:\"NaN\"};if(e===1/0)return{doubleValue:\"Infinity\"};if(e===-1/0)return{doubleValue:\"-Infinity\"}}return{doubleValue:t.value()}}return t instanceof Dn?{stringValue:t.value()}:t instanceof Ln?{mapValue:this.toMapValue(t)}:t instanceof xn?{arrayValue:this.toArrayValue(t)}:t instanceof kn?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Pn?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Rn?{bytesValue:this.toBytes(t.value())}:t instanceof Mn?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:g(\"Unknown FieldValue \"+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if(\"nullValue\"in t)return Tn.INSTANCE;if(\"booleanValue\"in t)return In.of(t.booleanValue);if(\"integerValue\"in t)return new An(mi(t.integerValue));if(\"doubleValue\"in t){if(this.options.useProto3Json){if(\"NaN\"===t.doubleValue)return Nn.NAN;if(\"Infinity\"===t.doubleValue)return Nn.POSITIVE_INFINITY;if(\"-Infinity\"===t.doubleValue)return Nn.NEGATIVE_INFINITY}return new Nn(t.doubleValue)}if(\"stringValue\"in t)return new Dn(t.stringValue);if(\"mapValue\"in t)return this.fromFields(t.mapValue.fields||{});if(\"arrayValue\"in t){di(t.arrayValue,\"arrayValue\");var n=t.arrayValue.values||[];return new xn(n.map(function(t){return e.fromValue(t)}))}if(\"timestampValue\"in t)return di(t.timestampValue,\"timestampValue\"),new kn(this.fromTimestamp(t.timestampValue));if(\"geoPointValue\"in t){di(t.geoPointValue,\"geoPointValue\");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Pn(new Qr(r,i))}if(\"bytesValue\"in t){di(t.bytesValue,\"bytesValue\");var o=this.fromBlob(t.bytesValue);return new Rn(o)}if(\"referenceValue\"in t){di(t.referenceValue,\"referenceValue\");var a=this.fromResourceName(t.referenceValue),s=new it(a.get(1),a.get(3)),u=new ht(this.extractLocalPathFromResourceName(a));return new Mn(s,u)}return g(\"Unknown Value proto \"+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return v(!t.hasLocalMutations,\"Can't serialize documents with mutations.\"),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new de(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Ln.EMPTY;return A(n,function(t,n){r=r.set(new ct([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){v(!!t.found,\"Tried to deserialize a found document from a missing document.\"),di(t.found.name,\"doc.found.name\"),di(t.found.updateTime,\"doc.found.updateTime\");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new de(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){v(!!t.missing,\"Tried to deserialize a missing document from a found document.\"),v(!!t.readTime,\"Tried to deserialize a missing document without a read time.\");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new me(e,n)},t.prototype.fromMaybeDocument=function(t){return\"found\"in t?this.fromFound(t):\"missing\"in t?this.fromMissing(t):g(\"invalid batch get response: \"+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case kr.Added:return\"ADD\";case kr.Current:return\"CURRENT\";case kr.NoChange:return\"NO_CHANGE\";case kr.Removed:return\"REMOVE\";case kr.Reset:return\"RESET\";default:return g(\"Unknown WatchTargetChangeState: \"+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof xr)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Lr){if(t.newDoc instanceof de){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof me){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof qr){var n=void 0;return t.cause&&(n={code:_r(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return g(\"Unrecognized watch change: \"+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e;if(\"targetChange\"in t){di(t.targetChange,\"targetChange\");var n=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||\"NO_CHANGE\"),r=t.targetChange.targetIds||[],i=t.targetChange.resumeToken||this.emptyByteString(),o=t.targetChange.cause,a=o&&this.fromRpcStatus(o);e=new qr(n,r,i,a||null)}else if(\"documentChange\"in t){di(t.documentChange,\"documentChange\"),di(t.documentChange.document,\"documentChange.name\"),di(t.documentChange.document.name,\"documentChange.document.name\"),di(t.documentChange.document.updateTime,\"documentChange.document.updateTime\");var s=t.documentChange,u=this.fromName(s.document.name),c=this.fromVersion(s.document.updateTime),h=this.fromFields(s.document.fields||{}),l=new de(u,c,h,{},s.document),f=s.targetIds||[],p=s.removedTargetIds||[];e=new Lr(f,p,l.key,l)}else if(\"documentDelete\"in t){di(t.documentDelete,\"documentDelete\"),di(t.documentDelete.document,\"documentDelete.document\");var d=t.documentDelete;u=this.fromName(d.document),c=d.readTime?this.fromVersion(d.readTime):It.forDeletedDoc(),l=new me(u,c),p=d.removedTargetIds||[];e=new Lr([],p,l.key,l)}else if(\"documentRemove\"in t){di(t.documentRemove,\"documentRemove\"),di(t.documentRemove.document,\"documentRemove\");var m=t.documentRemove;u=this.fromName(m.document),p=m.removedTargetIds||[];e=new Lr([],p,u,null)}else{if(!(\"filter\"in t))return g(\"Unknown change type \"+JSON.stringify(t));di(t.filter,\"filter\"),di(t.filter.targetId,\"filter.targetId\");var y=t.filter,v=y.count||0,b=new hi(v),w=y.targetId;e=new xr(w,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return\"NO_CHANGE\"===t?kr.NoChange:\"ADD\"===t?kr.Added:\"REMOVE\"===t?kr.Removed:\"CURRENT\"===t?kr.Current:\"RESET\"===t?kr.Reset:g(\"Got unexpected TargetChange.state: \"+t)},t.prototype.versionFromListenResponse=function(t){if(!(\"targetChange\"in t))return It.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?It.MIN:e.readTime?this.fromVersion(e.readTime):It.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof jn)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Wn)e={delete:this.toName(t.key)};else if(t instanceof Kn)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Qn))return g(\"Unknown mutation type \"+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Un.NONE;if(t.update){di(t.update.name,\"name\");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Kn(r,i,o,n)}return new jn(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Wn(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return v(!0===n.exists,'Transforms only support precondition \"exists == true\"'),new Qn(r,a)}return g(\"unknown mutation proto: \"+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return v(!t.isNone,\"Can't serialize an empty precondition\"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g(\"Unknown precondition\")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Un.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Un.exists(t.exists):Un.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new Fn(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(v(void 0!==e,\"Received a write result without a commit time\"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof oi)return{fieldPath:t.field.canonicalString(),setToServerValue:\"REQUEST_TIME\"};if(n instanceof ai)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof si)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof ui)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw g(\"Unknown transform: \"+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if(\"setToServerValue\"in t)v(\"REQUEST_TIME\"===t.setToServerValue,\"Unknown server value transform proto: \"+JSON.stringify(t)),n=oi.instance;else if(\"appendMissingElements\"in t){var r=t.appendMissingElements.values||[];n=new ai(r.map(function(t){return e.fromValue(t)}))}else if(\"removeAllFromArray\"in t){r=t.removeAllFromArray.values||[];n=new si(r.map(function(t){return e.fromValue(t)}))}else if(\"increment\"in t){var i=this.fromValue(t.increment);v(i instanceof Sn,\"NUMERIC_ADD transform requires a NumberValue\"),n=new ui(i)}else g(\"Unknown transform proto: \"+JSON.stringify(t));var o=ct.fromServerFormat(t.fieldPath);return new Vn(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;v(1===e,\"DocumentsTarget contained other than 1 document: \"+e);var n=t.documents[0];return Wr.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(v(n.length%2===0,\"Collection Group queries should be within a document path or root.\"),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(v(n.length%2!==0,\"Document queries with filters are not supported.\"),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){v(1===r,\"StructuredQuery.from with more than one collection is not supported.\");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new Wr(e,i,s,a,u,c,h)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{\"goog-listen-tags\":e}},t.prototype.toLabel=function(t){switch(t){case ze.Listen:return null;case ze.ExistenceFilterMismatch:return\"existence-filter-mismatch\";case ze.LimboResolution:return\"limbo-document\";default:return g(\"Unrecognized query purpose: \"+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Hr?e.toUnaryOrFieldFilter(t):g(\"Unrecognized filter: \"+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:\"AND\",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):g(\"Unknown filter: \"+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new ei(r,n)},t.prototype.toDirection=function(t){return li[t.name]},t.prototype.fromDirection=function(t){switch(t){case\"ASCENDING\":return ti.ASCENDING;case\"DESCENDING\":return ti.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return fi[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case\"EQUAL\":return zr.EQUAL;case\"GREATER_THAN\":return zr.GREATER_THAN;case\"GREATER_THAN_OR_EQUAL\":return zr.GREATER_THAN_OR_EQUAL;case\"LESS_THAN\":return zr.LESS_THAN;case\"LESS_THAN_OR_EQUAL\":return zr.LESS_THAN_OR_EQUAL;case\"ARRAY_CONTAINS\":return zr.ARRAY_CONTAINS;case\"IN\":return zr.IN;case\"ARRAY_CONTAINS_ANY\":return zr.ARRAY_CONTAINS_ANY;case\"OPERATOR_UNSPECIFIED\":return g(\"Unspecified operator\");default:return g(\"Unknown operator\")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return ct.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new ni(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return Hr.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===zr.EQUAL){if(t.value.isEqual(Nn.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:\"IS_NAN\"}};if(t.value.isEqual(Tn.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:\"IS_NULL\"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case\"IS_NAN\":var e=this.fromFieldPathReference(t.unaryFilter.field);return Hr.create(e,zr.EQUAL,Nn.NAN);case\"IS_NULL\":var n=this.fromFieldPathReference(t.unaryFilter.field);return Hr.create(n,zr.EQUAL,Tn.INSTANCE);case\"OPERATOR_UNSPECIFIED\":return g(\"Unspecified filter\");default:return g(\"Unknown filter\")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return ct.fromServerFormat(t)});return qn.fromArray(e)},t}(),gi=function(){return function(){this.listeners=[]}}(),vi=function(){function t(t){this.syncEngine=t,this.queries=new ge(function(t){return t.canonicalId()}),this.onlineState=fr.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new gi,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return s.__generator(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++){s[a].onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){i[r].applyOnlineStateChange(t)}})},t}(),bi=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=fr.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(v(t.docChanges.length>0||t.syncStateChanged,\"We got a new snapshot with no changes?\"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Ar.Metadata&&e.push(i)}t=new Rr(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(v(!this.raisedInitialEvent,\"Determining whether to raise first event but already had first event\"),!t.fromCache)return!0;var n=e!==fr.Offline;return this.options.waitForSyncWhenOnline&&n?(v(t.fromCache,\"Waiting for sync, but snapshot is not from cache\"),!1):!t.docs.isEmpty()||e===fr.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){v(!this.raisedInitialEvent,\"Trying to raise initial events for second time\"),t=Rr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),wi=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=Vt(),i=Vt(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Ar.Added:r=r.add(s.doc.key);break;case Ar.Removed:i=i.add(s.doc.key)}}return new t(e,r,i)},t}(),Ei=function(){return function(t){this.key=t}}(),Ti=function(){return function(t){this.key=t}}(),Ii=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Vt(),this.mutatedKeys=Vt(),this.documentSet=new Dr(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,\"syncedDocuments\",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Or,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),h=e instanceof de?e:null;h&&(v(t.isEqual(h.key),\"Mismatching keys found in document changes: \"+t+\" != \"+h.key),h=n.query.matches(h)?h:null);var l=!!c&&n.mutatedKeys.has(c.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;c&&h?c.data.isEqual(h.data)?l!==f&&(r.track({type:Ar.Metadata,doc:h}),p=!0):n.shouldWaitForSyncedDocument(c,h)||(r.track({type:Ar.Modified,doc:h}),p=!0,u&&n.query.docComparator(h,u)>0&&(s=!0)):!c&&h?(r.track({type:Ar.Added,doc:h}),p=!0):c&&!h&&(r.track({type:Ar.Removed,doc:c}),p=!0,u&&(s=!0));p&&(h?(a=a.add(h),o=f?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Ar.Removed,doc:c})}return v(!s||!e,\"View was refilled using docs that themselves needed refilling.\"),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;v(!t.needsRefill,\"Cannot apply changes that need a refill\");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case Ar.Added:return 1;case Ar.Modified:case Ar.Metadata:return 2;case Ar.Removed:return 0;default:return g(\"Unknown ChangeType: \"+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Nr.Synced:Nr.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Rr(this.query,t.documentSet,i,o,t.mutatedKeys,s===Nr.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===fr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Or,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return v(e._syncedDocuments.has(t),\"Modified document \"+t+\" not found in view.\")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Vt(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Ti(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Ei(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=Vt();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return Rr.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Nr.Local)},t}();var Si=function(){return function(t,e,n){this.query=t,this.targetId=e,this.view=n}}(),Ci=function(){return function(t){this.key=t}}(),_i=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new ge(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new St(ht.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new zn,this.mutationUserCallbacks={},this.limboTargetIdGenerator=Zt.forSyncEngine(),this.isPrimary=void 0,this.onlineState=fr.Unknown}return Object.defineProperty(t.prototype,\"isPrimaryClient\",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){v(null!==t,\"SyncEngine listener cannot be null\"),v(null===this.syncEngineListener,\"SyncEngine already has a subscriber.\"),this.syncEngineListener=t},t.prototype.listen=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return s.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed(\"listen()\"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,\"current\"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,u,c,h;return s.__generator(this,function(s){switch(s.label){case 0:return n=t.query,[4,this.localStore.executeQuery(n)];case 1:return r=s.sent(),[4,this.localStore.remoteDocumentKeys(t.targetId)];case 2:return i=s.sent(),o=new Ii(n,i),a=o.computeDocChanges(r),u=Pr.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&this.onlineState!==fr.Offline),v(0===(c=o.applyChanges(a,!0===this.isPrimary,u)).limboChanges.length,\"View returned limbo docs before target ack from the server.\"),v(!!c.snapshot,\"applyChanges for new view should always return a snapshot\"),h=new Si(n,t.targetId,o),this.queryViewsByQuery.set(n,h),this.queryViewsByTarget[t.targetId]=h,[2,c.snapshot]}})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r;return s.__generator(this,function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t.query)];case 1:return e=i.sent(),[4,this.localStore.remoteDocumentKeys(t.targetId)];case 2:return n=i.sent(),r=t.view.synchronizeWithPersistedState(e,n),this.isPrimary&&this.updateTrackedLimbos(t.targetId,r.limboChanges),[2,r]}})})},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed(\"unlisten()\"),v(!!(e=this.queryViewsByQuery.get(t)),\"Trying to unlisten on query not found:\"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(pn)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed(\"write()\"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}})})},t.prototype.runTransaction=function(t,e){return void 0===e&&(e=5),s.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return s.__generator(this,function(a){switch(a.label){case 0:if(v(e>=0,\"Got negative number of retries for transaction.\"),n=this.remoteStore.createTransaction(),ur(r=t(n))||!r.catch||!r.then)return[2,Promise.reject(Error(\"Transaction callback must return a Promise\"))];a.label=1;case 1:return a.trys.push([1,4,,5]),[4,r];case 2:return i=a.sent(),[4,n.commit()];case 3:return a.sent(),[2,i];case 4:return o=a.sent(),e>0&&this.isRetryableTransactionError(o)?[2,this.runTransaction(t,e-1)]:[2,Promise.reject(o)];case 5:return[2]}})})},t.prototype.applyRemoteEvent=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed(\"applyRemoteEvent()\"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),A(t.targetChanges,function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,\"Limbo resolution for single document contains multiple changes.\"),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?v(r.receivedDocument,\"Received change for limbo target document without add.\"):e.removedDocuments.size>0&&(v(r.receivedDocument,\"Received remove for limbo target document without add.\"),r.receivedDocument=!1))}),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,pn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===pr.RemoteStore||!this.isPrimary&&e===pr.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);v(0===i.limboChanges.length,\"OnlineState should not affect limbo documents.\"),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,u,c=this;return s.__generator(this,function(s){switch(s.label){case 0:return this.assertSubscribed(\"rejectListens()\"),this.sharedClientState.updateQueryState(t,\"rejected\",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new St(ht.comparator)).insert(r,new me(r,It.forDeletedDoc())),o=Vt().add(r),a=new Mr(It.MIN,{},new Nt(H),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return v(!!(u=this.queryViewsByTarget[t]),\"Unknown targetId: \"+t),[4,this.localStore.releaseQuery(u.query,!1).then(function(){return c.removeAndCleanupQuery(u)}).catch(pn)];case 2:s.sent(),this.syncEngineListener.onWatchError(u.query,e),s.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed(\"applyBatchState()\"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(d(\"SyncEngine\",\"Cannot apply mutation batch with id: \"+t),[2]):\"pending\"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:\"acknowledged\"===e||\"rejected\"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):g(\"Unknown batchState: \"+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed(\"applySuccessfulWrite()\"),e=t.batch.batchId,this.processUserCallback(e,null),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,\"acknowledged\"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,pn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.rejectFailedWrite=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed(\"rejectFailedWrite()\"),this.processUserCallback(t,e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,\"rejected\",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,pn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new St(H)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(v(t===n.minKey(),\"Mutation callbacks processed out-of-order?\"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof Ei)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof Ti){d(\"SyncEngine\",\"Document no longer in limbo: \"+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else g(\"Unknown limbo change: \"+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){d(\"SyncEngine\",\"New document in limbo: \"+e);var n=this.limboTargetIdGenerator.next(),r=Wr.atPath(e.path);this.limboResolutionsByTarget[n]=new Ci(e),this.remoteStore.listen(new Je(r,n,ze.LimboResolution,ot.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return s.__generator(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?\"not-current\":\"current\"),n.push(a.snapshot);var u=wi.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){v(null!==this.syncEngineListener,\"Trying to call \"+t+\" before calling subscribe().\")},t.prototype.handleCredentialChange=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c=this;return s.__generator(this,function(s){switch(s.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return s.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=s.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],u=Promise.resolve(),_(this.queryViewsByTarget,function(t,e){c.sharedClientState.isLocalQueryTarget(t)?a.push(t):u=u.then(function(){return c.unlisten(e.query)}),c.remoteStore.unlisten(e.targetId)}),[4,u]);case 4:return s.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return s.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:s.sent(),s.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;_(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new St(ht.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c,h;return s.__generator(this,function(s){switch(s.label){case 0:e=[],n=[],r=0,i=t,s.label=1;case 1:return r<i.length?(o=i[r],a=void 0,(u=this.queryViewsByTarget[o])?[4,this.localStore.releaseQuery(u.query,!0)]:[3,5]):[3,11];case 2:return s.sent(),[4,this.localStore.allocateQuery(u.query)];case 3:return a=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(u)];case 4:return(c=s.sent()).snapshot&&n.push(c.snapshot),[3,9];case 5:return v(!0===this.isPrimary,\"A secondary tab should never have an active query without an active view.\"),[4,this.localStore.getQueryForTarget(o)];case 6:return v(!!(h=s.sent()),\"Query data for target \"+o+\" not found\"),[4,this.localStore.allocateQuery(h)];case 7:return a=s.sent(),[4,this.initializeViewAndComputeSnapshot(a,!1)];case 8:s.sent(),s.label=9;case 9:e.push(a),s.label=10;case 10:return r++,[3,1];case 11:return this.syncEngineListener.onWatchChange(n),[2,e]}})})},t.prototype.isRetryableTransactionError=function(t){if(\"FirebaseError\"===t.name){var e=t.code;return\"aborted\"===e||\"failed-precondition\"===e||!Sr(e)}return!1},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r,i,o,a,u;return s.__generator(this,function(s){switch(s.label){case 0:if(this.isPrimary)return d(\"SyncEngine\",\"Ignoring unexpected query state notification.\"),[2];if(!this.queryViewsByTarget[t])return[3,11];switch(e){case\"current\":case\"not-current\":return[3,1];case\"rejected\":return[3,8]}return[3,10];case 1:return s.trys.push([1,4,,8]),[4,this.localStore.getNewDocumentChanges()];case 2:return r=s.sent(),i=Mr.createSynthesizedRemoteEventForCurrentChange(t,\"current\"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return s.sent(),[3,11];case 4:return o=s.sent(),(c=o).code!==E.DATA_LOSS||c.message!==be?[3,6]:(a=[],_(this.queryViewsByTarget,function(t){return a.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)]);case 5:return s.sent(),[3,7];case 6:throw o;case 7:return[3,8];case 8:return u=this.queryViewsByTarget[t],this.removeAndCleanupQuery(u),[4,this.localStore.releaseQuery(u.query,!0)];case 9:return s.sent(),this.syncEngineListener.onWatchError(u.query,n),[3,11];case 10:g(\"Unexpected target state: \"+e),s.label=11;case 11:return[2]}var c})})},t.prototype.applyActiveTargetsChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,u,c,h,l,f=this;return s.__generator(this,function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,p.label=1;case 1:return n<r.length?(l=r[n],v(!this.queryViewsByTarget[l],\"Trying to add an already active target\"),[4,this.localStore.getQueryForTarget(l)]):[3,6];case 2:return v(!!(i=p.sent()),\"Query data for active target \"+l+\" not found\"),[4,this.localStore.allocateQuery(i)];case 3:return o=p.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:p.sent(),this.remoteStore.listen(o),p.label=5;case 5:return n++,[3,1];case 6:a=function(t){var e;return s.__generator(this,function(n){switch(n.label){case 0:return(e=u.queryViewsByTarget[t])?[4,u.localStore.releaseQuery(e.query,!1).then(function(){f.remoteStore.unlisten(t),f.removeAndCleanupQuery(e)}).catch(pn)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},u=this,c=0,h=e,p.label=7;case 7:return c<h.length?(l=h[c],[5,a(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?Vt().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:Vt()},t}(),Ai=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?\"uid:\"+this.uid:\"anonymous-user\"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t(\"google-credentials-uid\"),t.FIRST_PARTY=new t(\"first-party-uid\"),t}(),Ni=\"SharedClientState\",Di=\"firestore_clients\",ki=\"firestore_mutations\",Oi=\"firestore_targets\",Ri=\"firestore_online_state\",Mi=\"firestore_sequence_number\",Pi=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,v(void 0!==r===(\"rejected\"===n),\"MutationMetadata must contain an error iff state is 'rejected'\")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o=\"object\"===typeof i&&-1!==[\"pending\",\"acknowledged\",\"rejected\"].indexOf(i.state)&&(void 0===i.error||\"object\"===typeof i.error),a=void 0;return o&&i.error&&(o=\"string\"===typeof i.error.message&&\"string\"===typeof i.error.code)&&(a=new T(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(m(Ni,\"Failed to parse mutation state for ID '\"+n+\"': \"+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Li=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,v(void 0!==n===(\"rejected\"===e),\"QueryTargetMetadata must contain an error iff state is 'rejected'\")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i=\"object\"===typeof r&&-1!==[\"not-current\",\"current\",\"rejected\"].indexOf(r.state)&&(void 0===r.error||\"object\"===typeof r.error),o=void 0;return i&&r.error&&(i=\"string\"===typeof r.error.message&&\"string\"===typeof r.error.code)&&(o=new T(r.error.code,r.error.message)),i?new t(e,r.state,o):(m(Ni,\"Failed to parse target state for ID '\"+e+\"': \"+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i=\"object\"===typeof r&&r.activeTargetIds instanceof Array,o=Ut(),a=0;i&&a<r.activeTargetIds.length;++a)i=cr(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(m(Ni,\"Failed to parse client data for instance '\"+e+\"': \"+n),null)},t}(),qi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return\"object\"===typeof n&&n.onlineState in fr&&\"string\"===typeof n.clientId?new t(n.clientId,fr[n.onlineState]):(m(Ni,\"Failed to parse online state: \"+e),null)},t}(),Vi=function(){function t(){this.activeTargetIds=Ut()}return t.prototype.addQueryTarget=function(t){v(!this.activeTargetIds.has(t),\"Target with ID '\"+t+\"' already active.\"),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Fi=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new T(E.UNIMPLEMENTED,\"LocalStorage is not available on this platform.\");var a=r.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Mi+\"_\"+r,this.activeClients[this.localClientId]=new Vi,this.clientStateKeyRe=new RegExp(\"^\"+Di+\"_\"+a+\"_([^_]*)$\"),this.mutationBatchKeyRe=new RegExp(\"^\"+ki+\"_\"+a+\"_(\\\\d+)(?:_(.*))?$\"),this.queryTargetKeyRe=new RegExp(\"^\"+Oi+\"_\"+a+\"_(\\\\d+)$\"),this.onlineStateKey=Ri+\"_\"+r,this.platform.window.addEventListener(\"storage\",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,a,u,c,h,l,f=this;return s.__generator(this,function(s){switch(s.label){case 0:return v(!this.started,\"WebStorageSharedClientState already started\"),v(null!==this.syncEngine,\"syncEngine property must be set before calling start()\"),v(null!==this.onlineStateHandler,\"onlineStateHandler property must be set before calling start()\"),[4,this.syncEngine.getActiveClients()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=xi.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(u),c=0,h=this.earlyEvents;c<h.length;c++)l=h[c],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener(\"unload\",function(){return f.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=Ut();return A(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,\"pending\")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e=\"not-current\";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Li.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener(\"storage\",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d(Ni,\"READ\",t,e),e},t.prototype.setItem=function(t,e){d(Ni,\"SET\",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d(Ni,\"REMOVE\",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(d(Ni,\"EVENT\",t.key,t.newValue),t.key===this.localClientStorageKey)return void m(\"Received WebStorage notification for local change. Another client might have garbage-collected our state\");this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,a;return s.__generator(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(v(!!this.sequenceNumberHandler,\"Missing sequenceNumberHandler\"),(a=function(t){var e=ot.INVALID;if(null!=t)try{var n=JSON.parse(t);v(\"number\"===typeof n,\"Found non-numeric sequence number\"),e=n}catch(r){m(Ni,\"Failed to read sequence number from WebStorage\",r)}return e}(t.newValue))!==ot.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,\"localClientState\",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Pi(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:fr[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Li(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return v(-1===t.indexOf(\"_\"),\"Client key cannot contain '_', but was '\"+t+\"'\"),Di+\"_\"+this.persistenceKey+\"_\"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return Oi+\"_\"+this.persistenceKey+\"_\"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=ki+\"_\"+this.persistenceKey+\"_\"+t;return this.currentUser.isAuthenticated()&&(e+=\"_\"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return v(null!==n,\"Cannot parse client state key '\"+t+\"'\"),xi.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);v(null!==n,\"Cannot parse mutation batch key '\"+t+\"'\");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Pi.fromWebStorageEntry(new Ai(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);v(null!==n,\"Cannot parse query target key '\"+t+\"'\");var r=Number(n[1]);return Li.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return qi.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return t.user.uid!==this.currentUser.uid?(d(Ni,\"Ignoring mutation for non-active user \"+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();var Ui=function(){function t(){this.localState=new Vi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||\"not-current\"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Vi,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),Bi=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return nn.withCacheSize(this.cacheSizeBytes)},t}(),ji=function(){return function(){}}(),Ki=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=z.newId(),this._clientShutdown=!1}return t.prototype.start=function(t){var e=this;this.verifyNotShutdown();var n=new lt,r=new lt,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof Bi?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn(\"Error enabling offline persistence. Falling back to persistence disabled: \"+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof T?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(\"undefined\"!==typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.verifyNotShutdown=function(){if(this._clientShutdown)throw new T(E.FAILED_PRECONDITION,\"The client has already been shutdown.\")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=fn.buildStoragePrefix(this.databaseInfo),i=new yi(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return s.__awaiter(n,void 0,void 0,function(){var n,o;return s.__generator(this,function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!Fi.isAvailable(this.platform))throw new T(E.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");return o=e.lruParams(),e.synchronizeTabs?(this.sharedClientState=new Fi(this.asyncQueue,this.platform,r,this.clientId,t),[4,fn.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=a.sent(),[3,4];case 2:return this.sharedClientState=new Ui,[4,fn.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=a.sent(),a.label=4;case 4:return this.persistence=n,[2,n.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=tr.createEagerPersistence(this.clientId),this.sharedClientState=new Ui,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return d(\"FirestoreClient\",\"Initializing. user=\",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return s.__awaiter(n,void 0,void 0,function(){var n,i,o,a,u,c=this;return s.__generator(this,function(h){switch(h.label){case 0:return this.localStore=new Yn(this.persistence,t),e&&(this.lruScheduler=new rn(e,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),i=this.platform.newSerializer(this.databaseInfo.databaseId),o=new wr(this.asyncQueue,r,this.credentials,i),a=function(t){return c.syncEngine.applyOnlineStateChange(t,pr.RemoteStore)},u=function(t){return c.syncEngine.applyOnlineStateChange(t,pr.SharedClientState)},this.remoteStore=new Kr(this.localStore,o,this.asyncQueue,a,n),this.syncEngine=new _i(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new vi(this.syncEngine),[4,this.sharedClientState.start()];case 1:return h.sent(),[4,this.remoteStore.start()];case 2:return h.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return s.__awaiter(c,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return h.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return s.__awaiter(c,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return[4,this.shutdown()];case 1:return t.sent(),[2]}})})})];case 4:return h.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),d(\"FirestoreClient\",\"Credential Changed. Current user: \"+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.enqueue(function(){return s.__awaiter(t,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this._clientShutdown?[3,4]:(this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()]);case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:t.sent(),this.credentials.removeChangeListener(),this._clientShutdown=!0,t.label=4;case 4:return[2]}})})})},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotShutdown();var i=new bi(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.verifyNotShutdown(),this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof de)return t;if(t instanceof me)return null;throw new T(E.UNAVAILABLE,\"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)\")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=Vt(),r=new Ii(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this;this.verifyNotShutdown();var n=new lt;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},Object.defineProperty(t.prototype,\"clientShutdown\",{get:function(){return this._clientShutdown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Qi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Wi=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+n+\" argument to be an array with at least \"+G(r,\"element\")+\".\")}(\"FieldPath\",t,\"fieldNames\",1);for(var n=0;n<t.length;++n)if(M(\"FieldPath\",\"string\",n,t[n]),0===t[n].length)throw new T(E.INVALID_ARGUMENT,\"Invalid field name at argument $(i + 1). Field names must not be empty.\");this._internalPath=new ct(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q(\"isEqual\",\"FieldPath\",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(ct.keyField().canonicalString()),t}(),Gi=new RegExp(\"[~\\\\*/\\\\[\\\\]]\");var zi=function(){return function(t,e){this.user=e,this.type=\"OAuth\",this.authHeaders={Authorization:\"Bearer \"+t}}}(),Hi=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){v(!this.changeListener,\"Can only call setChangeListener() once.\"),this.changeListener=t,t(Ai.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){v(null!==this.changeListener,\"removeChangeListener() when no listener registered\"),this.changeListener=null},t}(),Yi=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;v(null!=this.tokenListener,\"getToken cannot be called after listener removed.\");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new T(E.ABORTED,\"getToken aborted due to token change.\");return n?(v(\"string\"===typeof n.accessToken,\"Invalid tokenData returned from getToken():\"+n),new zi(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){v(!this.changeListener,\"Can only call setChangeListener() once.\"),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){v(null!=this.tokenListener,\"removeChangeListener() called twice\"),v(null!==this.changeListener,\"removeChangeListener() called when no listener registered\"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return v(null===t||\"string\"===typeof t,\"Received invalid UID: \"+t),new Ai(t)},t}(),Xi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type=\"FirstParty\",this.user=Ai.FIRST_PARTY}return Object.defineProperty(t.prototype,\"authHeaders\",{get:function(){var t={\"X-Goog-AuthUser\":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),Ji=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new Xi(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Ai.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function $i(t){return function(t,e){if(\"object\"!==typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&\"function\"===typeof n[o])return!0}return!1}(t,[\"next\",\"error\",\"complete\"])}var Zi,to=function(){function t(t){this._methodName=t}return t.delete=function(){return D(\"FieldValue.delete\",arguments),eo.instance},t.serverTimestamp=function(){return D(\"FieldValue.serverTimestamp\",arguments),no.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return O(\"FieldValue.arrayUnion\",arguments,1),new ro(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return O(\"FieldValue.arrayRemove\",arguments,1),new io(t)},t.increment=function(t){return M(\"FieldValue.increment\",\"number\",1,t),k(\"FieldValue.increment\",arguments,1),new oo(t)},t.prototype.isEqual=function(t){return this===t},t}(),eo=function(t){function e(){return t.call(this,\"FieldValue.delete\")||this}return s.__extends(e,t),e.instance=new e,e}(to),no=function(t){function e(){return t.call(this,\"FieldValue.serverTimestamp\")||this}return s.__extends(e,t),e.instance=new e,e}(to),ro=function(t){function e(e){var n=t.call(this,\"FieldValue.arrayUnion\")||this;return n._elements=e,n}return s.__extends(e,t),e}(to),io=function(t){function e(e){var n=t.call(this,\"FieldValue.arrayRemove\")||this;return n._elements=e,n}return s.__extends(e,t),e}(to),oo=function(t){function e(e){var n=t.call(this,\"FieldValue.increment\")||this;return n._operand=e,n}return s.__extends(e,t),e}(to),ao=I(to,\"Use FieldValue.<field>() instead.\"),so=/^__.*__$/,uo=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Kn(t,this.data,this.fieldMask,e)):n.push(new jn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Qn(t,this.fieldTransforms)),n},t}(),co=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Kn(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Qn(t,this.fieldTransforms)),n},t}();function ho(t){switch(t){case Zi.Set:case Zi.MergeSet:case Zi.Update:return!0;case Zi.Argument:return!1;default:throw g(\"Unexpected case for UserDataSource: \"+t)}}!function(t){t[t.Set=0]=\"Set\",t[t.Update=1]=\"Update\",t[t.MergeSet=2]=\"MergeSet\",t[t.Argument=3]=\"Argument\"}(Zi||(Zi={}));var lo=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?\"\":\" (found in field \"+this.path.toString()+\")\";return new T(E.INVALID_ARGUMENT,\"Function \"+this.methodName+\"() called with invalid data. \"+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(ho(this.dataSource)&&so.test(t))throw this.createError(\"Document fields cannot begin and end with __\")},t}(),fo=function(){return function(t,e){this.databaseId=t,this.key=e}}(),po=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new lo(Zi.Set,t,ct.EMPTY_PATH);yo(\"Data must be an object, but it was:\",n,e);var r=this.parseData(e,n);return new uo(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new lo(Zi.MergeSet,t,ct.EMPTY_PATH);yo(\"Data must be an object, but it was:\",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Nt(ct.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof Wi)l=h._internalPath;else{if(\"string\"!==typeof h)throw g(\"Expected stringOrFieldPath to be a string or a FieldPath\");l=vo(t,h)}if(!r.contains(l))throw new T(E.INVALID_ARGUMENT,\"Field '\"+l+\"' is specified in your field mask but missing from your input data.\");s=s.add(l)}i=qn.fromSet(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=qn.fromArray(r.fieldMask),o=r.fieldTransforms;return new uo(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new lo(Zi.Update,t,ct.EMPTY_PATH);yo(\"Data must be an object, but it was:\",r,e);var i=new Nt(ct.comparator),o=Ln.EMPTY;A(e,function(e,a){var s=vo(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof eo)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=qn.fromSet(i);return new co(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new lo(Zi.Update,t,ct.EMPTY_PATH),o=[go(t,e)],a=[n];if(r.length%2!==0)throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() needs to be called with an even number of arguments that alternate between field names and values.\");for(var s=0;s<r.length;s+=2)o.push(go(t,r[s])),a.push(r[s+1]);var u=new Nt(ct.comparator),c=Ln.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof eo)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=qn.fromSet(u);return new co(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new lo(Zi.Argument,t,ct.EMPTY_PATH),r=this.parseData(e,n);return v(null!=r,\"Parsed data should not be null.\"),v(0===n.fieldTransforms.length,\"Field transforms should have been disallowed.\"),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=bo(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(mo(t=this.runPreConverter(t,e)))return yo(\"Unsupported field value:\",e,t),this.parseObject(t,e);if(t instanceof to)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError(\"Nested arrays are not supported\");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new St(H);return N(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):A(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Ln(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Tn.INSTANCE),n.push(s),r++}return new xn(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!ho(e.dataSource))throw e.createError(t._methodName+\"() can only be used with update() and set()\");if(null===e.path)throw e.createError(t._methodName+\"() is not currently supported inside arrays\");if(t instanceof eo){if(e.dataSource!==Zi.MergeSet)throw e.dataSource===Zi.Update?(v(e.path.length>0,\"FieldValue.delete() at the top level should have already been handled.\"),e.createError(\"FieldValue.delete() can only appear at the top level of your update data\")):e.createError(\"FieldValue.delete() cannot be used with set() unless you pass {merge:true}\");e.fieldMask.push(e.path)}else if(t instanceof no)e.fieldTransforms.push(new Vn(e.path,oi.instance));else if(t instanceof ro){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new ai(n);e.fieldTransforms.push(new Vn(e.path,r))}else if(t instanceof io){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new si(n);e.fieldTransforms.push(new Vn(e.path,i))}else if(t instanceof oo){var o=this.parseQueryValue(\"FieldValue.increment\",t._operand),a=new ui(o);e.fieldTransforms.push(new Vn(e.path,a))}else g(\"Unknown FieldValue type: \"+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Tn.INSTANCE;if(\"number\"===typeof t)return cr(t)?new An(t):new Nn(t);if(\"boolean\"===typeof t)return In.of(t);if(\"string\"===typeof t)return new Dn(t);if(t instanceof Date)return new kn(Tt.fromDate(t));if(t instanceof Tt)return new kn(new Tt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof Qr)return new Pn(t);if(t instanceof tt)return new Rn(t);if(t instanceof fo)return new Mn(t.databaseId,t.key);throw e.createError(\"Unsupported field value: \"+B(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new lo(Zi.Argument,t,ct.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function mo(t){return\"object\"===typeof t&&null!==t&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof Tt)&&!(t instanceof Qr)&&!(t instanceof tt)&&!(t instanceof fo)&&!(t instanceof to)}function yo(t,e,n){if(!mo(n)||!U(n)){var r=B(n);throw\"an object\"===r?e.createError(t+\" a custom object\"):e.createError(t+\" \"+r)}}function go(t,e){if(e instanceof Wi)return e._internalPath;if(\"string\"===typeof e)return vo(t,e);throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() called with invalid data. Field path arguments must be of type string or FieldPath.\")}function vo(t,e){try{return function(t){if(t.search(Gi)>=0)throw new T(E.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not contain '~', '*', '/', '[', or ']'\");try{return new(Wi.bind.apply(Wi,[void 0].concat(t.split(\".\"))))}catch(e){throw new T(E.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\")}}(e)._internalPath}catch(r){var n=bo(r);throw new T(E.INVALID_ARGUMENT,\"Function \"+t+\"() called with invalid data. \"+n)}}function bo(t){return t instanceof Error?t.message:t.toString()}var wo=\"firestore.googleapis.com\",Eo=!0,To=!0,Io=!1,So=nn.COLLECTION_DISABLED,Co=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new T(E.INVALID_ARGUMENT,\"Can't provide ssl option if host option is not set\");this.host=wo,this.ssl=Eo}else L(\"settings\",\"non-empty string\",\"host\",t.host),this.host=t.host,x(\"settings\",\"boolean\",\"ssl\",t.ssl),this.ssl=C(t.ssl,Eo);if(K(\"settings\",t,[\"host\",\"ssl\",\"credentials\",\"timestampsInSnapshots\",\"cacheSizeBytes\",\"experimentalForceLongPolling\"]),x(\"settings\",\"object\",\"credentials\",t.credentials),this.credentials=t.credentials,x(\"settings\",\"boolean\",\"timestampsInSnapshots\",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?m(\"\\n  The timestampsInSnapshots setting now defaults to true and you no\\n  longer need to explicitly set it. In a future release, the setting\\n  will be removed entirely and so it is recommended that you remove it\\n  from your firestore.settings() call now.\"):!1===t.timestampsInSnapshots&&m(\"\\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\\n  YOUR CODE.\\n\\n  To hide this warning, stop using the timestampsInSnapshots setting in your\\n  firestore.settings({ ... }) call.\\n\\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\\n  read back as Firebase Timestamp objects instead of as system Date objects.\\n  So you will also need to update code expecting a Date to instead expect a\\n  Timestamp. For example:\\n\\n  // Old:\\n  const date = snapshot.get('created_at');\\n  // New:\\n  const timestamp = snapshot.get('created_at'); const date =\\n  timestamp.toDate();\\n\\n  Please audit all existing usages of Date when you enable the new\\n  behavior.\"),this.timestampsInSnapshots=C(t.timestampsInSnapshots,To),x(\"settings\",\"number\",\"cacheSizeBytes\",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=nn.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==So&&t.cacheSizeBytes<nn.MINIMUM_CACHE_SIZE_BYTES)throw new T(E.INVALID_ARGUMENT,\"cacheSizeBytes must be at least \"+nn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}x(\"settings\",\"boolean\",\"experimentalForceLongPolling\",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?Io:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),_o=function(){return function(){}}(),Ao=function(){function t(e){var n=this;this._queue=new pt,this.INTERNAL={delete:function(){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.shutdown()];case 1:return t.sent(),[2]}})})}};var r=new _o;if(\"object\"===typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Yi(i)}else{var o=e;if(!o.projectId)throw new T(E.INVALID_ARGUMENT,\"Must provide projectId\");r.databaseId=new it(o.projectId,o.database),r.persistenceKey=\"[DEFAULT]\",r.credentials=new Hi}r.settings=new Co({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(k(\"Firestore.settings\",arguments,1),M(\"Firestore.settings\",\"object\",1,t),S(t,\"persistence\"))throw new T(E.INVALID_ARGUMENT,'\"persistence\" is now specified with a separate call to firestore.enablePersistence().');var e=new Co(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new T(E.FAILED_PRECONDITION,\"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.\");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=function(t){if(!t)return new Hi;switch(t.type){case\"gapi\":var e=t.client;return v(!(\"object\"!==typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),\"unexpected gapi interface\"),new Ji(e,t.sessionIndex||\"0\");case\"provider\":return t.client;default:throw new T(E.INVALID_ARGUMENT,\"makeCredentialsProvider failed due to invalid credential type\")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new T(E.FAILED_PRECONDITION,\"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.\");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&m(\"The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'.\"),e=C(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new Bi(this._config.settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=fn.buildStoragePrefix(this.makeDatabaseInfo()),n=new lt;return this._queue.enqueueAndForget(function(){return s.__awaiter(t,void 0,void 0,function(){var t;return s.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientShutdown)throw new T(E.FAILED_PRECONDITION,\"Persistence cannot be cleared after this Firestore instance is initialized.\");return[4,fn.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new ji),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new nt(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl,this._config.settings.forceLongPolling)},t.prototype.configureClient=function(t){var e=this;v(!!this._config.settings.host,\"FirestoreSettings.host cannot be falsey\"),v(!this._firestoreClient,\"configureClient() called multiple times\");var n=this.makeDatabaseInfo();return this._dataConverter=new po(function(t){if(t instanceof ko){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new T(E.INVALID_ARGUMENT,\"Document reference is for database \"+r.projectId+\"/\"+r.database+\" but should be for database \"+n.projectId+\"/\"+n.database);return new fo(e._config.databaseId,t._key)}return t}),this._firestoreClient=new Ki(b.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!S(e,\"projectId\"))throw new T(E.INVALID_ARGUMENT,'\"projectId\" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||\"string\"!==typeof n)throw new T(E.INVALID_ARGUMENT,\"projectId must be a string in FirebaseApp.options\");return new it(n)},Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this._config.firebaseApp)throw new T(E.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return k(\"Firestore.collection\",arguments,1),M(\"Firestore.collection\",\"non-empty string\",1,t),this.ensureClientConfigured(),new xo(st.fromString(t),this)},t.prototype.doc=function(t){return k(\"Firestore.doc\",arguments,1),M(\"Firestore.doc\",\"non-empty string\",1,t),this.ensureClientConfigured(),ko.forPath(st.fromString(t),this)},t.prototype.collectionGroup=function(t){if(k(\"Firestore.collectionGroup\",arguments,1),M(\"Firestore.collectionGroup\",\"non-empty string\",1,t),t.indexOf(\"/\")>=0)throw new T(E.INVALID_ARGUMENT,\"Invalid collection ID '\"+t+\"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.\");return this.ensureClientConfigured(),new Po(new Wr(st.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return k(\"Firestore.runTransaction\",arguments,1),M(\"Firestore.runTransaction\",\"function\",1,t),this.ensureClientConfigured().transaction(function(n){return t(new No(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Do(this)},Object.defineProperty(t,\"logLevel\",{get:function(){switch(f()){case i.DEBUG:return\"debug\";case i.ERROR:return\"error\";case i.SILENT:return\"silent\";default:return g(\"Unknown log level: \"+f())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(k(\"Firestore.setLogLevel\",arguments,1),M(\"Firestore.setLogLevel\",\"non-empty string\",1,t),t){case\"debug\":p(i.DEBUG);break;case\"error\":p(i.ERROR);break;case\"silent\":p(i.SILENT);break;default:throw new T(E.INVALID_ARGUMENT,\"Invalid log level: \"+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),No=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;k(\"Transaction.get\",arguments,1);var n=Uo(\"Transaction.get\",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return g(\"Mismatch in docs returned from document lookup.\");var r=t[0];if(r instanceof me)return new Ro(e._firestore,n._key,null,!1,!1);if(r instanceof de)return new Ro(e._firestore,n._key,r,!1,!1);throw g(\"BatchGetDocumentsRequest returned unexpected document type: \"+r.constructor.name)})},t.prototype.set=function(t,e,n){R(\"Transaction.set\",arguments,2,3);var r=Uo(\"Transaction.set\",t,this._firestore),i=(n=qo(\"Transaction.set\",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(\"Transaction.set\",e,n.mergeFields):this._firestore._dataConverter.parseSetData(\"Transaction.set\",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return\"string\"===typeof e||e instanceof Wi?(O(\"Transaction.update\",arguments,3),r=Uo(\"Transaction.update\",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs(\"Transaction.update\",e,n,o)):(k(\"Transaction.update\",arguments,2),r=Uo(\"Transaction.update\",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData(\"Transaction.update\",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){k(\"Transaction.delete\",arguments,1);var e=Uo(\"Transaction.delete\",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Do=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){R(\"WriteBatch.set\",arguments,2,3),this.verifyNotCommitted();var r=Uo(\"WriteBatch.set\",t,this._firestore),i=(n=qo(\"WriteBatch.set\",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(\"WriteBatch.set\",e,n.mergeFields):this._firestore._dataConverter.parseSetData(\"WriteBatch.set\",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,Un.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),\"string\"===typeof e||e instanceof Wi?(O(\"WriteBatch.update\",arguments,3),r=Uo(\"WriteBatch.update\",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs(\"WriteBatch.update\",e,n,o)):(k(\"WriteBatch.update\",arguments,2),r=Uo(\"WriteBatch.update\",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData(\"WriteBatch.update\",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Un.exists(!0))),this},t.prototype.delete=function(t){k(\"WriteBatch.delete\",arguments,1),this.verifyNotCommitted();var e=Uo(\"WriteBatch.delete\",t,this._firestore);return this._mutations=this._mutations.concat(new Wn(e._key,Un.NONE)),this},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new T(E.FAILED_PRECONDITION,\"A write batch can no longer be used after commit() has been called.\")},t}(),ko=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!==0)throw new T(E.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+e.canonicalString()+\" has \"+e.length);return new t(new ht(e),n)},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new xo(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(k(\"DocumentReference.collection\",arguments,1),M(\"DocumentReference.collection\",\"non-empty string\",1,t),!t)throw new T(E.INVALID_ARGUMENT,\"Must provide a non-empty collection name to collection()\");var e=st.fromString(t);return new xo(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q(\"isEqual\",\"DocumentReference\",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){R(\"DocumentReference.set\",arguments,1,2);var n=(e=qo(\"DocumentReference.set\",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData(\"DocumentReference.set\",t,e.mergeFields):this.firestore._dataConverter.parseSetData(\"DocumentReference.set\",t);return this._firestoreClient.write(n.toMutations(this._key,Un.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return\"string\"===typeof t||t instanceof Wi?(O(\"DocumentReference.update\",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs(\"DocumentReference.update\",t,e,r)):(k(\"DocumentReference.update\",arguments,1),n=this.firestore._dataConverter.parseUpdateData(\"DocumentReference.update\",t)),this._firestoreClient.write(n.toMutations(this._key,Un.exists(!0)))},t.prototype.delete=function(){return k(\"DocumentReference.delete\",arguments,0),this._firestoreClient.write([new Wn(this._key,Un.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];R(\"DocumentReference.onSnapshot\",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;\"object\"!==typeof t[i]||$i(t[i])||(K(\"DocumentReference.onSnapshot\",r=t[i],[\"includeMetadataChanges\"]),x(\"DocumentReference.onSnapshot\",\"boolean\",\"includeMetadataChanges\",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return $i(t[i])?n=t[i]:(M(\"DocumentReference.onSnapshot\",\"function\",i,t[i]),P(\"DocumentReference.onSnapshot\",\"function\",i+1,t[i+1]),P(\"DocumentReference.onSnapshot\",\"function\",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error(\"Uncaught Error in onSnapshot:\",t)};e.error&&(r=e.error.bind(e));var i=new Qi({next:function(t){if(e.next){v(t.docs.size<=1,\"Too many documents returned on a document query\");var r=t.docs.get(n._key);e.next(new Ro(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(Wr.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return R(\"DocumentReference.get\",arguments,0,1),Fo(\"DocumentReference.get\",t),new Promise(function(n,r){t&&\"cache\"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new Ro(e.firestore,e._key,t,!0,t instanceof de&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new T(E.UNAVAILABLE,\"Failed to get document because the client is offline.\")):i.exists&&i.metadata.fromCache&&n&&\"server\"===n.source?e(new T(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)')):t(i)},error:e})},t}(),Oo=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Ro=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return R(\"DocumentSnapshot.data\",arguments,0,1),t=Vo(\"DocumentSnapshot.data\",t),this._document?this.convertObject(this._document.data,wn.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(R(\"DocumentSnapshot.get\",arguments,1,2),e=Vo(\"DocumentSnapshot.get\",e),this._document){var n=this._document.data.field(go(\"DocumentSnapshot.get\",t));if(null!==n)return this.convertValue(n,wn.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"ref\",{get:function(){return new ko(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"exists\",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return new Oo(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q(\"isEqual\",\"DocumentSnapshot\",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof Ln)return this.convertObject(t,e);if(t instanceof xn)return this.convertArray(t,e);if(t instanceof Mn){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||m(\"Document \"+this._key.path+\" contains a document reference within a different database (\"+t.databaseId.projectId+\"/\"+t.databaseId.database+\") which is not supported. It will be treated as a reference in the current database (\"+r.projectId+\"/\"+r.database+\") instead.\"),new ko(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return v(\"object\"===typeof n,\"Document in a QueryDocumentSnapshot should exist\"),n},e}(Ro),Po=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){if(k(\"Query.where\",arguments,3),j(\"Query.where\",3,r),\"in\"!==n&&\"array-contains-any\"!==n){!function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new T(E.INVALID_ARGUMENT,\"Invalid value \"+B(r)+\" provided to function \"+t+\"() for its \"+W(n)+\" argument. Acceptable values: \"+e.join(\", \"))}(\"Query.where\",[\"<\",\"<=\",\"==\",\">=\",\">\",\"array-contains\"],2,n)}var i,o=go(\"Query.where\",e),a=zr.fromString(n);if(o.isKeyField()){if(a===zr.ARRAY_CONTAINS||a===zr.ARRAY_CONTAINS_ANY)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. You can't perform '\"+a.toString()+\"' queries on FieldPath.documentId().\");if(a===zr.IN){this.validateDisjunctiveFilterElements(r,a);for(var s=[],u=0,c=r;u<c.length;u++){var h=c[u];s.push(this.parseDocumentIdValue(h))}i=new xn(s)}else i=this.parseDocumentIdValue(r)}else a!==zr.IN&&a!==zr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,a),i=this.firestore._dataConverter.parseQueryValue(\"Query.where\",r);var l=Hr.create(o,a,i);return this.validateNewFilter(l),new t(this._query.addFilter(l),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(R(\"Query.orderBy\",arguments,1,2),P(\"Query.orderBy\",\"non-empty string\",2,n),void 0===n||\"asc\"===n)r=ti.ASCENDING;else{if(\"desc\"!==n)throw new T(E.INVALID_ARGUMENT,\"Function Query.orderBy() has unknown direction '\"+n+\"', expected 'asc' or 'desc'.\");r=ti.DESCENDING}if(null!==this._query.startAt)throw new T(E.INVALID_ARGUMENT,\"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().\");if(null!==this._query.endAt)throw new T(E.INVALID_ARGUMENT,\"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().\");var i=go(\"Query.orderBy\",e),o=new ni(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(k(\"Query.limit\",arguments,1),M(\"Query.limit\",\"number\",1,e),e<=0)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. Query limit (\"+e+\") is invalid. Limit must be positive.\");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O(\"Query.startAt\",arguments,1);var i=this.boundFromDocOrFields(\"Query.startAt\",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O(\"Query.startAfter\",arguments,1);var i=this.boundFromDocOrFields(\"Query.startAfter\",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O(\"Query.endBefore\",arguments,1);var i=this.boundFromDocOrFields(\"Query.endBefore\",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O(\"Query.endAt\",arguments,1);var i=this.boundFromDocOrFields(\"Query.endAt\",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q(\"isEqual\",\"Query\",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(j(t,1,e),e instanceof Ro){if(n.length>0)throw new T(E.INVALID_ARGUMENT,\"Too many arguments provided to \"+t+\"().\");var i=e;if(!i.exists)throw new T(E.NOT_FOUND,\"Can't use a DocumentSnapshot that doesn't exist for \"+t+\"().\");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Mn(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof On)throw new T(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field \"'+a.field+'\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new T(E.INVALID_ARGUMENT,\"Invalid query. You are trying to start or end a query using a document for which the field '\"+u+\"' (used as the orderBy) does not exist.\")}r.push(s)}}return new ei(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new T(E.INVALID_ARGUMENT,\"Too many arguments provided to \"+t+\"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses\");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if(\"string\"!==typeof a)throw new T(E.INVALID_ARGUMENT,\"Invalid query. Expected a string for document ID in \"+t+\"(), but got a \"+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf(\"/\"))throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to \"+t+\"() must be a plain document ID, but '\"+a+\"' contains a slash.\");var s=this._query.path.child(st.fromString(a));if(!ht.isDocumentKey(s))throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to \"+t+\"() must result in a valid document path, but '\"+s+\"' is not because it contains an odd number of segments.\");var u=new ht(s);i.push(new Mn(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new ei(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];R(\"Query.onSnapshot\",arguments,1,4);var n,r={},i=0;return\"object\"!==typeof t[i]||$i(t[i])||(K(\"Query.onSnapshot\",r=t[i],[\"includeMetadataChanges\"]),x(\"Query.onSnapshot\",\"boolean\",\"includeMetadataChanges\",r.includeMetadataChanges),i++),$i(t[i])?n=t[i]:(M(\"Query.onSnapshot\",\"function\",i,t[i]),P(\"Query.onSnapshot\",\"function\",i+1,t[i+1]),P(\"Query.onSnapshot\",\"function\",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error(\"Uncaught Error in onSnapshot:\",t)};e.error&&(r=e.error.bind(e));var i=new Qi({next:function(t){e.next&&e.next(new Lo(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return R(\"Query.get\",arguments,0,1),Fo(\"Query.get\",t),new Promise(function(n,r){t&&\"cache\"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Lo(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&\"server\"===n.source?e(new T(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if(\"string\"===typeof t){if(\"\"===t)throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.\");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf(\"/\"))throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '\"+t+\"' contains a '/' character.\");var e=this._query.path.child(st.fromString(t));if(!ht.isDocumentKey(e))throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '\"+e+\"' is not because it has an odd number of segments (\"+e.length+\").\");return new Mn(this.firestore._databaseId,new ht(e))}if(t instanceof ko){var n=t;return new Mn(this.firestore._databaseId,n._key)}throw new T(E.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: \"+B(t)+\".\")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. A non-empty array is required for '\"+e.toString()+\"' filters.\");if(t.length>10)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters support a maximum of 10 elements in the value array.\");if(t.indexOf(null)>=0)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'null' in the value array.\");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new T(E.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'NaN' in the value array.\")},t.prototype.validateNewFilter=function(t){if(t instanceof Hr){var e=[zr.ARRAY_CONTAINS,zr.ARRAY_CONTAINS_ANY],n=[zr.IN,zr.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new T(E.INVALID_ARGUMENT,\"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '\"+o.toString()+\"' and '\"+t.field.toString()+\"'\");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new T(E.INVALID_ARGUMENT,\"Invalid query. You cannot use more than one '\"+t.op.toString()+\"' filter.\"):new T(E.INVALID_ARGUMENT,\"Invalid query. You cannot use '\"+t.op.toString()+\"' filters with '\"+s.toString()+\"' filters.\")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new T(E.INVALID_ARGUMENT,\"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '\"+t.toString()+\"' and so you must also use '\"+t.toString()+\"' as your first Query.orderBy(), but your first Query.orderBy() is on field '\"+e.toString()+\"' instead.\")},t}(),Lo=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Oo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;R(\"QuerySnapshot.forEach\",arguments,1,2),M(\"QuerySnapshot.forEach\",\"function\",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,\"query\",{get:function(){return new Po(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(K(\"QuerySnapshot.docChanges\",t,[\"includeMetadataChanges\"]),x(\"QuerySnapshot.docChanges\",\"boolean\",\"includeMetadataChanges\",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new T(E.INVALID_ARGUMENT,\"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().\");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Mo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return v(e.type===Ar.Added,\"Invalid event type for first snapshot\"),v(!r||n.query.docComparator(r,e.doc)<0,\"Got added events in wrong order\"),r=e.doc,{type:\"added\",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Ar.Metadata}).map(function(e){var r=new Mo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Ar.Added&&(v((i=o.indexOf(e.doc.key))>=0,\"Index for document not found\"),o=o.delete(e.doc.key)),e.type!==Ar.Removed&&(o=o.add(e.doc),a=o.indexOf(e.doc.key)),{type:Bo(e.type),doc:r,oldIndex:i,newIndex:a}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q(\"isEqual\",\"QuerySnapshot\",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Mo(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();[\"length\",\"forEach\",\"map\"].concat(\"undefined\"!==typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Lo.prototype.docChanges,t,{get:function(){return function(){throw new T(E.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like \"querySnapshot.docChanges\" should become \"querySnapshot.docChanges()\"')}()}})}catch(e){}});var xo=function(t){function e(e,n){var r=t.call(this,Wr.atPath(e),n)||this;if(e.length%2!==1)throw new T(E.INVALID_ARGUMENT,\"Invalid collection reference. Collection references must have an odd number of segments, but \"+e.canonicalString()+\" has \"+e.length);return r}return s.__extends(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new ko(new ht(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(R(\"CollectionReference.doc\",arguments,0,1),0===arguments.length&&(t=z.newId()),M(\"CollectionReference.doc\",\"non-empty string\",1,t),\"\"===t)throw new T(E.INVALID_ARGUMENT,\"Document path must be a non-empty string\");var e=st.fromString(t);return ko.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){k(\"CollectionReference.add\",arguments,1),M(\"CollectionReference.add\",\"object\",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Po);function qo(t,e){if(void 0===e)return{merge:!1};if(K(t,e,[\"merge\",\"mergeFields\"]),x(t,\"boolean\",\"merge\",e.merge),q(t,\"mergeFields\",\"a string or a FieldPath\",e.mergeFields,function(t){return\"string\"===typeof t||t instanceof Wi}),void 0!==e.mergeFields&&void 0!==e.merge)throw new T(E.INVALID_ARGUMENT,\"Invalid options passed to function \"+t+'(): You cannot specify both \"merge\" and \"mergeFields\".');return e}function Vo(t,e){return void 0===e?{}:(K(t,e,[\"serverTimestamps\"]),V(t,0,\"serverTimestamps\",e.serverTimestamps,[\"estimate\",\"previous\",\"none\"]),e)}function Fo(t,e){P(t,\"object\",1,e),e&&(K(t,e,[\"source\"]),V(t,0,\"source\",e.source,[\"default\",\"server\",\"cache\"]))}function Uo(t,e,n){if(e instanceof ko){if(e.firestore!==n)throw new T(E.INVALID_ARGUMENT,\"Provided document reference is from a different Firestore instance.\");return e}throw Q(t,\"DocumentReference\",1,e)}function Bo(t){switch(t){case Ar.Added:return\"added\";case Ar.Modified:case Ar.Metadata:return\"modified\";case Ar.Removed:return\"removed\";default:return g(\"Unknown change type: \"+t)}}var jo=I(Ao,\"Use firebase.firestore() instead.\"),Ko=I(No,\"Use firebase.firestore().runTransaction() instead.\"),Qo=I(Do,\"Use firebase.firestore().batch() instead.\"),Wo=I(ko,\"Use firebase.firestore().doc() instead.\"),Go=I(Ro),zo=I(Mo),Ho=I(Po),Yo=I(Lo),Xo=I(xo,\"Use firebase.firestore().collection() instead.\"),Jo={Firestore:jo,GeoPoint:Qr,Timestamp:Tt,Blob:et,Transaction:Ko,WriteBatch:Qo,DocumentReference:Wo,DocumentSnapshot:Go,Query:Ho,QueryDocumentSnapshot:zo,QuerySnapshot:Yo,CollectionReference:Xo,FieldPath:Wi,FieldValue:ao,setLogLevel:Ao.setLogLevel,CACHE_SIZE_UNLIMITED:So};function $o(t){t.INTERNAL.registerService(\"firestore\",function(t){return new Ao(t)},function(t){v(t&&\"object\"===typeof t,\"shallowCopy() expects object parameter.\");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(Jo))}var Zo=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),ta=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener(\"online\",this.networkAvailableListener),window.removeEventListener(\"offline\",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener(\"online\",this.networkAvailableListener),window.addEventListener(\"offline\",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){d(\"ConnectivityMonitor\",\"Network connectivity changed: AVAILABLE\");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(0)}},t.prototype.onNetworkUnavailable=function(){d(\"ConnectivityMonitor\",\"Network connectivity changed: UNAVAILABLE\");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(1)}},t.isAvailable=function(){return void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ea=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){v(!this.wrappedOnOpen,\"Called onOpen on stream twice!\"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){v(!this.wrappedOnClose,\"Called onClose on stream twice!\"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){v(!this.wrappedOnMessage,\"Called onMessage on stream twice!\"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){v(void 0!==this.wrappedOnOpen,\"Cannot call onOpen because no callback was set\"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){v(void 0!==this.wrappedOnClose,\"Cannot call onClose because no callback was set\"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){v(void 0!==this.wrappedOnMessage,\"Cannot call onMessage because no callback was set\"),this.wrappedOnMessage(t)},t}(),na=\"Connection\",ra={BatchGetDocuments:\"batchGet\",Commit:\"commit\"},ia=\"gl-js/ fire/\"+h,oa=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?\"https\":\"http\";this.baseUrl=e+\"://\"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t[\"X-Goog-Api-Client\"]=ia},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,a){var s=new c.XhrIo;s.listenOnce(c.EventType.COMPLETE,function(){try{switch(s.getLastErrorCode()){case c.ErrorCode.NO_ERROR:var e=s.getResponseJson();d(na,\"XHR received:\",JSON.stringify(e)),o(e);break;case c.ErrorCode.TIMEOUT:d(na,'RPC \"'+t+'\" timed out'),a(new T(E.DEADLINE_EXCEEDED,\"Request time out\"));break;case c.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(d(na,'RPC \"'+t+'\" failed with status:',n,\"response text:\",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace(\"_\",\"-\");return Object.values(E).indexOf(e)>=0?e:E.UNKNOWN}(r.status);a(new T(i,r.message))}else a(new T(E.UNKNOWN,\"Server responded with status \"+s.getStatus()))}else d(na,'RPC \"'+t+'\" failed'),a(new T(E.UNAVAILABLE,\"Connection failed.\"));break;default:g('RPC \"'+t+'\" failed with unanticipated webchannel error '+s.getLastErrorCode()+\": \"+s.getLastError()+\", giving up.\")}}finally{d(na,'RPC \"'+t+'\" completed.')}});var u=JSON.stringify(e);d(na,\"XHR sending: \",i+\" \"+u);var h={\"Content-Type\":\"text/plain\"};r.modifyHeadersForRequest(h,n),s.send(i,\"POST\",u,h,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,\"/\",\"google.firestore.v1.Firestore\",\"/\",t,\"/channel\"],r=c.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:\"gsessionid\",initMessageHeaders:{},messageUrlParams:{database:\"projects/\"+this.databaseId.projectId+\"/databases/\"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),u.isReactNative()||(i.httpHeadersOverwriteParam=\"$httpHeaders\");var o=n.join(\"\");d(na,\"Creating WebChannel: \"+o+\" \"+i);var a=r.createWebChannel(o,i),s=!1,h=!1,l=new ea({sendFn:function(t){h?d(na,\"Not sending because WebChannel is closed:\",t):(s||(d(na,\"Opening WebChannel transport.\"),a.open(),s=!0),d(na,\"WebChannel sending:\",t),a.send(t))},closeFn:function(){return a.close()}}),f=function(t,e){a.listen(t,function(t){try{e(t)}catch(n){setTimeout(function(){throw n},0)}})};return f(c.WebChannel.EventType.OPEN,function(){h||d(na,\"WebChannel transport opened.\")}),f(c.WebChannel.EventType.CLOSE,function(){h||(h=!0,d(na,\"WebChannel transport closed\"),l.callOnClose())}),f(c.WebChannel.EventType.ERROR,function(t){h||(h=!0,d(na,\"WebChannel transport errored:\",t),l.callOnClose(new T(E.UNAVAILABLE,\"The operation could not be completed\")))}),f(c.WebChannel.EventType.MESSAGE,function(t){if(!h){var e=t.data[0];v(!!e,\"Got a webchannel message without data.\");var n=e,r=n.error||n[0]&&n[0].error;if(r){d(na,\"WebChannel received error:\",r);var i=r.status,o=function(t){var e=Tr[t];if(void 0!==e)return Cr(e)}(i),s=r.message;void 0===o&&(o=E.INTERNAL,s=\"Unknown error status: \"+i+\" with message \"+r.message),h=!0,l.callOnClose(new T(o,s)),a.close()}else d(na,\"WebChannel received:\",e),l.callOnMessage(e)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=ra[t];v(void 0!==e,\"Unknown REST mapping for: \"+t);var n=[this.baseUrl,\"/\",\"v1\"];return n.push(\"/projects/\"),n.push(this.databaseId.projectId),n.push(\"/databases/\"),n.push(this.databaseId.database),n.push(\"/documents\"),n.push(\":\"),n.push(e),n.join(\"\")},t}(),aa=function(){function t(){this.emptyByteString=\"\",this.base64Available=\"undefined\"!==typeof atob}return Object.defineProperty(t.prototype,\"document\",{get:function(){return\"undefined\"!==typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"window\",{get:function(){return window},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new oa(t))},t.prototype.newConnectivityMonitor=function(){return ta.isAvailable()?new ta:new Zo},t.prototype.newSerializer=function(t){return new yi(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();function sa(t){$o(t)}b.setPlatform(new aa),sa(o),e.registerFirestore=sa}).call(this,n(\"8oxB\"))},\"8oxB\":function(t,e){var n,r,i=t.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function a(){throw new Error(\"clearTimeout has not been defined\")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n=\"function\"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{r=\"function\"===typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],h=!1,l=-1;function f(){h&&u&&(h=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!h){var t=s(f);h=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||h||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(t){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},I7wR:function(t,e,n){(function(e){var n=\"[object AsyncFunction]\",r=\"[object Function]\",i=\"[object GeneratorFunction]\",o=\"[object Null]\",a=\"[object Proxy]\",s=\"[object Undefined]\",u=\"object\"==typeof e&&e&&e.Object===Object&&e,c=\"object\"==typeof self&&self&&self.Object===Object&&self,h=u||c||Function(\"return this\")(),l=Object.prototype,f=l.hasOwnProperty,p=l.toString,d=h.Symbol,m=d?d.toStringTag:void 0;function y(t){return null==t?void 0===t?s:o:m&&m in Object(t)?function(t){var e=f.call(t,m),n=t[m];try{t[m]=void 0;var r=!0}catch(o){}var i=p.call(t);r&&(e?t[m]=n:delete t[m]);return i}(t):function(t){return p.call(t)}(t)}t.exports=function(t){if(!function(t){var e=typeof t;return null!=t&&(\"object\"==e||\"function\"==e)}(t))return!1;var e=y(t);return e==r||e==i||e==n||e==a}}).call(this,n(\"yLpj\"))},RNiq:function(t,e,n){\"use strict\";n.r(e);var r=n(\"0iUn\"),i=n(\"sLSF\"),o=n(\"MI3g\"),a=n(\"a7VT\"),s=n(\"AT/M\"),u=n(\"Tit0\"),c=n(\"hfKm\"),h=n.n(c);function l(t,e,n){return e in t?h()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f,p,d=n(\"q1tI\"),m=n.n(d),y=n(\"Wcq6\"),g=n.n(y);n(\"6Joi\"),n(\"t6oF\");g.a.apps.length||(g.a.initializeApp({apiKey:\"AIzaSyDK8iBShvK_MyyHCyVLmoSsoBk6295IrrQ\",authDomain:\"react-firebase-7e1a7.firebaseapp.com\",databaseURL:\"https://react-firebase-7e1a7.firebaseio.com\",projectId:\"react-firebase-7e1a7\",storageBucket:\"\",messagingSenderId:\"179179280724\",appId:\"1:179179280724:web:10a41c07b79b0789\"}),p=g.a.auth(),(f=g.a.firestore()).settings({timestampsInSnapshots:!0}));n(\"q4sD\"),n(\"MV5A\");function v(){return(v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function b(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var w,E=n(\"17x9\"),T=n.n(E),I=n(\"TSYQ\"),S=n.n(I);n(\"I7wR\");function C(t,e){return void 0===t&&(t=\"\"),void 0===e&&(e=w),e?t.split(\" \").map(function(t){return e[t]||t}).join(\" \"):t}var _={};function A(t){_[t]||(\"undefined\"!==typeof console&&console.error(t),_[t]=!0)}var N=window.Element||function(){};T.a.oneOfType([T.a.string,T.a.func,function(t,e,n){if(!(t[e]instanceof N))return new Error(\"Invalid prop `\"+e+\"` supplied to `\"+n+\"`. Expected prop to be an instance of Element. Validation failed.\")},T.a.shape({current:T.a.any})]);var D=T.a.oneOfType([T.a.func,T.a.string,T.a.shape({$$typeof:T.a.symbol,render:T.a.func}),T.a.arrayOf(T.a.oneOfType([T.a.func,T.a.string,T.a.shape({$$typeof:T.a.symbol,render:T.a.func})]))]);!window.document||window.document.createElement;var k={tag:D,size:T.a.string,className:T.a.string,cssModule:T.a.object},O=function(t){var e=t.className,n=t.cssModule,r=t.tag,i=t.size,o=b(t,[\"className\",\"cssModule\",\"tag\",\"size\"]),a=C(S()(e,\"input-group\",i?\"input-group-\"+i:null),n);return m.a.createElement(r,v({},o,{className:a}))};O.propTypes=k,O.defaultProps={tag:\"div\"};var R=O;function M(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function P(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var L={children:T.a.node,type:T.a.string,size:T.a.string,bsSize:T.a.string,valid:T.a.bool,invalid:T.a.bool,tag:D,innerRef:T.a.oneOfType([T.a.object,T.a.func,T.a.string]),plaintext:T.a.bool,addon:T.a.bool,className:T.a.string,cssModule:T.a.object},x=function(t){function e(e){var n;return(n=t.call(this,e)||this).getRef=n.getRef.bind(M(n)),n.focus=n.focus.bind(M(n)),n}P(e,t);var n=e.prototype;return n.getRef=function(t){this.props.innerRef&&this.props.innerRef(t),this.ref=t},n.focus=function(){this.ref&&this.ref.focus()},n.render=function(){var t=this.props,e=t.className,n=t.cssModule,r=t.type,i=t.bsSize,o=t.valid,a=t.invalid,s=t.tag,u=t.addon,c=t.plaintext,h=t.innerRef,l=b(t,[\"className\",\"cssModule\",\"type\",\"bsSize\",\"valid\",\"invalid\",\"tag\",\"addon\",\"plaintext\",\"innerRef\"]),f=[\"radio\",\"checkbox\"].indexOf(r)>-1,p=new RegExp(\"\\\\D\",\"g\"),d=s||(\"select\"===r||\"textarea\"===r?r:\"input\"),y=\"form-control\";c?(y+=\"-plaintext\",d=s||\"input\"):\"file\"===r?y+=\"-file\":f&&(y=u?null:\"form-check-input\"),l.size&&p.test(l.size)&&(A('Please use the prop \"bsSize\" instead of the \"size\" to bootstrap\\'s input sizing.'),i=l.size,delete l.size);var g=C(S()(e,a&&\"is-invalid\",o&&\"is-valid\",!!i&&\"form-control-\"+i,y),n);return(\"input\"===d||s&&\"function\"===typeof s)&&(l.type=r),l.children&&!c&&\"select\"!==r&&\"string\"===typeof d&&\"select\"!==d&&(A('Input with a type of \"'+r+'\" cannot have children. Please use \"value\"/\"defaultValue\" instead.'),delete l.children),m.a.createElement(d,v({},l,{ref:h,className:g}))},e}(m.a.Component);x.propTypes=L,x.defaultProps={type:\"text\"};var q=x,V={tag:D,className:T.a.string,cssModule:T.a.object},F=function(t){var e=t.className,n=t.cssModule,r=t.tag,i=b(t,[\"className\",\"cssModule\",\"tag\"]),o=C(S()(e,\"input-group-text\"),n);return m.a.createElement(r,v({},i,{className:o}))};F.propTypes=V,F.defaultProps={tag:\"span\"};var U=F,B={tag:D,addonType:T.a.oneOf([\"prepend\",\"append\"]).isRequired,children:T.a.node,className:T.a.string,cssModule:T.a.object},j=function(t){var e=t.className,n=t.cssModule,r=t.tag,i=t.addonType,o=t.children,a=b(t,[\"className\",\"cssModule\",\"tag\",\"addonType\",\"children\"]),s=C(S()(e,\"input-group-\"+i),n);return\"string\"===typeof o?m.a.createElement(r,v({},a,{className:s}),m.a.createElement(U,{children:o})):m.a.createElement(r,v({},a,{className:s,children:o}))};j.propTypes=B,j.defaultProps={tag:\"div\"};var K=j,Q={active:T.a.bool,\"aria-label\":T.a.string,block:T.a.bool,color:T.a.string,disabled:T.a.bool,outline:T.a.bool,tag:D,innerRef:T.a.oneOfType([T.a.object,T.a.func,T.a.string]),onClick:T.a.func,size:T.a.string,children:T.a.node,className:T.a.string,cssModule:T.a.object,close:T.a.bool},W=function(t){function e(e){var n;return(n=t.call(this,e)||this).onClick=n.onClick.bind(M(n)),n}P(e,t);var n=e.prototype;return n.onClick=function(t){this.props.disabled?t.preventDefault():this.props.onClick&&this.props.onClick(t)},n.render=function(){var t=this.props,e=t.active,n=t[\"aria-label\"],r=t.block,i=t.className,o=t.close,a=t.cssModule,s=t.color,u=t.outline,c=t.size,h=t.tag,l=t.innerRef,f=b(t,[\"active\",\"aria-label\",\"block\",\"className\",\"close\",\"cssModule\",\"color\",\"outline\",\"size\",\"tag\",\"innerRef\"]);o&&\"undefined\"===typeof f.children&&(f.children=m.a.createElement(\"span\",{\"aria-hidden\":!0},\"\\xd7\"));var p=\"btn\"+(u?\"-outline\":\"\")+\"-\"+s,d=C(S()(i,{close:o},o||\"btn\",o||p,!!c&&\"btn-\"+c,!!r&&\"btn-block\",{active:e,disabled:this.props.disabled}),a);f.href&&\"button\"===h&&(h=\"a\");var y=o?\"Close\":null;return m.a.createElement(h,v({type:\"button\"===h&&f.onClick?\"button\":void 0},f,{className:d,ref:l,onClick:this.onClick,\"aria-label\":n||y}))},e}(m.a.Component);W.propTypes=Q,W.defaultProps={color:\"secondary\",tag:\"button\"};var G=W,z={tag:D,fluid:T.a.bool,className:T.a.string,cssModule:T.a.object},H=function(t){var e=t.className,n=t.cssModule,r=t.fluid,i=t.tag,o=b(t,[\"className\",\"cssModule\",\"fluid\",\"tag\"]),a=C(S()(e,r?\"container-fluid\":\"container\"),n);return m.a.createElement(i,v({},o,{className:a}))};H.propTypes=z,H.defaultProps={tag:\"div\"};var Y=H,X={tag:D,noGutters:T.a.bool,className:T.a.string,cssModule:T.a.object,form:T.a.bool},J=function(t){var e=t.className,n=t.cssModule,r=t.noGutters,i=t.tag,o=t.form,a=b(t,[\"className\",\"cssModule\",\"noGutters\",\"tag\",\"form\"]),s=C(S()(e,r?\"no-gutters\":null,o?\"form-row\":\"row\"),n);return m.a.createElement(i,v({},a,{className:s}))};J.propTypes=X,J.defaultProps={tag:\"div\"};var $=J,Z=n(\"xQ8M\"),tt=n.n(Z),et=T.a.oneOfType([T.a.number,T.a.string]),nt=T.a.oneOfType([T.a.bool,T.a.number,T.a.string,T.a.shape({size:T.a.oneOfType([T.a.bool,T.a.number,T.a.string]),order:et,offset:et})]),rt={tag:D,xs:nt,sm:nt,md:nt,lg:nt,xl:nt,className:T.a.string,cssModule:T.a.object,widths:T.a.array},it={tag:\"div\",widths:[\"xs\",\"sm\",\"md\",\"lg\",\"xl\"]},ot=function(t,e,n){return!0===n||\"\"===n?t?\"col\":\"col-\"+e:\"auto\"===n?t?\"col-auto\":\"col-\"+e+\"-auto\":t?\"col-\"+n:\"col-\"+e+\"-\"+n},at=function(t){var e=t.className,n=t.cssModule,r=t.widths,i=t.tag,o=b(t,[\"className\",\"cssModule\",\"widths\",\"tag\"]),a=[];r.forEach(function(e,r){var i=t[e];if(delete o[e],i||\"\"===i){var s=!r;if(tt()(i)){var u,c=s?\"-\":\"-\"+e+\"-\",h=ot(s,e,i.size);a.push(C(S()(((u={})[h]=i.size||\"\"===i.size,u[\"order\"+c+i.order]=i.order||0===i.order,u[\"offset\"+c+i.offset]=i.offset||0===i.offset,u)),n))}else{var l=ot(s,e,i);a.push(l)}}}),a.length||a.push(\"col\");var s=C(S()(e,a),n);return m.a.createElement(i,v({},o,{className:s}))};at.propTypes=rt,at.defaultProps=it;var st=at,ut={color:T.a.string,pill:T.a.bool,tag:D,innerRef:T.a.oneOfType([T.a.object,T.a.func,T.a.string]),children:T.a.node,className:T.a.string,cssModule:T.a.object},ct=function(t){var e=t.className,n=t.cssModule,r=t.color,i=t.innerRef,o=t.pill,a=t.tag,s=b(t,[\"className\",\"cssModule\",\"color\",\"innerRef\",\"pill\",\"tag\"]),u=C(S()(e,\"badge\",\"badge-\"+r,!!o&&\"badge-pill\"),n);return s.href&&\"span\"===a&&(a=\"a\"),m.a.createElement(a,v({},s,{className:u,ref:i}))};ct.propTypes=ut,ct.defaultProps={color:\"secondary\",pill:!1,tag:\"span\"};var ht=ct,lt=function(t){function e(){var t,n;Object(r.default)(this,e);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return n=Object(o.default)(this,(t=Object(a.default)(e)).call.apply(t,[this].concat(u))),l(Object(s.default)(n),\"state\",{value:\"\",result:[{name:\"\",lyric:\"\"}],searchLoader:!0,isResult:!1,fetchData:!1}),l(Object(s.default)(n),\"componentDidMount\",function(){p.signInAnonymously().catch(function(t){this.errorMessage=t.message}),n.listenToAuth()}),l(Object(s.default)(n),\"listenToAuth\",function(){g.a.auth().onAuthStateChanged(function(t){n.userId=t?t.uid:null})}),l(Object(s.default)(n),\"handleInput\",function(t){n.setState({value:t.target.value}),\"\"===t.target.value&&n.setState({isResult:!1})}),l(Object(s.default)(n),\"onInputKeyPress\",function(t){13===t.which&&n.handleSearch()}),l(Object(s.default)(n),\"handleSearch\",function(){var t=Object(s.default)(n);t.setState({searchLoader:!0,isResult:!1,fetchData:!0}),f.collection(\"stavan\").where(\"name\",\"==\",\"\".concat(n.state.value.toLowerCase())).get().then(function(e){e.docs.length>0?e.forEach(function(e){var n=e.data(),r=n.name,i=n.lyrics.replace(new RegExp(/(\\\\n)+/g),\"\\n\");t.setState({result:[{name:r,lyric:i}],searchLoader:!0,fetchData:!0},function(){t.setState({searchLoader:!1})})}):t.setState({isResult:!0,fetchData:!1})})}),n}return Object(u.default)(e,t),Object(i.default)(e,[{key:\"render\",value:function(){var t=this.state,e=t.result,n=t.searchLoader,r=t.fetchData,i=t.isResult;return m.a.createElement(\"div\",{className:\"container\"},m.a.createElement(\"h2\",null,\"Lyrics Finder\"),m.a.createElement(\"p\",null,\"Find Lyrics for any stavan\"),m.a.createElement(R,null,m.a.createElement(q,{placeholder:\"Search by stavan name...\",autoFocus:!0,value:this.state.value,onChange:this.handleInput.bind(this),onKeyPress:this.onInputKeyPress}),m.a.createElement(K,{addonType:\"append\"},m.a.createElement(G,{color:\"primary\",onClick:this.handleSearch},\"Search\"))),n?r?m.a.createElement(\"div\",null,m.a.createElement(\"img\",{src:\"/static/loader.gif\",alt:\"\",width:\"100px\",height:\"100px\"})):i?m.a.createElement(Y,null,m.a.createElement($,null,m.a.createElement(st,null,m.a.createElement(\"h2\",null,m.a.createElement(ht,{color:\"danger\"},\"We currently do not have \\n any lyrics for this stavan.\"))))):null:m.a.createElement(\"div\",null,m.a.createElement(\"h2\",null,e[0].name.toUpperCase()),m.a.createElement(\"div\",{className:\"result\"},e[0].lyric.toLowerCase())))}}]),e}(m.a.Component);e.default=lt},TSYQ:function(t,e,n){var r;!function(){\"use strict\";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if(\"string\"===o||\"number\"===o)t.push(r);else if(Array.isArray(r)&&r.length){var a=i.apply(null,r);a&&t.push(a)}else if(\"object\"===o)for(var s in r)n.call(r,s)&&r[s]&&t.push(s)}}return t.join(\" \")}t.exports?(i.default=i,t.exports=i):void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},Wcq6:function(t,e,n){\"use strict\";var r,i=(r=n(\"wj3C\"))&&\"object\"===typeof r&&\"default\"in r?r.default:r;t.exports=i},mrSG:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"__extends\",function(){return i}),n.d(e,\"__assign\",function(){return o}),n.d(e,\"__rest\",function(){return a}),n.d(e,\"__decorate\",function(){return s}),n.d(e,\"__param\",function(){return u}),n.d(e,\"__metadata\",function(){return c}),n.d(e,\"__awaiter\",function(){return h}),n.d(e,\"__generator\",function(){return l}),n.d(e,\"__exportStar\",function(){return f}),n.d(e,\"__values\",function(){return p}),n.d(e,\"__read\",function(){return d}),n.d(e,\"__spread\",function(){return m}),n.d(e,\"__spreadArrays\",function(){return y}),n.d(e,\"__await\",function(){return g}),n.d(e,\"__asyncGenerator\",function(){return v}),n.d(e,\"__asyncDelegator\",function(){return b}),n.d(e,\"__asyncValues\",function(){return w}),n.d(e,\"__makeTemplateObject\",function(){return E}),n.d(e,\"__importStar\",function(){return T}),n.d(e,\"__importDefault\",function(){return I});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&\"function\"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if(\"object\"===typeof Reflect&&\"function\"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if(\"object\"===typeof Reflect&&\"function\"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function l(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},\"function\"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function p(t){var e=\"function\"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function d(t,e){var n=\"function\"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function v(t,e,n){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var r,i=n.apply(t,e||[]),o=[];return r={},a(\"next\"),a(\"throw\"),a(\"return\"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{(n=i[t](e)).value instanceof g?Promise.resolve(n.value.v).then(u,c):h(o[0][2],n)}catch(r){h(o[0][3],r)}var n}function u(t){s(\"next\",t)}function c(t){s(\"throw\",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r(\"next\"),r(\"throw\",function(t){throw t}),r(\"return\"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:g(t[r](e)),done:\"return\"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r(\"next\"),r(\"throw\"),r(\"return\"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(e=t[n](e)).done,e.value)})}}}function E(t,e){return Object.defineProperty?Object.defineProperty(t,\"raw\",{value:e}):t.raw=e,t}function T(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function I(t){return t&&t.__esModule?t:{default:t}}},\"q/0M\":function(t,e,n){\"use strict\";n.r(e),n.d(e,\"LogLevel\",function(){return r}),n.d(e,\"Logger\",function(){return s}),n.d(e,\"setLogLevel\",function(){return u});var r,i=[];!function(t){t[t.DEBUG=0]=\"DEBUG\",t[t.VERBOSE=1]=\"VERBOSE\",t[t.INFO=2]=\"INFO\",t[t.WARN=3]=\"WARN\",t[t.ERROR=4]=\"ERROR\",t[t.SILENT=5]=\"SILENT\"}(r||(r={}));var o=r.INFO,a=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case r.DEBUG:case r.VERBOSE:console.log.apply(console,[\"[\"+o+\"]  \"+t.name+\":\"].concat(n));break;case r.INFO:console.info.apply(console,[\"[\"+o+\"]  \"+t.name+\":\"].concat(n));break;case r.WARN:console.warn.apply(console,[\"[\"+o+\"]  \"+t.name+\":\"].concat(n));break;case r.ERROR:console.error.apply(console,[\"[\"+o+\"]  \"+t.name+\":\"].concat(n));break;default:throw new Error(\"Attempted to log a message with an invalid logType (value: \"+e+\")\")}}},s=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=a,i.push(this)}return Object.defineProperty(t.prototype,\"logLevel\",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError(\"Invalid value assigned to `logLevel`\");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"logHandler\",{get:function(){return this._logHandler},set:function(t){if(\"function\"!==typeof t)throw new TypeError(\"Value assigned to `logHandler` must be a function\");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.ERROR].concat(t))},t}();function u(t){i.forEach(function(e){e.logLevel=t})}},t6oF:function(t,e,n){\"use strict\";(function(t){var e=n(\"wj3C\"),r=n.n(e);(function(){var e,n=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=window===this?this:\"undefined\"!=typeof t&&null!=t?t:this;function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e=\"undefined\"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,e){if(e){var r=i;t=t.split(\".\");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(e=e(o=r[t=t[t.length-1]]))!=o&&null!=e&&n(r,t,{configurable:!0,writable:!0,value:e})}}(\"Promise\",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.o),reject:t(this.g)}},e.prototype.o=function(t){if(t===this)this.g(new TypeError(\"A Promise cannot resolve to itself\"));else if(t instanceof e)this.u(t);else{t:switch(typeof t){case\"object\":var n=null!=t;break t;case\"function\":n=!0;break t;default:n=!1}n?this.l(t):this.h(t)}},e.prototype.l=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}\"function\"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error(\"Cannot settle(\"+t+\", \"+e+\"): Promise already settled in state\"+this.b);this.b=t,this.c=e,this.m()},e.prototype.m=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.u=function(t){var e=this.f();t.Ja(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return\"function\"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e(function(t,e){i=t,o=e});return this.Ja(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ja=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error(\"Unexpected state: \"+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Ja(e,n)})},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e(function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Ja(o(a.length-1),e),i=n.next()}while(!i.done)})},e});var s=s||{},u=this||self;function c(t){return\"string\"==typeof t}function h(t){return\"boolean\"==typeof t}var l=/^[\\w+\\/_-]+[=]{0,2}$/,f=null;function p(){}function d(t){var e=typeof t;if(\"object\"==e){if(!t)return\"null\";if(t instanceof Array)return\"array\";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if(\"[object Window]\"==n)return\"object\";if(\"[object Array]\"==n||\"number\"==typeof t.length&&\"undefined\"!=typeof t.splice&&\"undefined\"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==n||\"undefined\"!=typeof t.call&&\"undefined\"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"call\"))return\"function\"}else if(\"function\"==e&&\"undefined\"==typeof t.call)return\"object\";return e}function m(t){return null===t}function y(t){return\"array\"==d(t)}function g(t){var e=d(t);return\"array\"==e||\"object\"==e&&\"number\"==typeof t.length}function v(t){return\"function\"==d(t)}function b(t){var e=typeof t;return\"object\"==e&&null!=t||\"function\"==e}var w=\"closure_uid_\"+(1e9*Math.random()>>>0),E=0;function T(t,e,n){return t.call.apply(t.bind,arguments)}function I(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function S(t,e,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?T:I).apply(null,arguments)}function C(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now||function(){return+new Date};function A(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.cd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function N(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function k(t,e){for(var n=\"\",r=(t=t.split(\"%s\")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:\"%s\");D.call(this,n+t[r])}function O(t,e){throw new k(\"Failure\"+(t?\": \"+t:\"\"),Array.prototype.slice.call(arguments,1))}function R(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function P(){this.b=this.a=null}A(D,Error),D.prototype.name=\"CustomError\",A(k,D),k.prototype.name=\"AssertionError\",R.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new R(function(){return new q},function(t){t.reset()});function x(){var t=Qt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function q(){this.next=this.b=this.a=null}function V(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&\"undefined\"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(b(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o=\"<object could not be stringified>\"}else o=void 0===t?\"undefined\":null===t?\"null\":typeof t;O(\"Argument is not a %s (or a non-Element, non-Location mock); got: %s\",e,o)}}P.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},q.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},q.prototype.reset=function(){this.next=this.b=this.a=null};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(c(t))return c(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=c(t)?t.split(\"\"):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var B=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=c(t)?t.split(\"\"):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},j=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=c(t)?t.split(\"\"):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function K(t,e){return 0<=F(t,e)}function Q(t,e){var n;return(n=0<=(e=F(t,e)))&&Array.prototype.splice.call(t,e,1),n}function W(t,e){!function(t,e){for(var n=c(t)?t.split(\"\"):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0})}function G(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function Y(t){for(var e in t)return!1;return!0}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}var J=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function $(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<J.length;o++)n=J[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Z(t,e){this.a=t===nt&&e||\"\",this.b=et}function tt(t){return t instanceof Z&&t.constructor===Z&&t.b===et?t.a:(O(\"expected object of type Const, got '\"+t+\"'\"),\"type_error:Const\")}Z.prototype.na=!0,Z.prototype.ma=function(){return this.a},Z.prototype.toString=function(){return\"Const{\"+this.a+\"}\"};var et={},nt={},rt=new Z(nt,\"\");function it(){this.a=\"\",this.b=ct}function ot(t){return t instanceof it&&t.constructor===it&&t.b===ct?t.a:(O(\"expected object of type TrustedResourceUrl, got '\"+t+\"' of type \"+d(t)),\"type_error:TrustedResourceUrl\")}function at(t,e){var n=tt(t);if(!ut.test(n))throw Error(\"Invalid TrustedResourceUrl format: \"+n);return ht(t=n.replace(st,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, \"'+r+'\", in format string, \"'+n+'\", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof Z?tt(t):encodeURIComponent(String(t))}))}it.prototype.na=!0,it.prototype.ma=function(){return this.a.toString()},it.prototype.toString=function(){return\"TrustedResourceUrl{\"+this.a+\"}\"};var st=/%{(\\w+)}/g,ut=/^((https:)?\\/\\/[0-9a-z.:[\\]-]+\\/|\\/[^\\/\\\\]|[^:\\/\\\\%]+\\/|[^:\\/\\\\%]*[?#]|about:blank#)/i,ct={};function ht(t){var e=new it;return e.a=t,e}var lt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(t)[1]},ft=/&/g,pt=/</g,dt=/>/g,mt=/\"/g,yt=/'/g,gt=/\\x00/g,vt=/[\\x00&<>\"']/;function bt(t,e){return-1!=t.indexOf(e)}function wt(t,e){return t<e?-1:t>e?1:0}function Et(){this.a=\"\",this.b=_t}function Tt(t){return t instanceof Et&&t.constructor===Et&&t.b===_t?t.a:(O(\"expected object of type SafeUrl, got '\"+t+\"' of type \"+d(t)),\"type_error:SafeUrl\")}Et.prototype.na=!0,Et.prototype.ma=function(){return this.a.toString()},Et.prototype.toString=function(){return\"SafeUrl{\"+this.a+\"}\"};var It=/^(?:(?:https?|mailto|ftp):|[^:\\/?#]*(?:[\\/?#]|$))/i;function St(t){return t instanceof Et?t:(t=\"object\"==typeof t&&t.na?t.ma():String(t),It.test(t)||(t=\"about:invalid#zClosurez\"),At(t))}var Ct,_t={};function At(t){var e=new Et;return e.a=t,e}At(\"about:blank\");t:{var Nt=u.navigator;if(Nt){var Dt=Nt.userAgent;if(Dt){Ct=Dt;break t}}Ct=\"\"}function kt(t){return bt(Ct,t)}function Ot(){this.a=\"\",this.b=Mt}function Rt(t){return t instanceof Ot&&t.constructor===Ot&&t.b===Mt?t.a:(O(\"expected object of type SafeHtml, got '\"+t+\"' of type \"+d(t)),\"type_error:SafeHtml\")}Ot.prototype.na=!0,Ot.prototype.ma=function(){return this.a.toString()},Ot.prototype.toString=function(){return\"SafeHtml{\"+this.a+\"}\"};var Mt={};function Pt(t){var e=new Ot;return e.a=t,e}Pt(\"<!DOCTYPE html>\");var Lt,xt,qt=Pt(\"\");function Vt(t,e){for(var n=t.split(\"%s\"),r=\"\",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join(\"%s\")}function Ft(t){return vt.test(t)&&(-1!=t.indexOf(\"&\")&&(t=t.replace(ft,\"&amp;\")),-1!=t.indexOf(\"<\")&&(t=t.replace(pt,\"&lt;\")),-1!=t.indexOf(\">\")&&(t=t.replace(dt,\"&gt;\")),-1!=t.indexOf('\"')&&(t=t.replace(mt,\"&quot;\")),-1!=t.indexOf(\"'\")&&(t=t.replace(yt,\"&#39;\")),-1!=t.indexOf(\"\\0\")&&(t=t.replace(gt,\"&#0;\"))),t}function Ut(t){u.setTimeout(function(){throw t},0)}function Bt(){var t=u.MessageChannel;if(\"undefined\"===typeof t&&window.postMessage&&window.addEventListener&&!kt(\"Presto\")&&(t=function(){var t=document.createElement(\"IFRAME\");t.style.display=\"none\",function(t){var e=ht(tt(rt));V(t,\"HTMLIFrameElement\"),t.src=ot(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Rt(qt)),t.close();var n=\"callImmediate\"+Math.random(),r=\"file:\"==e.location.protocol?\"*\":e.location.protocol+\"//\"+e.location.host;t=S(function(t){\"*\"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener(\"message\",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),\"undefined\"!==typeof t&&!kt(\"Trident\")&&!kt(\"MSIE\")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return\"undefined\"!==typeof document&&\"onreadystatechange\"in document.createElement(\"SCRIPT\")?function(t){var e=document.createElement(\"SCRIPT\");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){u.setTimeout(t,0)}}function jt(t,e){xt||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);xt=function(){t.then(Wt)}}else xt=function(){var t=Wt;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!kt(\"Edge\")&&u.Window.prototype.setImmediate==u.setImmediate?(Lt||(Lt=Bt()),Lt(t)):u.setImmediate(t)}}(),Kt||(xt(),Kt=!0),Qt.add(t,e)}Pt(\"<br>\");var Kt=!1,Qt=new P;function Wt(){for(var t;t=x();){try{t.a.call(t.b)}catch(e){Ut(e)}M(L,t)}Kt=!1}function Gt(t,e){if(this.a=zt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=p)try{var n=this;t.call(e,function(t){oe(n,Ht,t)},function(t){if(!(t instanceof fe))try{if(t instanceof Error)throw t;throw Error(\"Promise rejected.\")}catch(e){}oe(n,Yt,t)})}catch(r){oe(this,Yt,r)}}var zt=0,Ht=2,Yt=3;function Xt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Xt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Jt=new R(function(){return new Xt},function(t){t.reset()});function $t(t,e,n){var r=Jt.get();return r.g=t,r.b=e,r.f=n,r}function Zt(t){if(t instanceof Gt)return t;var e=new Gt(p);return oe(e,Ht,t),e}function te(t){return new Gt(function(e,n){n(t)})}function ee(t,e,n){ae(t,e,n,null)||jt(C(e,t))}function ne(t){return new Gt(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)ee(t[o],C(i,o,!0),C(i,o,!1));else e(r)})}function re(t,e){t.b||t.a!=Ht&&t.a!=Yt||se(t),t.f?t.f.next=e:t.b=e,t.f=e}function ie(t,e,n,r){var i=$t(null,null,null);return i.a=new Gt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof fe?o(e):t(i)}catch(a){o(a)}}:o}),i.a.c=t,re(t,i),i.a}function oe(t,e,n){t.a==zt&&(t===n&&(e=Yt,n=new TypeError(\"Promise cannot resolve to itself\")),t.a=1,ae(n,t.Lc,t.Mc,t)||(t.i=n,t.a=e,t.c=null,se(t),e!=Yt||n instanceof fe||function(t,e){t.g=!0,jt(function(){t.g&&le.call(null,e)})}(t,n)))}function ae(t,e,n,r){if(t instanceof Gt)return re(t,$t(e||p,n||null,r)),!0;if(N(t))return t.then(e,n,r),!0;if(b(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function se(t){t.h||(t.h=!0,jt(t.Wb,t))}function ue(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ce(t,e,n,r){if(n==Yt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,he(e,n,r);else try{e.c?e.g.call(e.f):he(e,n,r)}catch(i){le.call(null,i)}M(Jt,e)}function he(t,e,n){e==Ht?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Gt.prototype.then=function(t,e,n){return ie(this,v(t)?t:null,v(e)?e:null,n)},Gt.prototype.$goog_Thenable=!0,(e=Gt.prototype).ia=function(t,e){return(t=$t(t,t,e)).c=!0,re(this,t),this},e.s=function(t,e){return ie(this,null,t,e)},e.cancel=function(t){this.a==zt&&jt(function(){!function t(e,n){if(e.a==zt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==zt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):ue(r),ce(r,o,Yt,n)))}e.c=null}else oe(e,Yt,n)}(this,new fe(t))},this)},e.Lc=function(t){this.a=zt,oe(this,Ht,t)},e.Mc=function(t){this.a=zt,oe(this,Yt,t)},e.Wb=function(){for(var t;t=ue(this);)ce(this,t,this.a,this.i);this.h=!1};var le=Ut;function fe(t){D.call(this,t)}function pe(){0!=de&&(me[this[w]||(this[w]=++E)]=this),this.qa=this.qa,this.ja=this.ja}A(fe,D),fe.prototype.name=\"cancel\";var de=0,me={};function ye(t){if(!t.qa&&(t.qa=!0,t.va(),0!=de)){var e=t[w]||(t[w]=++E);if(0!=de&&t.ja&&0<t.ja.length)throw Error(t+\" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.\");delete me[e]}}function ge(t){return ge[\" \"](t),t}pe.prototype.qa=!1,pe.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},ge[\" \"]=p;var ve,be=kt(\"Opera\"),we=kt(\"Trident\")||kt(\"MSIE\"),Ee=kt(\"Edge\"),Te=Ee||we,Ie=kt(\"Gecko\")&&!(bt(Ct.toLowerCase(),\"webkit\")&&!kt(\"Edge\"))&&!(kt(\"Trident\")||kt(\"MSIE\"))&&!kt(\"Edge\"),Se=bt(Ct.toLowerCase(),\"webkit\")&&!kt(\"Edge\");function Ce(){var t=u.document;return t?t.documentMode:void 0}t:{var _e=\"\",Ae=function(){var t=Ct;return Ie?/rv:([^\\);]+)(\\)|;)/.exec(t):Ee?/Edge\\/([\\d\\.]+)/.exec(t):we?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(t):Se?/WebKit\\/(\\S+)/.exec(t):be?/(?:Version)[ \\/]?(\\S+)/.exec(t):void 0}();if(Ae&&(_e=Ae?Ae[1]:\"\"),we){var Ne=Ce();if(null!=Ne&&Ne>parseFloat(_e)){ve=String(Ne);break t}}ve=_e}var De,ke={};function Oe(t){return function(t,e){var n=ke;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=lt(String(ve)).split(\".\"),r=lt(String(t)).split(\".\"),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||\"\",s=r[o]||\"\";do{if(a=/(\\d*)(\\D*)(.*)/.exec(a)||[\"\",\"\",\"\",\"\"],s=/(\\d*)(\\D*)(.*)/.exec(s)||[\"\",\"\",\"\",\"\"],0==a[0].length&&0==s[0].length)break;e=wt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||wt(0==a[2].length,0==s[2].length)||wt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}De=u.document&&we?Ce():void 0;var Re=Object.freeze||function(t){return t},Me=!we||9<=Number(De),Pe=we&&!Oe(\"9\"),Le=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},\"passive\",{get:function(){t=!0}});try{u.addEventListener(\"test\",p,e),u.removeEventListener(\"test\",p,e)}catch(n){}return t}();function xe(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function qe(t,e){if(xe.call(this,t?t.type:\"\"),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Ie){t:{try{ge(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else\"mouseover\"==n?e=t.fromElement:\"mouseout\"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||\"\",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=c(t.pointerType)?t.pointerType:Ve[t.pointerType]||\"\",this.a=t,t.defaultPrevented&&this.preventDefault()}}xe.prototype.preventDefault=function(){this.Kb=!1},A(qe,xe);var Ve=Re({2:\"touch\",3:\"pen\",4:\"mouse\"});qe.prototype.preventDefault=function(){qe.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Pe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},qe.prototype.f=function(){return this.a};var Fe=\"closure_listenable_\"+(1e6*Math.random()|0),Ue=0;function Be(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Na=i,this.key=++Ue,this.oa=this.Ia=!1}function je(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.Na=null}function Ke(t){this.src=t,this.a={},this.b=0}function Qe(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(je(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function We(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.Na==r)return i}return-1}Ke.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=We(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new Be(e,this.src,o,!!r,i)).Ia=n,t.push(e)),e};var Ge=\"closure_lm_\"+(1e6*Math.random()|0),ze={};function He(t,e,n,r,i){if(r&&r.once)Xe(t,e,n,r,i);else if(y(e))for(var o=0;o<e.length;o++)He(t,e[o],n,r,i);else n=an(n),t&&t[Fe]?un(t,e,n,b(r)?!!r.capture:!!r,i):Ye(t,e,n,!1,r,i)}function Ye(t,e,n,r,i,o){if(!e)throw Error(\"Invalid event type\");var a=b(i)?!!i.capture:!!i,s=rn(t);if(s||(t[Ge]=s=new Ke(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=nn,e=Me?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Le||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ze(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");t.addListener(r)}0}}function Xe(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)Xe(t,e[o],n,r,i);else n=an(n),t&&t[Fe]?cn(t,e,n,b(r)?!!r.capture:!!r,i):Ye(t,e,n,!0,r,i)}function Je(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)Je(t,e[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=an(n),t&&t[Fe]?(t=t.m,(e=String(e).toString())in t.a&&(-1<(n=We(o=t.a[e],n,r,i))&&(je(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=rn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=We(e,n,r,i)),(n=-1<t?e[t]:null)&&$e(n))}function $e(t){if(\"number\"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[Fe])Qe(e.m,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ze(n),r):e.addListener&&e.removeListener&&e.removeListener(r),0,(n=rn(e))?(Qe(n,t),0==n.b&&(n.src=null,e[Ge]=null)):je(t)}}}function Ze(t){return t in ze?ze[t]:ze[t]=\"on\"+t}function tn(t,e,n,r){var i=!0;if((t=rn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=en(o,r),i=i&&!1!==o)}return i}function en(t,e){var n=t.listener,r=t.Na||t.src;return t.Ia&&$e(t),n.call(r,e)}function nn(t,e){if(t.oa)return!0;if(!Me){if(!e)t:{e=[\"window\",\"event\"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new qe(r=e,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=tn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=tn(r[i],t,!1,e),n=n&&o}return n}return en(t,new qe(e,this))}function rn(t){return(t=t[Ge])instanceof Ke?t:null}var on=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);function an(t){return v(t)?t:(t[on]||(t[on]=function(e){return t.handleEvent(e)}),t[on])}function sn(){pe.call(this),this.m=new Ke(this),this.Pb=this,this.Wa=null}function un(t,e,n,r,i){t.m.add(String(e),n,!1,r,i)}function cn(t,e,n,r,i){t.m.add(String(e),n,!0,r,i)}function hn(t,e,n,r){if(!(e=t.m.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.Na||a.src;a.Ia&&Qe(t.m,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Kb}function ln(t,e,n){if(v(t))n&&(t=S(t,n));else{if(!t||\"function\"!=typeof t.handleEvent)throw Error(\"Invalid listener argument\");t=S(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function fn(t){var e=null;return new Gt(function(n,r){-1==(e=ln(function(){n(void 0)},t))&&r(Error(\"Failed to schedule timer.\"))}).s(function(t){throw u.clearTimeout(e),t})}function pn(t){if(t.S&&\"function\"==typeof t.S)return t.S();if(c(t))return t.split(\"\");if(g(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function dn(t){if(t.U&&\"function\"==typeof t.U)return t.U();if(!t.S||\"function\"!=typeof t.S){if(g(t)||c(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function mn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error(\"Uneven number of arguments\");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof mn)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function yn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];gn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)gn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function gn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}A(sn,pe),sn.prototype[Fe]=!0,sn.prototype.addEventListener=function(t,e,n,r){He(this,t,e,n,r)},sn.prototype.removeEventListener=function(t,e,n,r){Je(this,t,e,n,r)},sn.prototype.dispatchEvent=function(t){var e,n=this.Wa;if(n)for(e=[];n;n=n.Wa)e.push(n);n=this.Pb;var r=t.type||t;if(c(t))t=new xe(t,n);else if(t instanceof xe)t.target=t.target||n;else{var i=t;$(t=new xe(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=hn(a,r,!0,t)&&i}if(i=hn(a=t.b=n,r,!0,t)&&i,i=hn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=hn(a=t.b=e[o],r,!1,t)&&i;return i},sn.prototype.va=function(){if(sn.qb.va.call(this),this.m){var t,e=this.m;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,je(n[r]);delete e.a[t],e.b--}}this.Wa=null},(e=mn.prototype).S=function(){yn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.U=function(){return yn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return gn(this.b,t)?this.b[t]:e},e.set=function(t,e){gn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var vn=/^(?:([^:\\/?#.]+):)?(?:\\/\\/(?:([^\\/?#]*)@)?([^\\/#?]*?)(?::([0-9]+))?(?=[\\/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;function bn(t,e){var n;this.b=this.i=this.f=\"\",this.m=null,this.g=this.c=\"\",this.h=!1,t instanceof bn?(this.h=void 0!==e?e:t.h,wn(this,t.f),this.i=t.i,this.b=t.b,En(this,t.m),this.c=t.c,Tn(this,Bn(t.a)),this.g=t.g):t&&(n=String(t).match(vn))?(this.h=!!e,wn(this,n[1]||\"\",!0),this.i=An(n[2]||\"\"),this.b=An(n[3]||\"\",!0),En(this,n[4]),this.c=An(n[5]||\"\",!0),Tn(this,n[6]||\"\",!0),this.g=An(n[7]||\"\")):(this.h=!!e,this.a=new Ln(null,this.h))}function wn(t,e,n){t.f=n?An(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,\"\"))}function En(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error(\"Bad port number \"+e);t.m=e}else t.m=null}function Tn(t,e,n){e instanceof Ln?(t.a=e,function(t,e){e&&!t.f&&(xn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Vn(this,e),Un(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=Nn(e,Mn)),t.a=new Ln(e,t.h))}function In(t,e,n){t.a.set(e,n)}function Sn(t,e){return t.a.get(e)}function Cn(t){return t instanceof bn?new bn(t):new bn(t,void 0)}function _n(t,e){var n=new bn(null,void 0);return wn(n,\"https\"),t&&(n.b=t),e&&(n.c=e),n}function An(t,e){return t?e?decodeURI(t.replace(/%25/g,\"%2525\")):decodeURIComponent(t):\"\"}function Nn(t,e,n){return c(t)?(t=encodeURI(t).replace(e,Dn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),t):null}function Dn(t){return\"%\"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}bn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Nn(e,kn,!0),\":\");var n=this.b;return(n||\"file\"==e)&&(t.push(\"//\"),(e=this.i)&&t.push(Nn(e,kn,!0),\"@\"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(n=this.m)&&t.push(\":\",String(n))),(n=this.c)&&(this.b&&\"/\"!=n.charAt(0)&&t.push(\"/\"),t.push(Nn(n,\"/\"==n.charAt(0)?Rn:On,!0))),(n=this.a.toString())&&t.push(\"?\",n),(n=this.g)&&t.push(\"#\",Nn(n,Pn)),t.join(\"\")},bn.prototype.resolve=function(t){var e=new bn(this),n=!!t.f;n?wn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.m;var r=t.c;if(n)En(e,t.m);else if(n=!!t.c){if(\"/\"!=r.charAt(0))if(this.b&&!this.c)r=\"/\"+r;else{var i=e.c.lastIndexOf(\"/\");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(\"..\"==(i=r)||\".\"==i)r=\"\";else if(bt(i,\"./\")||bt(i,\"/.\")){r=0==i.lastIndexOf(\"/\",0),i=i.split(\"/\");for(var o=[],a=0;a<i.length;){var s=i[a++];\".\"==s?r&&a==i.length&&o.push(\"\"):\"..\"==s?((1<o.length||1==o.length&&\"\"!=o[0])&&o.pop(),r&&a==i.length&&o.push(\"\")):(o.push(s),r=!0)}r=o.join(\"/\")}else r=i}return n?e.c=r:n=\"\"!==t.a.toString(),n?Tn(e,Bn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var kn=/[#\\/\\?@]/g,On=/[#\\?:]/g,Rn=/[#\\?]/g,Mn=/[#\\?@]/g,Pn=/#/g;function Ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function xn(t){t.a||(t.a=new mn,t.b=0,t.c&&function(t,e){if(t){t=t.split(\"&\");for(var n=0;n<t.length;n++){var r=t[n].indexOf(\"=\"),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\\+/g,\" \")):\"\")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\\+/g,\" \")),n)}))}function qn(t){var e=dn(t);if(\"undefined\"==typeof e)throw Error(\"Keys are undefined\");var n=new Ln(null,void 0);t=pn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];y(o)?Un(n,i,o):n.add(i,o)}return n}function Vn(t,e){xn(t),e=jn(t,e),gn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,gn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&yn(t)))}function Fn(t,e){return xn(t),e=jn(t,e),gn(t.a.b,e)}function Un(t,e,n){Vn(t,e),0<n.length&&(t.c=null,t.a.set(jn(t,e),z(n)),t.b+=n.length)}function Bn(t){var e=new Ln;return e.c=t.c,t.a&&(e.a=new mn(t.a),e.b=t.b),e}function jn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(e=Ln.prototype).add=function(t,e){xn(this),this.c=null,t=jn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){xn(this),this.a.forEach(function(n,r){U(n,function(n){t.call(e,n,r,this)},this)},this)},e.U=function(){xn(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.S=function(t){xn(this);var e=[];if(c(t))Fn(this,t)&&(e=G(e,this.a.get(jn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},e.set=function(t,e){return xn(this),this.c=null,Fn(this,t=jn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.S(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;\"\"!==r[o]&&(a+=\"=\"+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join(\"&\")};var Kn=!we||9<=Number(De);function Qn(t){var e=document;return c(t)?e.getElementById(t):t}function Wn(t,e){H(e,function(e,n){e&&\"object\"==typeof e&&e.na&&(e=e.ma()),\"style\"==n?t.style.cssText=e:\"class\"==n?t.className=e:\"for\"==n?t.htmlFor=e:Gn.hasOwnProperty(n)?t.setAttribute(Gn[n],e):0==n.lastIndexOf(\"aria-\",0)||0==n.lastIndexOf(\"data-\",0)?t.setAttribute(n,e):t[n]=e})}var Gn={cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\",colspan:\"colSpan\",frameborder:\"frameBorder\",height:\"height\",maxlength:\"maxLength\",nonce:\"nonce\",role:\"role\",rowspan:\"rowSpan\",type:\"type\",usemap:\"useMap\",valign:\"vAlign\",width:\"width\"};function zn(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!Kn&&a&&(a.name||a.type)){if(o=[\"<\",o],a.name&&o.push(' name=\"',Ft(a.name),'\"'),a.type){o.push(' type=\"',Ft(a.type),'\"');var s={};$(s,a),delete s.type,a=s}o.push(\">\"),o=o.join(\"\")}return o=i.createElement(o),a&&(c(a)?o.className=a:y(a)?o.className=a.join(\" \"):Wn(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(c(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!g(o)||b(o)&&0<o.nodeType?r(o):U(Hn(o)?z(o):o,r)}}(i,o,r),o}function Hn(t){if(t&&\"number\"==typeof t.length){if(b(t))return\"function\"==typeof t.item||\"string\"==typeof t.item;if(v(t))return\"function\"==typeof t.item}return!1}function Yn(t){var e=[];return function t(e,n,r){if(null==n)r.push(\"null\");else{if(\"object\"==typeof n){if(y(n)){var i=n;n=i.length,r.push(\"[\");for(var o=\"\",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=\",\";return void r.push(\"]\")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push(\"{\"),o=\"\",n)Object.prototype.hasOwnProperty.call(n,i)&&(\"function\"!=typeof(a=n[i])&&(r.push(o),Zn(i,r),r.push(\":\"),t(e,a,r),o=\",\"));return void r.push(\"}\")}n=n.valueOf()}switch(typeof n){case\"string\":Zn(n,r);break;case\"number\":r.push(isFinite(n)&&!isNaN(n)?String(n):\"null\");break;case\"boolean\":r.push(String(n));break;case\"function\":r.push(\"null\");break;default:throw Error(\"Unknown type: \"+typeof n)}}}(new Xn,t,e),e.join(\"\")}function Xn(){}var Jn={'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\",\"/\":\"\\\\/\",\"\\b\":\"\\\\b\",\"\\f\":\"\\\\f\",\"\\n\":\"\\\\n\",\"\\r\":\"\\\\r\",\"\\t\":\"\\\\t\",\"\\v\":\"\\\\u000b\"},$n=/\\uffff/.test(\"\\uffff\")?/[\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g:/[\\\\\"\\x00-\\x1f\\x7f-\\xff]/g;function Zn(t,e){e.push('\"',t.replace($n,function(t){var e=Jn[t];return e||(e=\"\\\\u\"+(65536|t.charCodeAt(0)).toString(16).substr(1),Jn[t]=e),e}),'\"')}function tr(){var t=br();return we&&!!De&&11==De||/Edge\\/\\d+/.test(t)}function er(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||\"\"}function nr(t,e){e=e||u.window;var n=\"about:blank\";t&&(n=Tt(St(t)).toString()),e.location.href=n}function rr(t){return!!((t=(t||br()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ir(t){t=t||u.window;try{t.close()}catch(e){}}function or(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=br().toLowerCase(),r&&(e.target=r,bt(n,\"crios/\")&&(e.target=\"_blank\")),yr(br())==dr&&(t=t||\"http://localhost\",e.scrollbars=!0),n=t||\"\",(t=e)||(t={}),r=window,e=n instanceof Et?n:St(\"undefined\"!=typeof n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case\"width\":case\"height\":case\"top\":case\"left\":i.push(a+\"=\"+t[a]);break;case\"target\":case\"noopener\":case\"noreferrer\":break;default:i.push(a+\"=\"+(t[a]?1:0))}var a=i.join(\",\");if((kt(\"iPhone\")&&!kt(\"iPod\")&&!kt(\"iPad\")||kt(\"iPad\")||kt(\"iPod\"))&&r.navigator&&r.navigator.standalone&&n&&\"_self\"!=n?(V(a=r.document.createElement(\"A\"),\"HTMLAnchorElement\"),e instanceof Et||e instanceof Et||(e=\"object\"==typeof e&&e.na?e.ma():String(e),It.test(e)||(e=\"about:invalid#zClosurez\"),e=At(e)),a.href=Tt(e),a.setAttribute(\"target\",n),t.noreferrer&&a.setAttribute(\"rel\",\"noreferrer\"),(t=document.createEvent(\"MouseEvent\")).initMouseEvent(\"click\",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open(\"\",n,a),t=Tt(e).toString(),a&&(Te&&bt(t,\";\")&&(t=\"'\"+t.replace(/'/g,\"%27\")+\"'\"),a.opener=null,t=Pt('<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url='+Ft(t)+'\">'),a.document.write(Rt(t)),a.document.close())):(a=r.open(Tt(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var ar=/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/,sr=/^[^@]+@[^@]+$/;function ur(){var t=null;return new Gt(function(e){\"complete\"==u.document.readyState?e():(t=function(){e()},Xe(window,\"load\",t))}).s(function(e){throw Je(window,\"load\",t),e})}function cr(t){return t=t||br(),!(\"file:\"!==Sr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function hr(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function lr(){return\"undefined\"!==typeof u.WorkerGlobalScope&&\"function\"===typeof u.importScripts}function fr(){return r.a.INTERNAL.hasOwnProperty(\"reactNative\")?\"ReactNative\":r.a.INTERNAL.hasOwnProperty(\"node\")?\"Node\":lr()?\"Worker\":\"Browser\"}function pr(){var t=fr();return\"ReactNative\"===t||\"Node\"===t}var dr=\"Firefox\",mr=\"Chrome\";function yr(t){var e=t.toLowerCase();return bt(e,\"opera/\")||bt(e,\"opr/\")||bt(e,\"opios/\")?\"Opera\":bt(e,\"iemobile\")?\"IEMobile\":bt(e,\"msie\")||bt(e,\"trident/\")?\"IE\":bt(e,\"edge/\")?\"Edge\":bt(e,\"firefox/\")?dr:bt(e,\"silk/\")?\"Silk\":bt(e,\"blackberry\")?\"Blackberry\":bt(e,\"webos\")?\"Webos\":!bt(e,\"safari/\")||bt(e,\"chrome/\")||bt(e,\"crios/\")||bt(e,\"android\")?!bt(e,\"chrome/\")&&!bt(e,\"crios/\")||bt(e,\"edge/\")?bt(e,\"android\")?\"Android\":(t=t.match(/([a-zA-Z\\d\\.]+)\\/[a-zA-Z\\d\\.]*$/))&&2==t.length?t[1]:\"Other\":mr:\"Safari\"}var gr={Sc:\"FirebaseCore-web\",Uc:\"FirebaseUI-web\"};function vr(t,e){e=e||[];var n,r=[],i={};for(n in gr)i[gr[n]]=!0;for(n=0;n<e.length;n++)\"undefined\"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=[\"FirebaseCore-web\"]),\"Browser\"===(r=fr())?r=yr(i=br()):\"Worker\"===r&&(r=yr(i=br())+\"-\"+r),r+\"/JsCore/\"+t+\"/\"+e.join(\",\")}function br(){return u.navigator&&u.navigator.userAgent||\"\"}function wr(t,e){t=t.split(\".\"),e=e||u;for(var n=0;n<t.length&&\"object\"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Er(){try{var t=u.localStorage,e=Dr();if(t)return t.setItem(e,\"1\"),t.removeItem(e),!tr()||!!u.indexedDB}catch(n){return lr()&&!!u.indexedDB}return!1}function Tr(){return(Ir()||\"chrome-extension:\"===Sr()||cr())&&!pr()&&Er()&&!lr()}function Ir(){return\"http:\"===Sr()||\"https:\"===Sr()}function Sr(){return u.location&&u.location.protocol||null}function Cr(t){return!rr(t=t||br())&&yr(t)!=dr}function _r(t){return\"undefined\"===typeof t?null:Yn(t)}function Ar(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Nr(t){if(null!==t)return JSON.parse(t)}function Dr(t){return t||Math.floor(1e9*Math.random()).toString()}function kr(t){return\"Safari\"!=yr(t=t||br())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Or(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Rr(t,e){if(t>e)throw Error(\"Short delay should be less than long delay!\");this.a=t,this.c=e,t=br(),e=fr(),this.b=rr(t)||\"ReactNative\"===e}function Mr(){var t=u.document;return!t||\"undefined\"===typeof t.visibilityState||\"visible\"==t.visibilityState}function Pr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Lr(){return!(!wr(\"fireauth.oauthhelper\",u)&&!wr(\"fireauth.iframe\",u))}Rr.prototype.get=function(){var t=u.navigator;return!t||\"boolean\"!==typeof t.onLine||!Ir()&&\"chrome-extension:\"!==Sr()&&\"undefined\"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var xr,qr={};function Vr(t){qr[t]||(qr[t]=!0,\"undefined\"!==typeof console&&\"function\"===typeof console.warn&&console.warn(t))}try{var Fr={};Object.defineProperty(Fr,\"abcd\",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Fr,\"abcd\",{configurable:!0,enumerable:!0,value:2}),xr=2==Fr.abcd}catch(Vo){xr=!1}function Ur(t,e,n){xr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Br(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Ur(t,n,e[n])}function jr(t){var e={};return Br(e,t),e}function Kr(t){var e=t;if(\"object\"==typeof t&&null!=t)for(var n in e=\"length\"in t?[]:{},t)Ur(e,n,Kr(t[n]));return e}function Qr(t){var e={},n=t[Gr],r=t[zr];if(!(t=t[Hr])||t!=Wr&&!n)throw Error(\"Invalid provider user info!\");e[Xr]=r||null,e[Yr]=n||null,Ur(this,$r,t),Ur(this,Jr,Kr(e))}var Wr=\"EMAIL_SIGNIN\",Gr=\"email\",zr=\"newEmail\",Hr=\"requestType\",Yr=\"email\",Xr=\"fromEmail\",Jr=\"data\",$r=\"operation\";function Zr(t,e){this.code=ei+t,this.message=e||ni[t]||\"\"}function ti(t){var e=t&&t.code;return e?new Zr(e.substring(ei.length),t.message):null}A(Zr,Error),Zr.prototype.w=function(){return{code:this.code,message:this.message}},Zr.prototype.toJSON=function(){return this.w()};var ei=\"auth/\",ni={\"admin-restricted-operation\":\"This operation is restricted to administrators only.\",\"argument-error\":\"\",\"app-not-authorized\":\"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.\",\"app-not-installed\":\"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.\",\"captcha-check-failed\":\"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.\",\"code-expired\":\"The SMS code has expired. Please re-send the verification code to try again.\",\"cordova-not-ready\":\"Cordova framework is not ready.\",\"cors-unsupported\":\"This browser is not supported.\",\"credential-already-in-use\":\"This credential is already associated with a different user account.\",\"custom-token-mismatch\":\"The custom token corresponds to a different audience.\",\"requires-recent-login\":\"This operation is sensitive and requires recent authentication. Log in again before retrying this request.\",\"dynamic-link-not-activated\":\"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.\",\"email-already-in-use\":\"The email address is already in use by another account.\",\"expired-action-code\":\"The action code has expired. \",\"cancelled-popup-request\":\"This operation has been cancelled due to another conflicting popup being opened.\",\"internal-error\":\"An internal error has occurred.\",\"invalid-app-credential\":\"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.\",\"invalid-app-id\":\"The mobile app identifier is not registed for the current project.\",\"invalid-user-token\":\"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.\",\"invalid-auth-event\":\"An internal error has occurred.\",\"invalid-verification-code\":\"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.\",\"invalid-continue-uri\":\"The continue URL provided in the request is invalid.\",\"invalid-cordova-configuration\":\"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.\",\"invalid-custom-token\":\"The custom token format is incorrect. Please check the documentation.\",\"invalid-dynamic-link-domain\":\"The provided dynamic link domain is not configured or authorized for the current project.\",\"invalid-email\":\"The email address is badly formatted.\",\"invalid-api-key\":\"Your API key is invalid, please check you have copied it correctly.\",\"invalid-cert-hash\":\"The SHA-1 certificate hash provided is invalid.\",\"invalid-credential\":\"The supplied auth credential is malformed or has expired.\",\"invalid-message-payload\":\"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-oauth-provider\":\"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.\",\"invalid-oauth-client-id\":\"The OAuth client ID provided is either invalid or does not match the specified API key.\",\"unauthorized-domain\":\"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.\",\"invalid-action-code\":\"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.\",\"wrong-password\":\"The password is invalid or the user does not have a password.\",\"invalid-persistence-type\":\"The specified persistence type is invalid. It can only be local, session or none.\",\"invalid-phone-number\":\"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].\",\"invalid-provider-id\":\"The specified provider ID is invalid.\",\"invalid-recipient-email\":\"The email corresponding to this action failed to send as the provided recipient email address is invalid.\",\"invalid-sender\":\"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-verification-id\":\"The verification ID used to create the phone auth credential is invalid.\",\"missing-android-pkg-name\":\"An Android Package Name must be provided if the Android App is required to be installed.\",\"auth-domain-config-required\":\"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.\",\"missing-app-credential\":\"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.\",\"missing-verification-code\":\"The phone auth credential was created with an empty SMS verification code.\",\"missing-continue-uri\":\"A continue URL must be provided in the request.\",\"missing-iframe-start\":\"An internal error has occurred.\",\"missing-ios-bundle-id\":\"An iOS Bundle ID must be provided if an App Store ID is provided.\",\"missing-or-invalid-nonce\":\"The OIDC ID token requires a valid unhashed nonce.\",\"missing-phone-number\":\"To send verification codes, provide a phone number for the recipient.\",\"missing-verification-id\":\"The phone auth credential was created with an empty verification ID.\",\"app-deleted\":\"This instance of FirebaseApp has been deleted.\",\"account-exists-with-different-credential\":\"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.\",\"network-request-failed\":\"A network error (such as timeout, interrupted connection or unreachable host) has occurred.\",\"no-auth-event\":\"An internal error has occurred.\",\"no-such-provider\":\"User was not linked to an account with the given provider.\",\"null-user\":\"A null user object was provided as the argument for an operation which requires a non-null user object.\",\"operation-not-allowed\":\"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.\",\"operation-not-supported-in-this-environment\":'This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.',\"popup-blocked\":\"Unable to establish a connection with the popup. It may have been blocked by the browser.\",\"popup-closed-by-user\":\"The popup has been closed by the user before finalizing the operation.\",\"provider-already-linked\":\"User can only be linked to one identity for the given provider.\",\"quota-exceeded\":\"The project's quota for this operation has been exceeded.\",\"redirect-cancelled-by-user\":\"The redirect operation has been cancelled by the user before finalizing.\",\"redirect-operation-pending\":\"A redirect sign-in operation is already pending.\",\"rejected-credential\":\"The request contains malformed or mismatching credentials.\",timeout:\"The operation has timed out.\",\"user-token-expired\":\"The user's credential is no longer valid. The user must sign in again.\",\"too-many-requests\":\"We have blocked all requests from this device due to unusual activity. Try again later.\",\"unauthorized-continue-uri\":\"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.\",\"unsupported-persistence-type\":\"The current environment does not support the specified persistence type.\",\"user-cancelled\":\"User did not grant your application the permissions it requested.\",\"user-not-found\":\"There is no user record corresponding to this identifier. The user may have been deleted.\",\"user-disabled\":\"The user account has been disabled by an administrator.\",\"user-mismatch\":\"The supplied credentials do not correspond to the previously signed in user.\",\"user-signed-out\":\"\",\"weak-password\":\"The password must be 6 characters long or more.\",\"web-storage-unsupported\":\"This browser is not supported or 3rd party cookies and data may be disabled.\"};function ri(t){var e=t[ui];if(\"undefined\"===typeof e)throw new Zr(\"missing-continue-uri\");if(\"string\"!==typeof e||\"string\"===typeof e&&!e.length)throw new Zr(\"invalid-continue-uri\");this.h=e,this.b=this.a=null,this.g=!1;var n=t[ii];if(n&&\"object\"===typeof n){e=n[li];var r=n[ci];if(n=n[hi],\"string\"===typeof e&&e.length){if(this.a=e,\"undefined\"!==typeof r&&\"boolean\"!==typeof r)throw new Zr(\"argument-error\",ci+\" property must be a boolean when specified.\");if(this.g=!!r,\"undefined\"!==typeof n&&(\"string\"!==typeof n||\"string\"===typeof n&&!n.length))throw new Zr(\"argument-error\",hi+\" property must be a non empty string when specified.\");this.b=n||null}else{if(\"undefined\"!==typeof e)throw new Zr(\"argument-error\",li+\" property must be a non empty string when specified.\");if(\"undefined\"!==typeof r||\"undefined\"!==typeof n)throw new Zr(\"missing-android-pkg-name\")}}else if(\"undefined\"!==typeof n)throw new Zr(\"argument-error\",ii+\" property must be a non null object when specified.\");if(this.f=null,(e=t[si])&&\"object\"===typeof e){if(\"string\"===typeof(e=e[fi])&&e.length)this.f=e;else if(\"undefined\"!==typeof e)throw new Zr(\"argument-error\",fi+\" property must be a non empty string when specified.\")}else if(\"undefined\"!==typeof e)throw new Zr(\"argument-error\",si+\" property must be a non null object when specified.\");if(\"undefined\"!==typeof(e=t[ai])&&\"boolean\"!==typeof e)throw new Zr(\"argument-error\",ai+\" property must be a boolean when specified.\");if(this.c=!!e,\"undefined\"!==typeof(t=t[oi])&&(\"string\"!==typeof t||\"string\"===typeof t&&!t.length))throw new Zr(\"argument-error\",oi+\" property must be a non empty string when specified.\");this.i=t||null}var ii=\"android\",oi=\"dynamicLinkDomain\",ai=\"handleCodeInApp\",si=\"iOS\",ui=\"url\",ci=\"installApp\",hi=\"minimumVersion\",li=\"packageName\",fi=\"bundleId\";function pi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var di=null,mi=null;function yi(t){var e=\"\";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=mi[n];if(null!=i)return i;if(!/^[\\s\\xa0]*$/.test(n))throw Error(\"Unknown base64 encoding at char: \"+n)}return e}!function(){if(!di){di={},mi={};for(var t=0;65>t;t++)di[t]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".charAt(t),mi[di[t]]=t,62<=t&&(mi[\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.\".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function gi(t){this.c=t.sub,_(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||\"anonymous\"==this.a}function vi(t){return(t=bi(t))&&t.sub&&t.iss&&t.aud&&t.exp?new gi(t):null}function bi(t){if(!t)return null;if(3!=(t=t.split(\".\")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=\".\";try{return JSON.parse(yi(t))}catch(r){}return null}gi.prototype.f=function(){return this.b};var wi,Ei={Yc:{bb:\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",jb:\"https://securetoken.googleapis.com/v1/token\",id:\"p\"},$c:{bb:\"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/\",jb:\"https://staging-securetoken.sandbox.googleapis.com/v1/token\",id:\"s\"},ad:{bb:\"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/\",jb:\"https://test-securetoken.sandbox.googleapis.com/v1/token\",id:\"t\"}};function Ti(t){for(var e in Ei)if(Ei[e].id===t)return{firebaseEndpoint:(t=Ei[e]).bb,secureTokenEndpoint:t.jb};return null}wi=Ti(\"__EID__\")?\"__EID__\":void 0;var Ii=\"oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version\".split(\" \"),Si=[\"client_id\",\"response_type\",\"scope\",\"redirect_uri\",\"state\"],Ci={Tc:{Oa:\"locale\",Ba:500,Aa:600,Pa:\"facebook.com\",ib:Si},Vc:{Oa:null,Ba:500,Aa:620,Pa:\"github.com\",ib:Si},Wc:{Oa:\"hl\",Ba:515,Aa:680,Pa:\"google.com\",ib:Si},bd:{Oa:\"lang\",Ba:485,Aa:705,Pa:\"twitter.com\",ib:Ii}};function _i(t){for(var e in Ci)if(Ci[e].Pa==t)return Ci[e];return null}function Ai(t){var e={};e[\"facebook.com\"]=Ri,e[\"google.com\"]=Pi,e[\"github.com\"]=Mi,e[\"twitter.com\"]=Li;var n=t&&t[Di];try{if(n)return e[n]?new e[n](t):new Oi(t);if(\"undefined\"!==typeof t[Ni])return new ki(t)}catch(r){}return null}var Ni=\"idToken\",Di=\"providerId\";function ki(t){var e=t[Di];if(!e&&t[Ni]){var n=vi(t[Ni]);n&&n.a&&(e=n.a)}if(!e)throw Error(\"Invalid additional user info!\");\"anonymous\"!=e&&\"custom\"!=e||(e=null),n=!1,\"undefined\"!==typeof t.isNewUser?n=!!t.isNewUser:\"identitytoolkit#SignupNewUserResponse\"===t.kind&&(n=!0),Ur(this,\"providerId\",e),Ur(this,\"isNewUser\",n)}function Oi(t){ki.call(this,t),Ur(this,\"profile\",Kr((t=Nr(t.rawUserInfo||\"{}\"))||{}))}function Ri(t){if(Oi.call(this,t),\"facebook.com\"!=this.providerId)throw Error(\"Invalid provider ID!\")}function Mi(t){if(Oi.call(this,t),\"github.com\"!=this.providerId)throw Error(\"Invalid provider ID!\");Ur(this,\"username\",this.profile&&this.profile.login||null)}function Pi(t){if(Oi.call(this,t),\"google.com\"!=this.providerId)throw Error(\"Invalid provider ID!\")}function Li(t){if(Oi.call(this,t),\"twitter.com\"!=this.providerId)throw Error(\"Invalid provider ID!\");Ur(this,\"username\",t.screenName||null)}function xi(t){this.a=Cn(t)}function qi(t){var e=Cn(t),n=Sn(e,\"link\"),r=Sn(Cn(n),\"link\");return e=Sn(e,\"deep_link_id\"),Sn(Cn(e),\"link\")||e||r||n||t}function Vi(){}function Fi(t,e){return t.then(function(t){if(t[Na]){var n=vi(t[Na]);if(!n||e!=n.c)throw new Zr(\"user-mismatch\");return t}throw new Zr(\"user-mismatch\")}).s(function(t){throw t&&t.code&&t.code==ei+\"user-not-found\"?new Zr(\"user-mismatch\"):t})}function Ui(t,e){if(!e)throw new Zr(\"internal-error\",\"failed to construct a credential\");this.a=e,Ur(this,\"providerId\",t),Ur(this,\"signInMethod\",t)}function Bi(t){return{pendingToken:t.a,requestUri:\"http://localhost\"}}function ji(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf(\"saml.\")&&t.pendingToken)try{return new Ui(t.providerId,t.pendingToken)}catch(e){}return null}function Ki(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Ur(this,\"idToken\",e.idToken),e.accessToken&&Ur(this,\"accessToken\",e.accessToken),e.nonce&&!e.pendingToken&&Ur(this,\"nonce\",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Zr(\"internal-error\",\"failed to construct a credential\");Ur(this,\"accessToken\",e.oauthToken),Ur(this,\"secret\",e.oauthTokenSecret)}Ur(this,\"providerId\",t),Ur(this,\"signInMethod\",n)}function Qi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:qn(e).toString(),requestUri:\"http://localhost\"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Wi(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Ki(t.providerId,e,t.signInMethod)}catch(n){}}return null}function Gi(t,e){this.Cc=e||[],Br(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(_i(t)||{}).Oa||null,this.ab=null}function zi(t){if(\"string\"!==typeof t||0!=t.indexOf(\"saml.\"))throw new Zr(\"argument-error\",'SAML provider IDs must be prefixed with \"saml.\"');Gi.call(this,t,[])}function Hi(t){Gi.call(this,t,Si),this.a=[]}function Yi(){Hi.call(this,\"facebook.com\")}function Xi(t){if(!t)throw new Zr(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var e=t;return b(t)&&(e=t.accessToken),(new Yi).credential({accessToken:e})}function Ji(){Hi.call(this,\"github.com\")}function $i(t){if(!t)throw new Zr(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var e=t;return b(t)&&(e=t.accessToken),(new Ji).credential({accessToken:e})}function Zi(){Hi.call(this,\"google.com\"),this.ua(\"profile\")}function to(t,e){var n=t;return b(t)&&(n=t.idToken,e=t.accessToken),(new Zi).credential({idToken:n,accessToken:e})}function eo(){Gi.call(this,\"twitter.com\",Ii)}function no(t,e){var n=t;if(b(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Zr(\"argument-error\",\"credential failed: expected 2 arguments (the OAuth access token and secret).\");return new Ki(\"twitter.com\",n,\"twitter.com\")}function ro(t,e,n){this.a=t,this.c=e,Ur(this,\"providerId\",\"password\"),Ur(this,\"signInMethod\",n===oo.EMAIL_LINK_SIGN_IN_METHOD?oo.EMAIL_LINK_SIGN_IN_METHOD:oo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function io(t){return t&&t.email&&t.password?new ro(t.email,t.password,t.signInMethod):null}function oo(){Br(this,{providerId:\"password\",isOAuthProvider:!1})}function ao(t,e){if(!(e=so(e)))throw new Zr(\"argument-error\",\"Invalid email link!\");return new ro(t,e,oo.EMAIL_LINK_SIGN_IN_METHOD)}function so(t){var e=Sn((t=new xi(t=qi(t))).a,\"oobCode\")||null;return\"signIn\"===(Sn(t.a,\"mode\")||null)&&e?e:null}function uo(t){if(!(t.Ua&&t.Ta||t.Fa&&t.$))throw new Zr(\"internal-error\");this.a=t,Ur(this,\"providerId\",\"phone\"),Ur(this,\"signInMethod\",\"phone\")}function co(t){if(t&&\"phone\"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return U([\"verificationId\",\"verificationCode\",\"temporaryProof\",\"phoneNumber\"],function(n){t[n]&&(e[n]=t[n])}),new uo(e)}return null}function ho(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ua,code:t.a.Ta}}function lo(t){try{this.a=t||r.a.auth()}catch(e){throw new Zr(\"argument-error\",\"Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().\")}Br(this,{providerId:\"phone\",isOAuthProvider:!1})}function fo(t,e){if(!t)throw new Zr(\"missing-verification-id\");if(!e)throw new Zr(\"missing-verification-code\");return new uo({Ua:t,Ta:e})}function po(t){if(t.temporaryProof&&t.phoneNumber)return new uo({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||\"password\"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case\"google.com\":return to(o,n);case\"facebook.com\":return Xi(n);case\"github.com\":return $i(n);case\"twitter.com\":return no(n,r);default:return n||r||o||a?a?0==e.indexOf(\"saml.\")?new Ui(e,a):new Ki(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Hi(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function mo(t){if(!t.isOAuthProvider)throw new Zr(\"invalid-oauth-provider\")}function yo(t,e,n,r,i,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new Zr(\"invalid-auth-event\");if(this.g&&this.a)throw new Zr(\"invalid-auth-event\");if(this.g&&!this.f)throw new Zr(\"invalid-auth-event\")}function go(t){return(t=t||{}).type?new yo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&ti(t.error),t.postBody):null}function vo(){this.b=null,this.a=[]}A(Oi,ki),A(Ri,Oi),A(Mi,Oi),A(Pi,Oi),A(Li,Oi),Ui.prototype.la=function(t){return Ga(t,Bi(this))},Ui.prototype.b=function(t,e){var n=Bi(this);return n.idToken=e,za(t,n)},Ui.prototype.f=function(t,e){return Fi(Ha(t,Bi(this)),e)},Ui.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Ki.prototype.la=function(t){return Ga(t,Qi(this))},Ki.prototype.b=function(t,e){var n=Qi(this);return n.idToken=e,za(t,n)},Ki.prototype.f=function(t,e){return Fi(Ha(t,Qi(this)),e)},Ki.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Gi.prototype.Da=function(t){return this.zb=X(t),this},A(zi,Gi),A(Hi,Gi),Hi.prototype.ua=function(t){return K(this.a,t)||this.a.push(t),this},Hi.prototype.Fb=function(){return z(this.a)},Hi.prototype.credential=function(t,e){var n;if(!(n=b(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Zr(\"argument-error\",\"credential failed: must provide the ID token and/or the access token.\");return new Ki(this.providerId,n,this.providerId)},A(Yi,Hi),Ur(Yi,\"PROVIDER_ID\",\"facebook.com\"),Ur(Yi,\"FACEBOOK_SIGN_IN_METHOD\",\"facebook.com\"),A(Ji,Hi),Ur(Ji,\"PROVIDER_ID\",\"github.com\"),Ur(Ji,\"GITHUB_SIGN_IN_METHOD\",\"github.com\"),A(Zi,Hi),Ur(Zi,\"PROVIDER_ID\",\"google.com\"),Ur(Zi,\"GOOGLE_SIGN_IN_METHOD\",\"google.com\"),A(eo,Gi),Ur(eo,\"PROVIDER_ID\",\"twitter.com\"),Ur(eo,\"TWITTER_SIGN_IN_METHOD\",\"twitter.com\"),ro.prototype.la=function(t){return this.signInMethod==oo.EMAIL_LINK_SIGN_IN_METHOD?Is(t,ns,{email:this.a,oobCode:this.c}):Is(t,bs,{email:this.a,password:this.c})},ro.prototype.b=function(t,e){return this.signInMethod==oo.EMAIL_LINK_SIGN_IN_METHOD?Is(t,rs,{idToken:e,email:this.a,oobCode:this.c}):Is(t,ps,{idToken:e,email:this.a,password:this.c})},ro.prototype.f=function(t,e){return Fi(this.la(t),e)},ro.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Br(oo,{PROVIDER_ID:\"password\"}),Br(oo,{EMAIL_LINK_SIGN_IN_METHOD:\"emailLink\"}),Br(oo,{EMAIL_PASSWORD_SIGN_IN_METHOD:\"password\"}),uo.prototype.la=function(t){return t.Va(ho(this))},uo.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,Is(t,Es,n)},uo.prototype.f=function(t,e){var n=ho(this);return n.operation=\"REAUTH\",Fi(t=Is(t,Ts,n),e)},uo.prototype.w=function(){var t={providerId:\"phone\"};return this.a.Ua&&(t.verificationId=this.a.Ua),this.a.Ta&&(t.verificationCode=this.a.Ta),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},lo.prototype.Va=function(t,e){var n=this.a.c;return Zt(e.verify()).then(function(r){if(!c(r))throw new Zr(\"argument-error\",\"An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.\");switch(e.type){case\"recaptcha\":return function(t,e){return Is(t,ls,e)}(n,{phoneNumber:t,recaptchaToken:r}).then(function(t){return\"function\"===typeof e.reset&&e.reset(),t},function(t){throw\"function\"===typeof e.reset&&e.reset(),t});default:throw new Zr(\"argument-error\",'Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.')}})},Br(lo,{PROVIDER_ID:\"phone\"}),Br(lo,{PHONE_SIGN_IN_METHOD:\"phone\"}),yo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join(\"-\")},yo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var bo,wo=null;function Eo(t){var e=\"unauthorized-domain\",n=void 0,r=Cn(t);t=r.b,\"chrome-extension\"==(r=r.f)?n=Vt(\"This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",t):\"http\"==r||\"https\"==r?n=Vt(\"This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",t):e=\"operation-not-supported-in-this-environment\",Zr.call(this,e,n)}function To(t,e,n){Zr.call(this,t,n),(t=e||{}).Ab&&Ur(this,\"email\",t.Ab),t.$&&Ur(this,\"phoneNumber\",t.$),t.credential&&Ur(this,\"credential\",t.credential)}function Io(t){if(t.code){var e=t.code||\"\";0==e.indexOf(ei)&&(e=e.substring(ei.length));var n={credential:po(t)};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Zr(e,t.message||void 0);return new To(e,n,t.message)}return null}function So(){}function Co(t){return t.c||(t.c=t.b())}function _o(){}function Ao(t){if(!t.f&&\"undefined\"==typeof XMLHttpRequest&&\"undefined\"!=typeof ActiveXObject){for(var e=[\"MSXML2.XMLHTTP.6.0\",\"MSXML2.XMLHTTP.3.0\",\"MSXML2.XMLHTTP\",\"Microsoft.XMLHTTP\"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error(\"Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed\")}return t.f}function No(){}function Do(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response=\"\",this.status=-1,this.statusText=\"\",this.a.onload=S(this.cc,this),this.a.onerror=S(this.Gb,this),this.a.onprogress=S(this.dc,this),this.a.ontimeout=S(this.hc,this)}function ko(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Oo(t,e,n){this.reset(t,e,n,void 0,void 0)}vo.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},\"function\"===typeof(t=wr(\"universalLinks.subscribe\",u))&&t(null,this.b))},vo.prototype.unsubscribe=function(t){W(this.a,function(e){return e==t})},A(Eo,Zr),A(To,Zr),To.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.w();return e&&$(t,e),t},To.prototype.toJSON=function(){return this.w()},So.prototype.c=null,A(_o,So),_o.prototype.a=function(){var t=Ao(this);return t?new ActiveXObject(t):new XMLHttpRequest},_o.prototype.b=function(){var t={};return Ao(this)&&(t[0]=!0,t[1]=!0),t},bo=new _o,A(No,So),No.prototype.a=function(){var t=new XMLHttpRequest;if(\"withCredentials\"in t)return t;if(\"undefined\"!=typeof XDomainRequest)return new Do;throw Error(\"Unsupported browser\")},No.prototype.b=function(){return{}},(e=Do.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error(\"Only async requests are supported.\");this.a.open(t,e)},e.send=function(t){if(t){if(\"string\"!=typeof t)throw Error(\"Only string data is supported\");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return\"content-type\"==t.toLowerCase()?this.a.contentType:\"\"},e.cc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ko(this,4)},e.Gb=function(){this.status=500,this.response=this.responseText=\"\",ko(this,4)},e.hc=function(){this.Gb()},e.dc=function(){this.status=200,ko(this,1)},e.getAllResponseHeaders=function(){return\"content-type: \"+this.a.contentType},Oo.prototype.a=null;function Ro(t){this.f=t,this.b=this.c=this.a=null}function Mo(t,e){this.name=t,this.value=e}Oo.prototype.reset=function(t,e,n,r,i){\"number\"==typeof i||0,r||_(),delete this.a},Mo.prototype.toString=function(){return this.name};var Po=new Mo(\"SEVERE\",1e3),Lo=new Mo(\"WARNING\",900),xo=new Mo(\"CONFIG\",700),qo=new Mo(\"FINE\",500);Ro.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(O(\"Root logger has no level set.\"),null)}(this).value)for(v(e)&&(e=e()),t=new Oo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Vo,Fo={},Uo=null;function Bo(t){var e;if(Uo||(Uo=new Ro(\"\"),Fo[\"\"]=Uo,Uo.c=xo),!(e=Fo[t])){e=new Ro(t);var n=t.lastIndexOf(\".\"),r=t.substr(n+1);(n=Bo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,Fo[t]=e}return e}function jo(t,e){t&&t.log(qo,e,void 0)}function Ko(t){this.f=t}function Qo(t){sn.call(this),this.u=t,this.readyState=Wo,this.status=0,this.responseType=this.responseText=this.response=this.statusText=\"\",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.o=\"GET\",this.g=\"\",this.a=!1,this.h=Bo(\"goog.net.FetchXmlHttp\"),this.l=this.c=this.f=null}A(Ko,So),Ko.prototype.a=function(){return new Qo(this.f)},Ko.prototype.b=(Vo={},function(){return Vo}),A(Qo,sn);var Wo=0;function Go(t){t.c.read().then(t.bc.bind(t)).catch(t.Ma.bind(t))}function zo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,Ho(t)}function Ho(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Yo(t){sn.call(this),this.headers=new mn,this.D=t||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l=\"\",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Xo,this.v=this.O=!1}(e=Qo.prototype).open=function(t,e){if(this.readyState!=Wo)throw this.abort(),Error(\"Error reopening a connection\");this.o=t,this.g=e,this.readyState=1,Ho(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error(\"need to call open() first. \");this.a=!0;var e={headers:this.i,method:this.o,credentials:void 0,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.g,e)).then(this.gc.bind(this),this.Ma.bind(this))},e.abort=function(){this.response=this.responseText=\"\",this.i=new Headers,this.status=0,this.c&&this.c.cancel(\"Request was aborted.\"),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,zo(this,!1)),this.readyState=Wo},e.gc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,Ho(this)),this.a&&(this.readyState=3,Ho(this),this.a&&(\"arraybuffer\"===this.responseType?t.arrayBuffer().then(this.ec.bind(this),this.Ma.bind(this)):\"undefined\"!==typeof u.ReadableStream&&\"body\"in t?(this.response=this.responseText=\"\",this.c=t.body.getReader(),this.l=new TextDecoder,Go(this)):t.text().then(this.fc.bind(this),this.Ma.bind(this)))))},e.bc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?zo(this,!0):Ho(this),3==this.readyState&&Go(this)}},e.fc=function(t){this.a&&(this.response=this.responseText=t,zo(this,!0))},e.ec=function(t){this.a&&(this.response=t,zo(this,!0))},e.Ma=function(t){var e=this.h;e&&e.log(Lo,\"Failed to fetch url \"+this.g,t instanceof Error?t:Error(t)),this.a&&zo(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||\"\":((t=this.h)&&t.log(Lo,\"Attempting to get response header but no headers have been received for url: \"+this.g,void 0),\"\")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Lo,\"Attempting to get all response headers but no headers have been received for url: \"+this.g,void 0),\"\"}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+\": \"+n[1]),n=e.next();return t.join(\"\\r\\n\")},A(Yo,sn);var Xo=\"\";Yo.prototype.b=Bo(\"goog.net.XhrIo\");var Jo=/^https?$/i,$o=[\"POST\",\"PUT\"];function Zo(t,e,n,r,i){if(t.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+t.l+\"; newUri=\"+e);n=n?n.toUpperCase():\"GET\",t.l=e,t.h=\"\",t.N=n,t.G=!1,t.c=!0,t.a=t.D?t.D.a():bo.a(),t.A=t.D?Co(t.D):Co(bo),t.a.onreadystatechange=S(t.Jb,t);try{jo(t.b,ua(t,\"Opening Xhr\")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(a){return jo(t.b,ua(t,\"Error opening Xhr: \"+a.message)),void ea(t,a)}e=r||\"\";var o=new mn(t.headers);i&&function(t,e){if(t.forEach&&\"function\"==typeof t.forEach)t.forEach(e,void 0);else if(g(t)||c(t))U(t,e,void 0);else for(var n=dn(t),r=pn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=ta,n=t.length,r=c(t)?t.split(\"\"):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:c(t)?t.charAt(e):t[e]}(o.U()),r=u.FormData&&e instanceof u.FormData,!K($o,n)||i||r||o.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),\"withCredentials\"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{oa(t),0<t.g&&(t.v=function(t){return we&&Oe(9)&&\"number\"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),jo(t.b,ua(t,\"Will abort after \"+t.g+\"ms if incomplete, xhr2 \"+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=S(t.Ga,t)):t.u=ln(t.Ga,t.g,t)),jo(t.b,ua(t,\"Sending request\")),t.i=!0,t.a.send(e),t.i=!1}catch(a){jo(t.b,ua(t,\"Send error: \"+a.message)),ea(t,a)}}function ta(t){return\"content-type\"==t.toLowerCase()}function ea(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,na(t),ia(t)}function na(t){t.G||(t.G=!0,t.dispatchEvent(\"complete\"),t.dispatchEvent(\"error\"))}function ra(t){if(t.c&&\"undefined\"!=typeof s)if(t.A[1]&&4==aa(t)&&2==sa(t))jo(t.b,ua(t,\"Local request error detected and ignored\"));else if(t.i&&4==aa(t))ln(t.Jb,0,t);else if(t.dispatchEvent(\"readystatechange\"),4==aa(t)){jo(t.b,ua(t,\"Request complete\")),t.c=!1;try{var e,n=sa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(vn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!Jo.test(o?o.toLowerCase():\"\")}e=i}if(e)t.dispatchEvent(\"complete\"),t.dispatchEvent(\"success\");else{try{var c=2<aa(t)?t.a.statusText:\"\"}catch(h){jo(t.b,\"Can not get status: \"+h.message),c=\"\"}t.h=c+\" [\"+sa(t)+\"]\",na(t)}}finally{ia(t)}}}function ia(t,e){if(t.a){oa(t);var n=t.a,r=t.A[0]?p:null;t.a=null,t.A=null,e||t.dispatchEvent(\"ready\");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Po,\"Problem encountered resetting onreadystatechange: \"+i.message,void 0)}}}function oa(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(u.clearTimeout(t.u),t.u=null)}function aa(t){return t.a?t.a.readyState:0}function sa(t){try{return 2<aa(t)?t.a.status:-1}catch(e){return-1}}function ua(t,e){return e+\" [\"+t.N+\" \"+t.l+\" \"+sa(t)+\"]\"}function ca(t){var e=wa;this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.m=0}function ha(t,e,n){t.a=!0,t.c=n,t.f=!e,da(t)}function la(t){if(t.a){if(!t.l)throw new ma(t);t.l=!1}}function fa(t,e,n,r){t.g.push([e,n,r]),t.a&&da(t)}function pa(t){return j(t.g,function(t){return v(t[1])})}function da(t){if(t.h&&t.a&&pa(t)){var e=t.h,n=va[e];n&&(u.clearTimeout(n.a),delete va[e]),t.h=0}t.b&&(t.b.m--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.u,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(N(e)||\"function\"===typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,pa(t)||(n=!0)}}t.c=e,r&&(s=S(t.o,t,!0),r=S(t.o,t,!1),e instanceof ca?(fa(e,s,r),e.A=!0):e.then(s,r)),n&&(e=new ga(e),va[e.a]=e,t.h=e.a)}function ma(){D.call(this)}function ya(){D.call(this)}function ga(t){this.a=u.setTimeout(S(this.c,this),0),this.b=t}(e=Yo.prototype).Ga=function(){\"undefined\"!=typeof s&&this.a&&(this.h=\"Timed out after \"+this.g+\"ms, aborting\",jo(this.b,ua(this,this.h)),this.dispatchEvent(\"timeout\"),this.abort(8))},e.abort=function(){this.a&&this.c&&(jo(this.b,ua(this,\"Aborting\")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),ia(this))},e.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ia(this,!0)),Yo.qb.va.call(this)},e.Jb=function(){this.qa||(this.I||this.i||this.f?ra(this):this.vc())},e.vc=function(){ra(this)},e.getResponse=function(){try{if(!this.a)return null;if(\"response\"in this.a)return this.a.response;switch(this.o){case Xo:case\"text\":return this.a.responseText;case\"arraybuffer\":if(\"mozResponseArrayBuffer\"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Po,\"Response type \"+this.o+\" is not supported on this browser\",void 0),null}catch(e){return jo(this.b,\"Can not get response: \"+e.message),null}},ca.prototype.cancel=function(t){if(this.a)this.c instanceof ca&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.m--,0>=e.m&&e.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new ya(this),la(this),ha(this,!1,t))}},ca.prototype.o=function(t,e){this.i=!1,ha(this,t,e)},ca.prototype.then=function(t,e,n){var r,i,o=new Gt(function(t,e){r=t,i=e});return fa(this,r,function(t){t instanceof ya?o.cancel():i(t)}),o.then(t,e,n)},ca.prototype.$goog_Thenable=!0,A(ma,D),ma.prototype.message=\"Deferred has already fired\",ma.prototype.name=\"AlreadyCalledError\",A(ya,D),ya.prototype.message=\"Deferred was canceled\",ya.prototype.name=\"CanceledError\",ga.prototype.c=function(){throw delete va[this.a],this.b};var va={};function ba(t){var e={},n=e.document||document,r=ot(t).toString(),i=document.createElement(\"SCRIPT\"),o={Lb:i,Ga:void 0},a=new ca(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout(function(){Ea(i,!0);var t=new Sa(Ia,\"Timeout reached for loading script \"+r);la(a),ha(a,!1,t)},c),o.Ga=s),i.onload=i.onreadystatechange=function(){i.readyState&&\"loaded\"!=i.readyState&&\"complete\"!=i.readyState||(Ea(i,e.dd||!1,s),la(a),ha(a,!0,null))},i.onerror=function(){Ea(i,!0,s);var t=new Sa(Ta,\"Error while loading script \"+r);la(a),ha(a,!1,t)},$(o=e.attributes||{},{type:\"text/javascript\",charset:\"UTF-8\"}),Wn(i,o),function(t,e){V(t,\"HTMLScriptElement\"),t.src=ot(e),null===f&&(f=(e=(e=u.document).querySelector&&e.querySelector(\"script[nonce]\"))&&(e=e.nonce||e.getAttribute(\"nonce\"))&&l.test(e)?e:\"\"),(e=f)&&t.setAttribute(\"nonce\",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName(\"HEAD\"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function wa(){if(this&&this.Lb){var t=this.Lb;t&&\"SCRIPT\"==t.tagName&&Ea(t,!0,this.Ga)}}function Ea(t,e,n){null!=n&&u.clearTimeout(n),t.onload=p,t.onerror=p,t.onreadystatechange=p,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var Ta=0,Ia=1;function Sa(t,e){var n=\"Jsloader error (code #\"+t+\")\";e&&(n+=\": \"+e),D.call(this,n),this.code=t}function Ca(t){this.f=t}function _a(t,e,n){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||\"https://securetoken.googleapis.com/v1/token\",this.m=t.secureTokenTimeout||Da,this.f=X(t.secureTokenHeaders||ka),this.g=t.firebaseEndpoint||\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",this.h=t.firebaseTimeout||Oa,this.a=X(t.firebaseHeaders||Ra),n&&(this.a[\"X-Client-Version\"]=n,this.f[\"X-Client-Version\"]=n),n=\"Node\"==fr(),!(n=u.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!lr())throw new Zr(\"internal-error\",\"The XMLHttpRequest compatibility library was not found.\");this.c=void 0,lr()?this.c=new Ko(self):pr()?this.c=new Ca(n):this.c=new No}A(Sa,D),A(Ca,So),Ca.prototype.a=function(){return new this.f},Ca.prototype.b=function(){return{}};var Aa,Na=\"idToken\",Da=new Rr(3e4,6e4),ka={\"Content-Type\":\"application/x-www-form-urlencoded\"},Oa=new Rr(3e4,6e4),Ra={\"Content-Type\":\"application/json\"};function Ma(t,e){e?t.a[\"X-Firebase-Locale\"]=e:delete t.a[\"X-Firebase-Locale\"]}function Pa(t,e){e?(t.a[\"X-Client-Version\"]=e,t.f[\"X-Client-Version\"]=e):(delete t.a[\"X-Client-Version\"],delete t.f[\"X-Client-Version\"])}function La(t,e,n,r,i,o,a){(function(){var t=br();return!((t=yr(t)!=mr?null:(t=t.match(/\\sChrome\\/(\\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!we||!De||9<De)})()||lr()?t=S(t.o,t):(Aa||(Aa=new Gt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{u[qa]=function(){((window.gapi||{}).client||{}).request?t():e(Error(\"CORS_UNSUPPORTED\"))};var n=at(xa,{onload:qa});!function(t,e){fa(t,null,e,void 0)}(ba(n),function(){e(Error(\"CORS_UNSUPPORTED\"))})}}(t,e)})),t=S(t.l,t)),t(e,n,r,i,o,a)}_a.prototype.o=function(t,e,n,r,i,o){if(lr()&&(\"undefined\"===typeof u.fetch||\"undefined\"===typeof u.Headers||\"undefined\"===typeof u.Request))throw new Zr(\"operation-not-supported-in-this-environment\",\"fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.\");var a=new Yo(this.c);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent(\"timeout\")},o)}un(a,\"complete\",function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:\"\"}catch(e){return jo(t.b,\"Can not get responseText: \"+e.message),\"\"}}(this))||null}catch(n){t=null}e&&e(t)}),cn(a,\"ready\",function(){s&&clearTimeout(s),ye(this)}),cn(a,\"timeout\",function(){s&&clearTimeout(s),ye(this),e&&e(null)}),Zo(a,t,n,r,i)};var xa=new Z(nt,\"https://apis.google.com/js/client.js?onload=%{onload}\"),qa=\"__fcb\"+Math.floor(1e6*Math.random()).toString();function Va(t){if(!c(t=t.email)||!sr.test(t))throw new Zr(\"invalid-email\")}function Fa(t){\"email\"in t&&Va(t)}function Ua(t){if(!t[Na])throw new Zr(\"internal-error\")}function Ba(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Zr(\"internal-error\")}else{if(!t.sessionInfo)throw new Zr(\"missing-verification-id\");if(!t.code)throw new Zr(\"missing-verification-code\")}}_a.prototype.l=function(t,e,n,r,i){var o=this;Aa.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:\"none\",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||\"CORS_UNSUPPORTED\"}})})},_a.prototype.ob=function(){return Is(this,ds,{})},_a.prototype.rb=function(t,e){return Is(this,fs,{idToken:t,email:e})},_a.prototype.sb=function(t,e){return Is(this,ps,{idToken:t,password:e})};var ja={displayName:\"DISPLAY_NAME\",photoUrl:\"PHOTO_URL\"};function Ka(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Zr(\"internal-error\")}function Qa(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf(\"oidc.\")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Fn(t=new Ln(t.postBody),\"nonce\")&&(e.nonce=t.get(\"nonce\")))),e}function Wa(t){var e=null;if(t.needConfirmation?(t.code=\"account-exists-with-different-credential\",e=Io(t)):\"FEDERATED_USER_ID_ALREADY_LINKED\"==t.errorMessage?(t.code=\"credential-already-in-use\",e=Io(t)):\"EMAIL_EXISTS\"==t.errorMessage?(t.code=\"email-already-in-use\",e=Io(t)):t.errorMessage&&(e=Ss(t.errorMessage)),e)throw e;if(!t[Na])throw new Zr(\"internal-error\")}function Ga(t,e){return e.returnIdpCredential=!0,Is(t,ms,e)}function za(t,e){return e.returnIdpCredential=!0,Is(t,gs,e)}function Ha(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Is(t,ys,e)}function Ya(t){if(!t.oobCode)throw new Zr(\"invalid-action-code\")}(e=_a.prototype).tb=function(t,e){var n={idToken:t},r=[];return H(ja,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Is(this,fs,n)},e.lb=function(t,e){return $(t={requestType:\"PASSWORD_RESET\",email:t},e),Is(this,ss,t)},e.mb=function(t,e){return $(t={requestType:\"EMAIL_SIGNIN\",email:t},e),Is(this,os,t)},e.kb=function(t,e){return $(t={requestType:\"VERIFY_EMAIL\",idToken:t},e),Is(this,as,t)},e.Va=function(t){return Is(this,ws,t)},e.$a=function(t,e){return Is(this,hs,{oobCode:t,newPassword:e})},e.Ka=function(t){return Is(this,Ja,{oobCode:t})},e.Xa=function(t){return Is(this,Xa,{oobCode:t})};var Xa={endpoint:\"setAccountInfo\",C:Ya,da:\"email\"},Ja={endpoint:\"resetPassword\",C:Ya,J:function(t){var e=t.requestType;if(!e||!t.email&&\"EMAIL_SIGNIN\"!=e)throw new Zr(\"internal-error\")}},$a={endpoint:\"signupNewUser\",C:function(t){if(Va(t),!t.password)throw new Zr(\"weak-password\")},J:Ua,R:!0},Za={endpoint:\"createAuthUri\"},ts={endpoint:\"deleteAccount\",T:[\"idToken\"]},es={endpoint:\"setAccountInfo\",T:[\"idToken\",\"deleteProvider\"],C:function(t){if(!y(t.deleteProvider))throw new Zr(\"internal-error\")}},ns={endpoint:\"emailLinkSignin\",T:[\"email\",\"oobCode\"],C:Va,J:Ua,R:!0},rs={endpoint:\"emailLinkSignin\",T:[\"idToken\",\"email\",\"oobCode\"],C:Va,J:Ua,R:!0},is={endpoint:\"getAccountInfo\"},os={endpoint:\"getOobConfirmationCode\",T:[\"requestType\"],C:function(t){if(\"EMAIL_SIGNIN\"!=t.requestType)throw new Zr(\"internal-error\");Va(t)},da:\"email\"},as={endpoint:\"getOobConfirmationCode\",T:[\"idToken\",\"requestType\"],C:function(t){if(\"VERIFY_EMAIL\"!=t.requestType)throw new Zr(\"internal-error\")},da:\"email\"},ss={endpoint:\"getOobConfirmationCode\",T:[\"requestType\"],C:function(t){if(\"PASSWORD_RESET\"!=t.requestType)throw new Zr(\"internal-error\");Va(t)},da:\"email\"},us={wb:!0,endpoint:\"getProjectConfig\",Ib:\"GET\"},cs={wb:!0,endpoint:\"getRecaptchaParam\",Ib:\"GET\",J:function(t){if(!t.recaptchaSiteKey)throw new Zr(\"internal-error\")}},hs={endpoint:\"resetPassword\",C:Ya,da:\"email\"},ls={endpoint:\"sendVerificationCode\",T:[\"phoneNumber\",\"recaptchaToken\"],da:\"sessionInfo\"},fs={endpoint:\"setAccountInfo\",T:[\"idToken\"],C:Fa,R:!0},ps={endpoint:\"setAccountInfo\",T:[\"idToken\"],C:function(t){if(Fa(t),!t.password)throw new Zr(\"weak-password\")},J:Ua,R:!0},ds={endpoint:\"signupNewUser\",J:Ua,R:!0},ms={endpoint:\"verifyAssertion\",C:Ka,Qa:Qa,J:Wa,R:!0},ys={endpoint:\"verifyAssertion\",C:Ka,Qa:Qa,J:function(t){if(t.errorMessage&&\"USER_NOT_FOUND\"==t.errorMessage)throw new Zr(\"user-not-found\");if(t.errorMessage)throw Ss(t.errorMessage);if(!t[Na])throw new Zr(\"internal-error\")},R:!0},gs={endpoint:\"verifyAssertion\",C:function(t){if(Ka(t),!t.idToken)throw new Zr(\"internal-error\")},Qa:Qa,J:Wa,R:!0},vs={endpoint:\"verifyCustomToken\",C:function(t){if(!t.token)throw new Zr(\"invalid-custom-token\")},J:Ua,R:!0},bs={endpoint:\"verifyPassword\",C:function(t){if(Va(t),!t.password)throw new Zr(\"wrong-password\")},J:Ua,R:!0},ws={endpoint:\"verifyPhoneNumber\",C:Ba,J:Ua},Es={endpoint:\"verifyPhoneNumber\",C:function(t){if(!t.idToken)throw new Zr(\"internal-error\");Ba(t)},J:function(t){if(t.temporaryProof)throw t.code=\"credential-already-in-use\",Io(t);Ua(t)}},Ts={Vb:{USER_NOT_FOUND:\"user-not-found\"},endpoint:\"verifyPhoneNumber\",C:Ba,J:Ua};function Is(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||\"\"===r)return!1}return!0}(n,e.T))return te(new Zr(\"internal-error\"));var r,i=e.Ib||\"POST\";return Zt(n).then(e.C).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=Cn(t.g+e);In(a,\"key\",t.b),o&&In(a,\"cb\",_().toString());var s=\"GET\"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&In(a,u,r[u]);return new Gt(function(e,o){La(t,a.toString(),function(t){t?t.error?o(Cs(t,i||{})):e(t):o(new Zr(\"network-request-failed\"))},n,s?void 0:Yn(Ar(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Vb,e.wb||!1)}).then(function(t){return r=t,e.Qa?e.Qa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new Zr(\"internal-error\");return r[e.da]})}function Ss(t){return Cs({error:{errors:[{message:t}],code:400,message:t}})}function Cs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||\"\",r={keyInvalid:\"invalid-api-key\",ipRefererBlocked:\"app-not-authorized\"};if(n=r[n]?new Zr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||\"\",$(r={INVALID_CUSTOM_TOKEN:\"invalid-custom-token\",CREDENTIAL_MISMATCH:\"custom-token-mismatch\",MISSING_CUSTOM_TOKEN:\"internal-error\",INVALID_IDENTIFIER:\"invalid-email\",MISSING_CONTINUE_URI:\"internal-error\",INVALID_EMAIL:\"invalid-email\",INVALID_PASSWORD:\"wrong-password\",USER_DISABLED:\"user-disabled\",MISSING_PASSWORD:\"internal-error\",EMAIL_EXISTS:\"email-already-in-use\",PASSWORD_LOGIN_DISABLED:\"operation-not-allowed\",INVALID_IDP_RESPONSE:\"invalid-credential\",INVALID_PENDING_TOKEN:\"invalid-credential\",FEDERATED_USER_ID_ALREADY_LINKED:\"credential-already-in-use\",MISSING_OR_INVALID_NONCE:\"missing-or-invalid-nonce\",INVALID_MESSAGE_PAYLOAD:\"invalid-message-payload\",INVALID_RECIPIENT_EMAIL:\"invalid-recipient-email\",INVALID_SENDER:\"invalid-sender\",EMAIL_NOT_FOUND:\"user-not-found\",RESET_PASSWORD_EXCEED_LIMIT:\"too-many-requests\",EXPIRED_OOB_CODE:\"expired-action-code\",INVALID_OOB_CODE:\"invalid-action-code\",MISSING_OOB_CODE:\"internal-error\",INVALID_PROVIDER_ID:\"invalid-provider-id\",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:\"requires-recent-login\",INVALID_ID_TOKEN:\"invalid-user-token\",TOKEN_EXPIRED:\"user-token-expired\",USER_NOT_FOUND:\"user-token-expired\",CORS_UNSUPPORTED:\"cors-unsupported\",DYNAMIC_LINK_NOT_ACTIVATED:\"dynamic-link-not-activated\",INVALID_APP_ID:\"invalid-app-id\",TOO_MANY_ATTEMPTS_TRY_LATER:\"too-many-requests\",WEAK_PASSWORD:\"weak-password\",OPERATION_NOT_ALLOWED:\"operation-not-allowed\",USER_CANCELLED:\"user-cancelled\",CAPTCHA_CHECK_FAILED:\"captcha-check-failed\",INVALID_APP_CREDENTIAL:\"invalid-app-credential\",INVALID_CODE:\"invalid-verification-code\",INVALID_PHONE_NUMBER:\"invalid-phone-number\",INVALID_SESSION_INFO:\"invalid-verification-id\",INVALID_TEMPORARY_PROOF:\"invalid-credential\",MISSING_APP_CREDENTIAL:\"missing-app-credential\",MISSING_CODE:\"missing-verification-code\",MISSING_PHONE_NUMBER:\"missing-phone-number\",MISSING_SESSION_INFO:\"missing-verification-id\",QUOTA_EXCEEDED:\"quota-exceeded\",SESSION_EXPIRED:\"code-expired\",REJECTED_CREDENTIAL:\"rejected-credential\",INVALID_CONTINUE_URI:\"invalid-continue-uri\",MISSING_ANDROID_PACKAGE_NAME:\"missing-android-pkg-name\",MISSING_IOS_BUNDLE_ID:\"missing-ios-bundle-id\",UNAUTHORIZED_DOMAIN:\"unauthorized-continue-uri\",INVALID_DYNAMIC_LINK_DOMAIN:\"invalid-dynamic-link-domain\",INVALID_OAUTH_CLIENT_ID:\"invalid-oauth-client-id\",INVALID_CERT_HASH:\"invalid-cert-hash\",ADMIN_ONLY_OPERATION:\"admin-restricted-operation\"},e||{}),e=(e=n.match(/^[^\\s]+\\s*:\\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Zr(r[i],e);return!e&&t&&(e=_r(t)),new Zr(\"internal-error\",e)}function _s(t){this.b=t,this.a=null,this.gb=function(t){return(ks||(ks=new Gt(function(t,e){function n(){Or(),wr(\"gapi.load\")(\"gapi.iframes\",{callback:t,ontimeout:function(){Or(),e(Error(\"Network Error\"))},timeout:Ns.get()})}if(wr(\"gapi.iframes.Iframe\"))t();else if(wr(\"gapi.load\"))n();else{var r=\"__iframefcb\"+Math.floor(1e6*Math.random()).toString();u[r]=function(){wr(\"gapi.load\")?n():e(Error(\"Network Error\"))},Zt(ba(r=at(As,{onload:r}))).s(function(){e(Error(\"Network Error\"))})}}).s(function(t){throw ks=null,t}))).then(function(){return new Gt(function(e,n){wr(\"gapi.iframes.getContext\")().open({where:document.body,url:t.b,messageHandlersFilter:wr(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"),attributes:{style:{position:\"absolute\",top:\"-100px\",width:\"1px\",height:\"1px\"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error(\"Network Error\"))},Ds.get());r.ping(i).then(i,function(){n(Error(\"Network Error\"))})})})})}(this)}var As=new Z(nt,\"https://apis.google.com/js/api.js?onload=%{onload}\"),Ns=new Rr(3e4,6e4),Ds=new Rr(5e3,15e3),ks=null;function Os(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=_n(this.i,\"/__/auth/iframe\"),In(this.a,\"apiKey\",this.g),In(this.a,\"appName\",this.h),this.b=null,this.c=[]}function Rs(t,e,n,r,i){this.o=t,this.l=e,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ms(t){try{return r.a.app(t).auth().ya()}catch(e){return[]}}function Ps(t,e,n,r,i){this.l=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Ls(t){var e=er();return function(t){return Is(t,us,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=Cn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf(\"chrome-extension://\")?a=Cn(o).b==a&&\"chrome-extension\"==s:\"http\"!=s&&\"https\"!=s?a=!1:ar.test(o)?a=a==o:(o=o.split(\".\").join(\"\\\\.\"),a=new RegExp(\"^(.+\\\\.\"+o+\"|\"+o+\")$\",\"i\").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Eo(er())})}function xs(t){return t.m?t.m:(t.m=ur().then(function(){if(!t.u){var e=t.c,n=t.h,r=Ms(t.b),i=new Os(t.l,t.f,t.b);i.f=e,i.b=n,i.c=z(r||[]),t.u=i.toString()}t.i=new _s(t.u),function(t){if(!t.i)throw Error(\"IfcHandler must be initialized!\");!function(t,e){t.gb.then(function(){t.a.register(\"authEvent\",e,wr(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=go(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?\"ACK\":\"ERROR\",Zt(n)}return n.status=\"ERROR\",Zt(n)})}(t)}),t.m)}function qs(t){return t.o||(t.v=t.c?vr(t.c,Ms(t.b)):null,t.o=new _a(t.f,Ti(t.h),t.v)),t.o}function Vs(t,e,n,r,i,o,a,s,u,c){return(t=new Rs(t,e,n,r,i)).i=o,t.g=a,t.h=s,t.b=X(u||null),t.f=c,t.toString()}function Fs(t){if(this.a=t||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Zr(\"internal-error\",\"The React Native compatibility library was not found.\");this.type=\"asyncStorage\"}function Us(t){this.b=t,this.a={},this.c=S(this.f,this)}Os.prototype.toString=function(){return this.f?In(this.a,\"v\",this.f):Vn(this.a.a,\"v\"),this.b?In(this.a,\"eid\",this.b):Vn(this.a.a,\"eid\"),this.c.length?In(this.a,\"fw\",this.c.join(\",\")):Vn(this.a.a,\"fw\"),this.a.toString()},Rs.prototype.toString=function(){var t=_n(this.o,\"/__/auth/handler\");if(In(t,\"apiKey\",this.l),In(t,\"appName\",this.c),In(t,\"authType\",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.a.app(this.c).auth().ea()}catch(u){n=null}for(var i in e.ab=n,In(t,\"providerId\",this.a.providerId),n=Ar((e=this.a).zb))n[i]=n[i].toString();i=e.Cc,n=X(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}e.eb&&e.ab&&!n[e.eb]&&(n[e.eb]=e.ab),Y(n)||In(t,\"customParameters\",_r(n))}if(\"function\"===typeof this.a.Fb&&((e=this.a.Fb()).length&&In(t,\"scopes\",e.join(\",\"))),this.i?In(t,\"redirectUrl\",this.i):Vn(t.a,\"redirectUrl\"),this.g?In(t,\"eventId\",this.g):Vn(t.a,\"eventId\"),this.h?In(t,\"v\",this.h):Vn(t.a,\"v\"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Sn(t,s)&&In(t,s,this.b[s]);return this.f?In(t,\"eid\",this.f):Vn(t.a,\"eid\"),(s=Ms(this.c)).length&&In(t,\"fw\",s.join(\",\")),t.toString()},(e=Ps.prototype).Ea=function(t,e,n){var r=new Zr(\"popup-closed-by-user\"),i=new Zr(\"web-storage-unsupported\"),o=this,a=!1;return this.ga().then(function(){(function(t){var e={type:\"webStorageSupport\"};return xs(t).then(function(){return function(t,e){return t.gb.then(function(){return new Gt(function(n){t.a.send(e.type,e,n,wr(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&\"undefined\"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&ir(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new Gt(function(e){return function n(){fn(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return fn(n).then(function(){e(r)})})},e.Mb=function(){var t=br();return!Cr(t)&&!kr(t)},e.Hb=function(){return!1},e.Db=function(t,e,n,r,i,o,a){if(!t)return te(new Zr(\"popup-blocked\"));if(a&&!Cr())return this.ga().s(function(e){ir(t),i(e)}),r(),Zt();this.a||(this.a=Ls(qs(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw ir(t),i(e),e});return r(),e}).then(function(){(mo(n),a)||nr(Vs(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw\"auth/network-request-failed\"==t.code&&(s.a=null),t})},e.Ca=function(t,e,n){this.a||(this.a=Ls(qs(this)));var r=this;return this.a.then(function(){mo(e),nr(Vs(r.l,r.f,r.b,t,e,er(),n,r.c,void 0,r.h))}).s(function(t){throw\"auth/network-request-failed\"==t.code&&(r.a=null),t})},e.ga=function(){var t=this;return xs(this).then(function(){return t.i.gb}).s(function(){throw t.a=null,new Zr(\"network-request-failed\")})},e.Ob=function(){return!0},e.wa=function(t){this.g.push(t)},e.La=function(t){W(this.g,function(e){return e==t})},(e=Fs.prototype).get=function(t){return Zt(this.a.getItem(t)).then(function(t){return t&&Nr(t)})},e.set=function(t,e){return Zt(this.a.setItem(t,_r(e)))},e.P=function(t){return Zt(this.a.removeItem(t))},e.Y=function(){},e.ca=function(){};var Bs,js=[];function Ks(t){this.a=t}function Qs(t){this.c=t,this.b=!1,this.a=[]}function Ws(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return te(Error(\"connection_unavailable\"));var h=r?800:50,l=\"undefined\"!==typeof MessageChannel?new MessageChannel:null;return new Gt(function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){r(Error(\"unsupported_event\"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&(\"ack\"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error(\"timeout\"))},3e3)):\"done\"===t.data.status?(clearTimeout(s),\"undefined\"!==typeof t.data.response?n(t.data.response):r(Error(\"unknown_error\"))):(clearTimeout(a),clearTimeout(s),r(Error(\"invalid_response\"))))}},t.a.push(c),l.port1.addEventListener(\"message\",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error(\"connection_unavailable\"))}).then(function(e){return Gs(t,c),e}).s(function(e){throw Gs(t,c),e})}function Gs(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener(\"message\",r),n.port1.close()),W(t.a,function(t){return t==e})}}function zs(){if(!Xs())throw new Zr(\"web-storage-unsupported\");this.c={},this.a=[],this.b=0,this.l=u.indexedDB,this.type=\"indexedDB\",this.g=this.m=this.f=this.i=null,this.u=!1,this.h=null;var t=this;lr()&&self?(this.m=function(){var t=lr()?self:null;if(U(js,function(n){n.b==t&&(e=n)}),!e){var e=new Us(t);js.push(e)}return e}(),this.m.subscribe(\"keyChanged\",function(e,n){return eu(t).then(function(e){return 0<e.length&&U(t.a,function(t){t(e)}),{keyProcessed:K(e,n.key)}})}),this.m.subscribe(\"ping\",function(){return Zt([\"keyChanged\"])})):function(){var t=u.navigator;return t&&t.serviceWorker?Zt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Zt(null)}().then(function(e){(t.h=e)&&(t.g=new Qs(new Ks(e)),Ws(t.g,\"ping\",null,!0).then(function(e){e[0].fulfilled&&K(e[0].value,\"keyChanged\")&&(t.u=!0)}).s(function(){}))})}function Hs(t){return new Gt(function(e,n){var r=t.l.open(\"firebaseLocalStorageDb\",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore(\"firebaseLocalStorage\",{keyPath:\"fbase_key\"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains(\"firebaseLocalStorage\")?e(r):function(t){return new Gt(function(e,n){var r=t.l.deleteDatabase(\"firebaseLocalStorageDb\");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return Hs(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function Ys(t){return t.o||(t.o=Hs(t)),t.o}function Xs(){try{return!!u.indexedDB}catch(Vo){return!1}}function Js(t){return t.objectStore(\"firebaseLocalStorage\")}function $s(t,e){return t.transaction([\"firebaseLocalStorage\"],e?\"readwrite\":\"readonly\")}function Zs(t){return new Gt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function tu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Ws(t.g,\"keyChanged\",{key:e},t.u).then(function(){}).s(function(){}):Zt()}function eu(t){return Ys(t).then(function(t){var e=Js($s(t,!1));return e.getAll?Zs(e.getAll()):new Gt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):\"object\"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function nu(t){t.i&&t.i.cancel(\"STOP_EVENT\"),t.f&&(clearTimeout(t.f),t.f=null)}function ru(t){var e=this,n=null;this.a=[],this.type=\"indexedDB\",this.c=t,this.b=Zt().then(function(){if(Xs()){var t=Dr(),r=\"__sak\"+t;return Bs||(Bs=new zs),(n=Bs).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error(\"indexedDB not supported!\");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){U(e.a,function(e){e(t)})}),t})}function iu(){this.a={},this.type=\"inMemory\"}function ou(){if(!function(){var t=\"Node\"==fr();if(!(t=au()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return t.setItem(\"__sak\",\"1\"),t.removeItem(\"__sak\"),!0}catch(e){return!1}}()){if(\"Node\"==fr())throw new Zr(\"internal-error\",\"The LocalStorage compatibility library was not found.\");throw new Zr(\"web-storage-unsupported\")}this.a=au()||r.a.INTERNAL.node.localStorage,this.type=\"localStorage\"}function au(){try{var t=u.localStorage,e=Dr();return t&&(t.setItem(e,\"1\"),t.removeItem(e)),t}catch(n){return null}}function su(){this.type=\"nullStorage\"}function uu(){if(!function(){var t=\"Node\"==fr();if(!(t=cu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem(\"__sak\",\"1\"),t.removeItem(\"__sak\"),!0}catch(e){return!1}}()){if(\"Node\"==fr())throw new Zr(\"internal-error\",\"The SessionStorage compatibility library was not found.\");throw new Zr(\"web-storage-unsupported\")}this.a=cu()||r.a.INTERNAL.node.sessionStorage,this.type=\"sessionStorage\"}function cu(){try{var t=u.sessionStorage,e=Dr();return t&&(t.setItem(e,\"1\"),t.removeItem(e)),t}catch(n){return null}}function hu(){var t={};t.Browser=pu,t.Node=du,t.ReactNative=mu,t.Worker=yu,this.a=t[fr()]}Us.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:\"ack\",eventId:n,eventType:e,response:null});var i=[];U(r,function(e){i.push(Zt().then(function(){return e(t.origin,t.data.data)}))}),ne(i).then(function(r){var i=[];U(r,function(t){i.push({fulfilled:t.Eb,value:t.value,reason:t.reason?t.reason.message:void 0})}),U(i,function(t){for(var e in t)\"undefined\"===typeof t[e]&&delete t[e]}),t.ports[0].postMessage({status:\"done\",eventId:n,eventType:e,response:i})})}},Us.prototype.subscribe=function(t,e){Y(this.a)&&this.b.addEventListener(\"message\",this.c),\"undefined\"===typeof this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},Us.prototype.unsubscribe=function(t,e){\"undefined\"!==typeof this.a[t]&&e?(W(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],Y(this.a)&&this.b.removeEventListener(\"message\",this.c)},Ks.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Qs.prototype.close=function(){for(;0<this.a.length;)Gs(this,this.a[0]);this.b=!0},(e=zs.prototype).set=function(t,e){var n,r=!1,i=this;return Ys(this).then(function(e){return Zs((e=Js($s(n=e,!0))).get(t))}).then(function(o){var a=Js($s(n,!0));return o?(o.value=e,Zs(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Zs(a.add(o)))}).then(function(){return i.c[t]=e,tu(i,t)}).ia(function(){r&&i.b--})},e.get=function(t){return Ys(this).then(function(e){return Zs(Js($s(e,!1)).get(t))}).then(function(t){return t&&t.value})},e.P=function(t){var e=!1,n=this;return Ys(this).then(function(r){return e=!0,n.b++,Zs(Js($s(r,!0)).delete(t))}).then(function(){return delete n.c[t],tu(n,t)}).ia(function(){e&&n.b--})},e.Y=function(t){0==this.a.length&&function(t){nu(t),function e(){t.f=setTimeout(function(){t.i=eu(t).then(function(e){0<e.length&&U(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){\"STOP_EVENT\"!=t.message&&e()})},800)}()}(this),this.a.push(t)},e.ca=function(t){W(this.a,function(e){return e==t}),0==this.a.length&&nu(this)},(e=ru.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},e.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},e.P=function(t){return this.b.then(function(e){return e.P(t)})},e.Y=function(t){this.a.push(t)},e.ca=function(t){W(this.a,function(e){return e==t})},(e=iu.prototype).get=function(t){return Zt(this.a[t])},e.set=function(t,e){return this.a[t]=e,Zt()},e.P=function(t){return delete this.a[t],Zt()},e.Y=function(){},e.ca=function(){},(e=ou.prototype).get=function(t){var e=this;return Zt().then(function(){return Nr(e.a.getItem(t))})},e.set=function(t,e){var n=this;return Zt().then(function(){var r=_r(e);null===r?n.P(t):n.a.setItem(t,r)})},e.P=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},e.Y=function(t){u.window&&He(u.window,\"storage\",t)},e.ca=function(t){u.window&&Je(u.window,\"storage\",t)},(e=su.prototype).get=function(){return Zt(null)},e.set=function(){return Zt()},e.P=function(){return Zt()},e.Y=function(){},e.ca=function(){},(e=uu.prototype).get=function(t){var e=this;return Zt().then(function(){return Nr(e.a.getItem(t))})},e.set=function(t,e){var n=this;return Zt().then(function(){var r=_r(e);null===r?n.P(t):n.a.setItem(t,r)})},e.P=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},e.Y=function(){},e.ca=function(){};var lu,fu,pu={B:ou,Sa:uu},du={B:ou,Sa:uu},mu={B:Fs,Sa:su},yu={B:ou,Sa:su},gu={Xc:\"local\",NONE:\"none\",Zc:\"session\"};function vu(){var t=!(kr(br())||!hr()),e=Cr(),n=Er();this.o=t,this.h=e,this.m=n,this.a={},lu||(lu=new hu),t=lu;try{this.g=!tr()&&Lr()||!u.indexedDB?new t.a.B:new ru(lr()?new iu:new t.a.B)}catch(r){this.g=new iu,this.h=!0}try{this.i=new t.a.Sa}catch(r){this.i=new iu}this.l=new iu,this.f=S(this.Nb,this),this.b={}}function bu(){return fu||(fu=new vu),fu}function wu(t,e){switch(e){case\"session\":return t.i;case\"none\":return t.l;default:return t.g}}function Eu(t,e){return\"firebase:\"+t.name+(e?\":\"+e:\"\")}function Tu(t,e,n){return n=Eu(e,n),\"local\"==e.B&&(t.b[n]=null),wu(t,e.B).P(n)}function Iu(t){t.c&&(clearInterval(t.c),t.c=null)}function Su(t){this.a=t,this.b=bu()}(e=vu.prototype).get=function(t,e){return wu(this,t.B).get(Eu(t,e))},e.set=function(t,e,n){var r=Eu(t,n),i=this,o=wu(this,t.B);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){\"local\"==t.B&&(i.b[r]=e)})},e.addListener=function(t,e,n){t=Eu(t,e),this.m&&(this.b[t]=u.localStorage.getItem(t)),Y(this.a)&&(wu(this,\"local\").Y(this.f),this.h||(tr()||!Lr())&&u.indexedDB||!this.m||function(t){Iu(t),t.c=setInterval(function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new qe({type:\"storage\",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Nb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=Eu(t,e),this.a[t]&&(W(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),Y(this.a)&&(wu(this,\"local\").ca(this.f),Iu(this))},e.Nb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];\"undefined\"===typeof r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Ya(n))}else if(0==e.indexOf(\"firebase:\")&&this.a[e]){if(\"undefined\"!==typeof t.a.a?wu(this,\"local\").ca(this.f):Iu(this),this.o)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&\"undefined\"===typeof t.a.a)return;var o=this;n=function(){\"undefined\"===typeof t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.Ya(e))},we&&De&&10==De&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else U(t,S(this.Ya,this))},e.Ya=function(t){this.a[t]&&U(this.a[t],function(t){t()})};var Cu,_u={name:\"authEvent\",B:\"local\"};function Au(){this.a=bu()}function Nu(t,e){this.b=Du,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.m=u.Int32Array?new Int32Array(64):Array(64),void 0!==Cu||(Cu=u.Int32Array?new Int32Array(xu):xu),this.reset()}A(Nu,function(){this.b=-1});for(var Du=64,ku=Du-1,Ou=[],Ru=0;Ru<ku;Ru++)Ou[Ru]=0;var Mu=G(128,Ou);function Pu(t){for(var e=t.f,n=t.m,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Cu[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Lu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(c(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Pu(t),i=0);else{if(!g(e))throw Error(\"message must be string or array\");for(;r<n;){var o=e[r++];if(!(\"number\"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error(\"message must be a byte array\");t.f[i++]=o,i==t.b&&(Pu(t),i=0)}}t.c=i,t.g+=n}Nu.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):z(this.h)};var xu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function qu(){Nu.call(this,8,Vu)}A(qu,Nu);var Vu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Fu(t,e,n,r,i){this.l=t,this.i=e,this.m=n,this.o=r||null,this.u=i||null,this.h=e+\":\"+n,this.v=new Au,this.g=new Su(this.h),this.f=null,this.b=[],this.a=this.c=null}function Uu(t){return new Zr(\"invalid-cordova-configuration\",t)}function Bu(t){var e=new qu;Lu(e,t),t=[];var n=8*e.g;56>e.c?Lu(e,Mu,56-e.c):Lu(e,Mu,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Pu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return B(t,function(t){return 1<(t=t.toString(16)).length?t:\"0\"+t}).join(\"\")}(t)}function ju(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function Ku(t){return t.f||(t.f=t.ga().then(function(){return new Gt(function(e){t.wa(function n(r){return e(r),t.La(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),Qu(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=qi(e.url)).indexOf(\"/__/auth/callback\")&&(o=(o=\"object\"===typeof(o=Nr(Sn(o=Cn(i),\"firebaseError\")||null))?ti(o):null)?new yo(r.c,r.b,null,null,o):new yo(r.c,r.b,i,r.f)),i=o||n}ju(t,i)})}var n=new yo(\"unknown\",null,null,null,new Zr(\"no-auth-event\")),r=!1,i=fn(500).then(function(){return Qu(t).then(function(){r||ju(t,n)})}),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(wr(\"BuildInfo.packageName\",u).toLowerCase()+\"://\")&&e({url:t}),\"function\"===typeof o)try{o(t)}catch(n){console.error(n)}},wo||(wo=new vo),wo.subscribe(e)}(t)})})),t.f}function Qu(t){var e=null;return function(t){return t.b.get(_u,t.a).then(function(t){return go(t)})}(t.g).then(function(n){return e=n,Tu((n=t.g).b,_u,n.a)}).then(function(){return e})}function Wu(t){this.a=t,this.b=bu()}(e=Fu.prototype).ga=function(){return this.za?this.za:this.za=(cr(void 0)?ur().then(function(){return new Gt(function(t,e){var n=u.document,r=setTimeout(function(){e(Error(\"Cordova framework is not ready.\"))},1e3);n.addEventListener(\"deviceready\",function(){clearTimeout(r),t()},!1)})}):te(Error(\"Cordova must run in an Android or iOS file scheme.\"))).then(function(){if(\"function\"!==typeof wr(\"universalLinks.subscribe\",u))throw Uu(\"cordova-universal-links-plugin-fix is not installed\");if(\"undefined\"===typeof wr(\"BuildInfo.packageName\",u))throw Uu(\"cordova-plugin-buildinfo is not installed\");if(\"function\"!==typeof wr(\"cordova.plugins.browsertab.openUrl\",u))throw Uu(\"cordova-plugin-browsertab is not installed\");if(\"function\"!==typeof wr(\"cordova.InAppBrowser.open\",u))throw Uu(\"cordova-plugin-inappbrowser is not installed\")},function(){throw new Zr(\"cordova-not-ready\")})},e.Ea=function(t,e){return e(new Zr(\"operation-not-supported-in-this-environment\")),Zt()},e.Db=function(){return te(new Zr(\"operation-not-supported-in-this-environment\"))},e.Ob=function(){return!1},e.Mb=function(){return!0},e.Hb=function(){return!0},e.Ca=function(t,e,n){if(this.c)return te(new Zr(\"redirect-operation-pending\"));var r=this,i=u.document,o=null,a=null,s=null,c=null;return this.c=Zt().then(function(){return mo(e),Ku(r)}).then(function(){return function(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),t--;return e.join(\"\")}(),o=new yo(e,r,null,i,new Zr(\"no-auth-event\")),a=wr(\"BuildInfo.packageName\",u);if(\"string\"!==typeof a)throw new Zr(\"invalid-cordova-configuration\");var s=wr(\"BuildInfo.displayName\",u),c={};if(br().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=a;else{if(!br().toLowerCase().match(/android/))return te(new Zr(\"operation-not-supported-in-this-environment\"));c.apn=a}s&&(c.appDisplayName=s),i=Bu(i),c.sessionId=i;var h=Vs(t.l,t.i,t.m,e,n,null,r,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(_u,o.w(),e)}).then(function(){var e=wr(\"cordova.plugins.browsertab.isAvailable\",u);if(\"function\"!==typeof e)throw new Zr(\"invalid-cordova-configuration\");var n=null;e(function(e){if(e){if(\"function\"!==typeof(n=wr(\"cordova.plugins.browsertab.openUrl\",u)))throw new Zr(\"invalid-cordova-configuration\");n(h)}else{if(\"function\"!==typeof(n=wr(\"cordova.InAppBrowser.open\",u)))throw new Zr(\"invalid-cordova-configuration\");e=br(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\\d/i)?\"_blank\":\"_system\",\"location=yes\")}})})}(r,t,e,n)}).then(function(){return new Gt(function(t,e){a=function(){var e=wr(\"cordova.plugins.browsertab.close\",u);return t(),\"function\"===typeof e&&e(),r.a&&\"function\"===typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(a),s=function(){o||(o=fn(2e3).then(function(){e(new Zr(\"redirect-cancelled-by-user\"))}))},c=function(){Mr()&&s()},i.addEventListener(\"resume\",s,!1),br().toLowerCase().match(/android/)||i.addEventListener(\"visibilitychange\",c,!1)}).s(function(t){return Qu(r).then(function(){throw t})})}).ia(function(){s&&i.removeEventListener(\"resume\",s,!1),c&&i.removeEventListener(\"visibilitychange\",c,!1),o&&o.cancel(),a&&r.La(a),r.c=null})},e.wa=function(t){this.b.push(t),Ku(this).s(function(e){\"auth/invalid-cordova-configuration\"===e.code&&(e=new yo(\"unknown\",null,null,null,new Zr(\"no-auth-event\")),t(e))})},e.La=function(t){W(this.b,function(e){return e==t})};var Gu={name:\"pendingRedirect\",B:\"session\"};function zu(t){return Tu(t.b,Gu,t.a)}function Hu(t,e,n){this.i={},this.u=0,this.A=t,this.l=e,this.o=n,this.h=[],this.f=!1,this.m=S(this.cb,this),this.b=new ic,this.v=new uc,this.g=new Wu(this.l+\":\"+this.o),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=Yu(this.A,this.l,this.o,wi)}function Yu(t,e,n,i){var o=r.a.SDK_VERSION||null;return cr()?new Fu(t,e,n,o,i):new Ps(t,e,n,o,i)}function Xu(t){t.f||(t.f=!0,t.a.wa(t.m));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function Ju(t){t.a.Mb()&&Xu(t).s(function(e){var n=new yo(\"unknown\",null,null,null,new Zr(\"operation-not-supported-in-this-environment\"));ec(e)&&t.cb(n)}),t.a.Hb()||oc(t.b)}(e=Hu.prototype).reset=function(){this.f=!1,this.a.La(this.m),this.a=Yu(this.A,this.l,this.o),this.i={}},e.Za=function(){this.b.Za()},e.subscribe=function(t){if(K(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(Gu,t.a).then(function(t){return\"pending\"==t})})(this.g).then(function(t){t?zu(e.g).then(function(){Xu(e).s(function(t){var n=new yo(\"unknown\",null,null,null,new Zr(\"operation-not-supported-in-this-environment\"));ec(t)&&e.cb(n)})}):Ju(e)}).s(function(){Ju(e)})}},e.unsubscribe=function(t){W(this.h,function(e){return e==t})},e.cb=function(t){if(!t)throw new Zr(\"invalid-auth-event\");if(6e5<=_()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=_())),e=!0;break}}return oc(this.b),e};var $u=new Rr(2e3,1e4),Zu=new Rr(3e4,6e4);function tc(t,e,n,r,i,o){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.m))},function(){t.reset()},i,o)}function ec(t){return!(!t||\"auth/cordova-not-ready\"!=t.code)}Hu.prototype.fa=function(){return this.b.fa()},Hu.prototype.Ca=function(t,e,n){var r,i=this;return function(t){return t.b.set(Gu,\"pending\",t.a)}(this.g).then(function(){return i.a.Ca(t,e,n).s(function(t){if(ec(t))throw new Zr(\"operation-not-supported-in-this-environment\");return r=t,zu(i.g).then(function(){throw r})}).then(function(){return i.a.Ob()?new Gt(function(){}):zu(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},Hu.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},$u.get())};var nc={};function rc(t,e,n){var r=e+\":\"+n;return nc[r]||(nc[r]=new Hu(t,e,n)),nc[r]}function ic(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function oc(t){t.g||(t.g=!0,sc(t,!1,null,null))}function ac(t,e){if(t.b=function(){return Zt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function sc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return te(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):ac(t,n):ac(t,{user:null}),t.f=[],t.c=[]}function uc(){}function cc(){this.ub=!1,Object.defineProperty(this,\"appVerificationDisabled\",{get:function(){return this.ub},set:function(t){this.ub=t},enumerable:!1})}function hc(t,e){this.a=e,Ur(this,\"verificationId\",t)}function lc(t,e,n,r){return new lo(t).Va(e,n).then(function(t){return new hc(t,r)})}function fc(t){var e=bi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Zr(\"internal-error\",\"An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.\");Br(this,{token:t,expirationTime:Pr(1e3*e.exp),authTime:Pr(1e3*e.auth_time),issuedAtTime:Pr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function pc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error(\"Proactive refresh lower bound greater than upper bound!\")}function dc(t){this.f=t,this.b=this.a=null,this.c=0}function mc(t,e){var n=e[Na],r=e.refreshToken;e=yc(e.expiresIn),t.b=n,t.c=e,t.a=r}function yc(t){return _()+1e3*parseInt(t,10)}function gc(t,e){return function(t,e){return new Gt(function(n,r){\"refresh_token\"==e.grant_type&&e.refresh_token||\"authorization_code\"==e.grant_type&&e.code?La(t,t.i+\"?key=\"+encodeURIComponent(t.b),function(t){t?t.error?r(Cs(t)):t.access_token&&t.refresh_token?n(t):r(new Zr(\"internal-error\")):r(new Zr(\"network-request-failed\"))},\"POST\",qn(e).toString(),t.f,t.m.get()):r(new Zr(\"internal-error\"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=yc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw\"auth/user-token-expired\"==e.code&&(t.a=null),e})}function vc(t,e){this.a=t||null,this.b=e||null,Br(this,{lastSignInTime:Pr(e||null),creationTime:Pr(t||null)})}function bc(t,e,n,r,i,o){Br(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function wc(t,e){for(var n in xe.call(this,t),e)this[n]=e[n]}function Ec(t,e,n){this.G=[],this.l=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=r.a.SDK_VERSION?vr(r.a.SDK_VERSION):null,this.c=new _a(this.l,Ti(wi),t),this.h=new dc(this.c),Nc(this,e[Na]),mc(this.h,e),Ur(this,\"refreshToken\",this.h.a),Oc(this,n||{}),sn.call(this),this.I=!1,this.u&&Tr()&&(this.a=rc(this.u,this.l,this.o)),this.N=[],this.i=null,this.A=function(t){return new pc(function(){return t.F(!0)},function(t){return!(!t||\"auth/network-request-failed\"!=t.code)},function(){var e=t.h.c-_()-3e5;return 0<e?e:0})}(this),this.V=S(this.Ha,this);var i=this;this.ka=null,this.ta=function(t){i.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){Ic(i,t.c)},this.W=null}function Tc(t,e){t.X&&Je(t.X,\"languageCodeChanged\",t.ta),(t.X=e)&&He(e,\"languageCodeChanged\",t.ta)}function Ic(t,e){t.O=e,Pa(t.c,r.a.SDK_VERSION?vr(r.a.SDK_VERSION,t.O):null)}function Sc(t,e){t.W&&Je(t.W,\"frameworkChanged\",t.sa),(t.W=e)&&He(e,\"frameworkChanged\",t.sa)}function Cc(t){try{return r.a.app(t.o).auth()}catch(e){throw new Zr(\"internal-error\",\"No firebase.auth.Auth instance is available for the Firebase App '\"+t.o+\"'!\")}}function _c(t){t.D||t.A.b||(t.A.start(),Je(t,\"tokenChanged\",t.V),He(t,\"tokenChanged\",t.V))}function Ac(t){Je(t,\"tokenChanged\",t.V),t.A.stop()}function Nc(t,e){t.ra=e,Ur(t,\"_lat\",e)}function Dc(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return ne(e).then(function(){return t})}function kc(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Oc(t,e){Br(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new vc(e.createdAt,e.lastLoginAt),providerData:[]})}function Rc(){}function Mc(t){return Zt().then(function(){if(t.D)throw new Zr(\"app-deleted\")})}function Pc(t){return B(t.providerData,function(t){return t.providerId})}function Lc(t,e){e&&(xc(t,e.providerId),t.providerData.push(e))}function xc(t,e){W(t.providerData,function(t){return t.providerId==e})}function qc(t,e,n){(\"uid\"!=e||n)&&t.hasOwnProperty(e)&&Ur(t,e,n)}function Vc(t,e){t!=e&&(Br(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Ur(t,\"metadata\",function(t){return new vc(t.a,t.b)}(e.metadata)):Ur(t,\"metadata\",new vc),U(e.providerData,function(e){Lc(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Ur(t,\"refreshToken\",t.h.a))}function Fc(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return Is(t.c,is,{idToken:e}).then(S(t.wc,t))}(t,e).then(function(){return n||qc(t,\"isAnonymous\",!1),e})})}function Uc(t,e){e[Na]&&t.ra!=e[Na]&&(mc(t.h,e),t.dispatchEvent(new wc(\"tokenChanged\")),Nc(t,e[Na]),qc(t,\"refreshToken\",t.h.a))}function Bc(t,e){return Fc(t).then(function(){if(K(Pc(t),e))return Dc(t).then(function(){throw new Zr(\"provider-already-linked\")})})}function jc(t,e,n){return jr({user:t,credential:po(e),additionalUserInfo:e=Ai(e),operationType:n})}function Kc(t,e){return Uc(t,e),t.reload().then(function(){return t})}function Qc(t,e,n,i,o){if(!Tr())return te(new Zr(\"operation-not-supported-in-this-environment\"));if(t.i&&!o)return te(t.i);var a=_i(n.providerId),s=Dr(t.uid+\":::\"),u=null;(!Cr()||hr())&&t.u&&n.isOAuthProvider&&(u=Vs(t.u,t.l,t.o,e,n,null,s,r.a.SDK_VERSION||null));var c=or(u,a&&a.Ba,a&&a.Aa);return i=i().then(function(){if(Gc(t),!o)return t.F().then(function(){})}).then(function(){return tc(t.a,c,e,n,s,!!u)}).then(function(){return new Gt(function(n,r){t.ha(e,null,new Zr(\"cancelled-popup-request\"),t.g||null),t.f=n,t.v=r,t.g=s,t.b=t.a.Ea(t,e,c,s)})}).then(function(t){return c&&ir(c),t?jr(t):null}).s(function(t){throw c&&ir(c),t}),zc(t,i,o)}function Wc(t,e,n,r,i){if(!Tr())return te(new Zr(\"operation-not-supported-in-this-environment\"));if(t.i&&!i)return te(t.i);var o=null,a=Dr(t.uid+\":::\");return r=r().then(function(){if(Gc(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,Dc(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(Xc,t.w(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return Jc(t.ba);throw o}).then(function(){if(o)throw o}),zc(t,r,i)}function Gc(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Zr(\"internal-error\");throw new Zr(\"auth-domain-config-required\")}}function zc(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),te(t.i)):e.s(function(e){throw!e||\"auth/user-disabled\"!=e.code&&\"auth/user-token-expired\"!=e.code||(t.i||t.dispatchEvent(new wc(\"userInvalidated\")),t.i=e),e})}(t,e,n);return t.G.push(r),r.ia(function(){Q(t.G,r)}),r}function Hc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[Na]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-_())/1e3;var r=new Ec(e,n,t);return t.providerData&&U(t.providerData,function(t){t&&Lc(r,jr(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function Yc(t){this.a=t,this.b=bu()}ic.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},ic.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&\"auth/web-storage-unsupported\"==t.a.code,o=t.a&&\"auth/operation-not-supported-in-this-environment\"==t.a.code;this.i=!(!i&&!o),\"unknown\"!=n||i||o?t.a?(sc(this,!0,null,t.a),Zt()):e.xa(n,r)?function(t,e,n){n=n.xa(e.c,e.b);var r=e.g,i=e.f,o=e.h,a=!!e.c.match(/Redirect$/);n(r,i,o).then(function(e){sc(t,a,e,null)}).s(function(e){sc(t,a,null,e)})}(this,t,e):te(new Zr(\"invalid-auth-event\")):(sc(this,!1,null,null),Zt())}else te(new Zr(\"invalid-auth-event\"))},ic.prototype.Za=function(){this.g&&!this.i&&sc(this,!1,null,null)},ic.prototype.fa=function(){var t=this;return new Gt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Zr(\"timeout\");t.a&&t.a.cancel(),t.a=fn(Zu.get()).then(function(){t.b||(t.g=!0,sc(t,!0,null,e))})}(t))})},uc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ha(t.c,null,t.a,t.b),Zt()):e.xa(n,r)?function(t,e){var n=t.b,r=t.c;e.xa(r,n)(t.g,t.f,t.h).then(function(t){e.ha(r,t,null,n)}).s(function(t){e.ha(r,null,t,n)})}(t,e):te(new Zr(\"invalid-auth-event\"))}else te(new Zr(\"invalid-auth-event\"))},hc.prototype.confirm=function(t){return t=fo(this.verificationId,t),this.a(t)},pc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=fn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return function(){var t=u.document,e=null;return Mr()||!t?Zt():new Gt(function(n){e=function(){Mr()&&(t.removeEventListener(\"visibilitychange\",e,!1),n())},t.addEventListener(\"visibilitychange\",e,!1)}).s(function(n){throw t.removeEventListener(\"visibilitychange\",e,!1),n})}()}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},pc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},dc.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},dc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?te(new Zr(\"user-token-expired\")):t||!this.b||_()>this.c-3e4?this.a?gc(this,{grant_type:\"refresh_token\",refresh_token:this.a}):Zt(null):Zt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},vc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},A(wc,xe),A(Ec,sn),Ec.prototype.pa=function(t){this.ka=t,Ma(this.c,t)},Ec.prototype.ea=function(){return this.ka},Ec.prototype.ya=function(){return z(this.O)},Ec.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},Ur(Ec.prototype,\"providerId\",\"firebase\"),(e=Ec.prototype).reload=function(){var t=this;return zc(this,Mc(this).then(function(){return Fc(t).then(function(){return Dc(t)}).then(Rc)}))},e.ac=function(t){return this.F(t).then(function(t){return new fc(t)})},e.F=function(t){var e=this;return zc(this,Mc(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Zr(\"internal-error\");return t.accessToken!=e.ra&&(Nc(e,t.accessToken),e.dispatchEvent(new wc(\"tokenChanged\"))),qc(e,\"refreshToken\",t.refreshToken),t.accessToken}))},e.wc=function(t){if(!(t=t.users)||!t.length)throw new Zr(\"internal-error\");Oc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?B(t,function(t){return new bc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Lc(this,e[n]);qc(this,\"isAnonymous\",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length))},e.xc=function(t){return Vr(\"firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead.\"),this.hb(t)},e.hb=function(t){var e=this,n=null;return zc(this,t.f(this.c,this.uid).then(function(t){return Uc(e,t),n=jc(e,t,\"reauthenticate\"),e.i=null,e.reload()}).then(function(){return n}),!0)},e.oc=function(t){return Vr(\"firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead.\"),this.fb(t)},e.fb=function(t){var e=this,n=null;return zc(this,Bc(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=jc(e,t,\"link\"),Kc(e,t)}).then(function(){return n}))},e.pc=function(t,e){var n=this;return zc(this,Bc(this,\"phone\").then(function(){return lc(Cc(n),t,e,S(n.fb,n))}))},e.yc=function(t,e){var n=this;return zc(this,Zt().then(function(){return lc(Cc(n),t,e,S(n.hb,n))}),!0)},e.rb=function(t){var e=this;return zc(this,this.F().then(function(n){return e.c.rb(n,t)}).then(function(t){return Uc(e,t),e.reload()}))},e.Pc=function(t){var e=this;return zc(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return Uc(e,t),e.reload()}))},e.sb=function(t){var e=this;return zc(this,this.F().then(function(n){return e.c.sb(n,t)}).then(function(t){return Uc(e,t),e.reload()}))},e.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Mc(this);var e=this;return zc(this,this.F().then(function(n){return e.c.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Uc(e,t),qc(e,\"displayName\",t.displayName||null),qc(e,\"photoURL\",t.photoUrl||null),U(e.providerData,function(t){\"password\"===t.providerId&&(Ur(t,\"displayName\",e.displayName),Ur(t,\"photoURL\",e.photoURL))}),Dc(e)}).then(Rc))},e.Nc=function(t){var e=this;return zc(this,Fc(this).then(function(n){return K(Pc(e),t)?function(t,e,n){return Is(t,es,{idToken:e,deleteProvider:n})}(e.c,n,[t]).then(function(t){var n={};return U(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),U(Pc(e),function(t){n[t]||xc(e,t)}),n[lo.PROVIDER_ID]||Ur(e,\"phoneNumber\",null),Dc(e)}):Dc(e).then(function(){throw new Zr(\"no-such-provider\")})}))},e.delete=function(){var t=this;return zc(this,this.F().then(function(e){return Is(t.c,ts,{idToken:e})}).then(function(){t.dispatchEvent(new wc(\"userDeleted\"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel(\"app-deleted\");Tc(t,null),Sc(t,null),t.G=[],t.D=!0,Ac(t),Ur(t,\"refreshToken\",null),t.a&&t.a.unsubscribe(t)})},e.xb=function(t,e){return!!(\"linkViaPopup\"==t&&(this.g||null)==e&&this.f||\"reauthViaPopup\"==t&&(this.g||null)==e&&this.f||\"linkViaRedirect\"==t&&(this.aa||null)==e||\"reauthViaRedirect\"==t&&(this.aa||null)==e)},e.ha=function(t,e,n,r){\"linkViaPopup\"!=t&&\"reauthViaPopup\"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},e.xa=function(t,e){return\"linkViaPopup\"==t&&e==(this.g||null)?S(this.Bb,this):\"reauthViaPopup\"==t&&e==(this.g||null)?S(this.Cb,this):\"linkViaRedirect\"==t&&(this.aa||null)==e?S(this.Bb,this):\"reauthViaRedirect\"==t&&(this.aa||null)==e?S(this.Cb,this):null},e.qc=function(t){var e=this;return Qc(this,\"linkViaPopup\",t,function(){return Bc(e,t.providerId).then(function(){return Dc(e)})},!1)},e.zc=function(t){return Qc(this,\"reauthViaPopup\",t,function(){return Zt()},!0)},e.rc=function(t){var e=this;return Wc(this,\"linkViaRedirect\",t,function(){return Bc(e,t.providerId)},!1)},e.Ac=function(t){return Wc(this,\"reauthViaRedirect\",t,function(){return Zt()},!0)},e.Bb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return zc(this,this.F().then(function(i){return za(r.c,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=jc(r,t,\"link\"),Kc(r,t)}).then(function(){return i}))},e.Cb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return zc(this,Zt().then(function(){return Fi(Ha(r.c,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=jc(r,t,\"reauthenticate\"),Uc(r,t),r.i=null,r.reload()}).then(function(){return i}),!0)},e.kb=function(t){var e=this,n=null;return zc(this,this.F().then(function(e){return n=e,\"undefined\"===typeof t||Y(t)?{}:pi(new ri(t))}).then(function(t){return e.c.kb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&$(t,this.metadata.w()),U(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var Xc={name:\"redirectUser\",B:\"session\"};function Jc(t){return Tu(t.b,Xc,t.a)}function $c(t){this.a=t,this.b=bu(),this.c=null,this.f=function(t){var e=eh(\"local\"),n=eh(\"session\"),r=eh(\"none\");return function(t,e,n){var r=Eu(e,n),i=wu(t,e.B);return t.get(e,n).then(function(o){var a=null;try{a=Nr(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&\"localStorage\"!=i.type&&u.localStorage.removeItem(r)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(th,t.a).then(function(t){return t?eh(t):e})})})}).then(function(e){return t.c=e,Zc(t,e.B)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(eh(\"local\"),this.a,S(this.g,this))}function Zc(t,e){var n,r=[];for(n in gu)gu[n]!==e&&r.push(Tu(t.b,eh(gu[n]),t.a));return r.push(Tu(t.b,th,t.a)),function(t){return new Gt(function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)ee(t[s],C(o,s),a);else e(i)})}(r)}$c.prototype.g=function(){var t=this,e=eh(\"local\");oh(this,function(){return Zt().then(function(){return t.c&&\"local\"!=t.c.B?t.b.get(e,t.a):null}).then(function(n){if(n)return Zc(t,\"local\").then(function(){t.c=e})})})};var th={name:\"persistence\",B:\"session\"};function eh(t){return{name:\"authUser\",B:t}}function nh(t,e){return oh(t,function(){return t.b.set(t.c,e.w(),t.a)})}function rh(t){return oh(t,function(){return Tu(t.b,t.c,t.a)})}function ih(t,e){return oh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Hc(t||{})})})}function oh(t,e){return t.f=t.f.then(e,e),t.f}function ah(t){if(this.l=!1,Ur(this,\"settings\",new cc),Ur(this,\"app\",t),!ph(this).options||!ph(this).options.apiKey)throw new Zr(\"invalid-api-key\");t=r.a.SDK_VERSION?vr(r.a.SDK_VERSION):null,this.c=new _a(ph(this).options&&ph(this).options.apiKey,Ti(wi),t),this.N=[],this.o=[],this.I=[],this.Rb=r.a.INTERNAL.createSubscribe(S(this.kc,this)),this.O=void 0,this.Sb=r.a.INTERNAL.createSubscribe(S(this.mc,this)),lh(this,null),this.h=new $c(ph(this).options.apiKey+\":\"+ph(this).name),this.A=new Yc(ph(this).options.apiKey+\":\"+ph(this).name),this.V=gh(this,function(t){var e=ph(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Xc,t.a).then(function(t){return t&&e&&(t.authDomain=e),Hc(t||{})})}(t.A,ph(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ba=t.A),Jc(t.A)});return gh(t,e)}(t).then(function(){return ih(t.h,e)}).then(function(e){return e?(e.ba=t.A,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then(function(){return nh(t.h,e).then(function(){return e})}).s(function(n){return\"auth/network-request-failed\"==n.code?e:rh(t.h)})):null}).then(function(e){lh(t,e||null)});return gh(t,n)}(this)),this.i=gh(this,function(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.l)return t.ka()}).s(function(){}).then(function(){if(!t.l){t.X=!0;var e=t.h;e.b.addListener(eh(\"local\"),e.a,t.ka)}})}(this)),this.X=!1,this.ka=S(this.Kc,this),this.Ha=S(this.Z,this),this.ra=S(this.Zb,this),this.sa=S(this.ic,this),this.ta=S(this.jc,this),function(t){var e=ph(t).options.authDomain,n=ph(t).options.apiKey;e&&Tr()&&(t.Qb=t.V.then(function(){if(!t.l){if(t.a=rc(e,n,ph(t).name),t.a.subscribe(t),dh(t)&&kc(dh(t)),t.D){kc(t.D);var r=t.D;r.pa(t.ea()),Tc(r,t),Ic(r=t.D,t.G),Sc(r,t),t.D=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=S(this.delete,this),this.INTERNAL.logFramework=S(this.sc,this),this.u=0,sn.call(this),function(t){Object.defineProperty(t,\"lc\",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}(this),this.G=[]}function sh(t){xe.call(this,\"languageCodeChanged\"),this.g=t}function uh(t){xe.call(this,\"frameworkChanged\"),this.c=t}function ch(t){return t.Qb||te(new Zr(\"auth-domain-config-required\"))}function hh(t,e){var n={};return n.apiKey=ph(t).options.apiKey,n.authDomain=ph(t).options.authDomain,n.appName=ph(t).name,t.V.then(function(){return function(t,e,n,r){var i=new Ec(t,e);return n&&(i.ba=n),r&&Ic(i,r),i.reload().then(function(){return i})}(n,e,t.A,t.ya())}).then(function(e){return dh(t)&&e.uid==dh(t).uid?(Vc(dh(t),e),t.Z(e)):(lh(t,e),kc(e),t.Z(e))}).then(function(){yh(t)})}function lh(t,e){dh(t)&&(function(t,e){W(t.N,function(t){return t==e})}(dh(t),t.Ha),Je(dh(t),\"tokenChanged\",t.ra),Je(dh(t),\"userDeleted\",t.sa),Je(dh(t),\"userInvalidated\",t.ta),Ac(dh(t))),e&&(e.N.push(t.Ha),He(e,\"tokenChanged\",t.ra),He(e,\"userDeleted\",t.sa),He(e,\"userInvalidated\",t.ta),0<t.u&&_c(e)),Ur(t,\"currentUser\",e),e&&(e.pa(t.ea()),Tc(e,t),Ic(e,t.G),Sc(e,t))}function fh(t,e){var n=null,r=null;return gh(t,e.then(function(e){return n=po(e),r=Ai(e),hh(t,e)}).then(function(){return jr({user:dh(t),credential:n,additionalUserInfo:r,operationType:\"signIn\"})}))}function ph(t){return t.app}function dh(t){return t.currentUser}function mh(t){return dh(t)&&dh(t)._lat||null}function yh(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](mh(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](mh(t))}}function gh(t,e){return t.N.push(e),e.ia(function(){Q(t.N,e)}),e}function vh(){}function bh(){this.a={},this.b=1e12}$c.prototype.nb=function(t){var e=null,n=this;return function(t){var e=new Zr(\"invalid-persistence-type\"),n=new Zr(\"unsupported-persistence-type\");t:{for(r in gu)if(gu[r]==t){var r=!0;break t}r=!1}if(!r||\"string\"!==typeof t)throw e;switch(fr()){case\"ReactNative\":if(\"session\"===t)throw n;break;case\"Node\":if(\"none\"!==t)throw n;break;default:if(!Er()&&\"none\"!==t)throw n}}(t),oh(this,function(){return t!=n.c.B?n.b.get(n.c,n.a).then(function(r){return e=r,Zc(n,t)}).then(function(){if(n.c=eh(t),e)return n.b.set(n.c,e,n.a)}):Zt()})},A(ah,sn),A(sh,xe),A(uh,xe),(e=ah.prototype).nb=function(t){return gh(this,t=this.h.nb(t))},e.pa=function(t){this.W===t||this.l||(this.W=t,Ma(this.c,this.W),this.dispatchEvent(new sh(this.ea())))},e.ea=function(){return this.W},e.Qc=function(){var t=u.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.sc=function(t){this.G.push(t),Pa(this.c,r.a.SDK_VERSION?vr(r.a.SDK_VERSION,this.G):null),this.dispatchEvent(new uh(this.G))},e.ya=function(){return z(this.G)},e.toJSON=function(){return{apiKey:ph(this).options.apiKey,authDomain:ph(this).options.authDomain,appName:ph(this).name,currentUser:dh(this)&&dh(this).w()}},e.xb=function(t,e){switch(t){case\"unknown\":case\"signInViaRedirect\":return!0;case\"signInViaPopup\":return this.g==e&&!!this.f;default:return!1}},e.ha=function(t,e,n,r){\"signInViaPopup\"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},e.xa=function(t,e){return\"signInViaRedirect\"==t||\"signInViaPopup\"==t&&this.g==e&&this.f?S(this.Yb,this):null},e.Yb=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var i=null,o=null,a=Ga(r.c,t).then(function(t){return i=po(t),o=Ai(t),t});return gh(this,t=r.V.then(function(){return a}).then(function(t){return hh(r,t)}).then(function(){return jr({user:dh(r),credential:i,additionalUserInfo:o,operationType:\"signIn\"})}))},e.Ic=function(t){if(!Tr())return te(new Zr(\"operation-not-supported-in-this-environment\"));var e=this,n=_i(t.providerId),i=Dr(),o=null;(!Cr()||hr())&&ph(this).options.authDomain&&t.isOAuthProvider&&(o=Vs(ph(this).options.authDomain,ph(this).options.apiKey,ph(this).name,\"signInViaPopup\",t,null,i,r.a.SDK_VERSION||null));var a=or(o,n&&n.Ba,n&&n.Aa);return gh(this,n=ch(this).then(function(e){return tc(e,a,\"signInViaPopup\",t,i,!!o)}).then(function(){return new Gt(function(t,n){e.ha(\"signInViaPopup\",null,new Zr(\"cancelled-popup-request\"),e.g),e.f=t,e.v=n,e.g=i,e.b=e.a.Ea(e,\"signInViaPopup\",a,i)})}).then(function(t){return a&&ir(a),t?jr(t):null}).s(function(t){throw a&&ir(a),t}))},e.Jc=function(t){if(!Tr())return te(new Zr(\"operation-not-supported-in-this-environment\"));var e=this;return gh(this,ch(this).then(function(){return function(t){return oh(t,function(){return t.b.set(th,t.c.B,t.a)})}(e.h)}).then(function(){return e.a.Ca(\"signInViaRedirect\",t)}))},e.fa=function(){if(!Tr())return te(new Zr(\"operation-not-supported-in-this-environment\"));var t=this;return gh(this,ch(this).then(function(){return t.a.fa()}).then(function(t){return t?jr(t):null}))},e.Oc=function(t){if(!t)return te(new Zr(\"null-user\"));var e=this,n={};n.apiKey=ph(this).options.apiKey,n.authDomain=ph(this).options.authDomain,n.appName=ph(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[Na]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-_())/1e3,e=new Ec(e,o),n&&(e.ba=n),r&&Ic(e,r),Vc(e,t),e}(t,n,e.A,e.ya());return gh(this,this.i.then(function(){if(ph(e).options.apiKey!=t.l)return r.reload()}).then(function(){return dh(e)&&t.uid==dh(e).uid?(Vc(dh(e),t),e.Z(t)):(lh(e,r),kc(r),e.Z(r))}).then(function(){yh(e)}))},e.pb=function(){var t=this;return gh(this,this.i.then(function(){return dh(t)?(lh(t,null),rh(t.h).then(function(){yh(t)})):Zt()}))},e.Kc=function(){var t=this;return ih(this.h,ph(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=dh(t)&&e){n=dh(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&\"\"!==n&&void 0!==r&&null!==r&&\"\"!==r&&n==r}if(n)return Vc(dh(t),e),dh(t).F();(dh(t)||e)&&(lh(t,e),e&&(kc(e),e.ba=t.A),t.a&&t.a.subscribe(t),yh(t))}})},e.Z=function(t){return nh(this.h,t)},e.Zb=function(){yh(this),this.Z(dh(this))},e.ic=function(){this.pb()},e.jc=function(){this.pb()},e.kc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(dh(e))})},e.mc=function(t){var e=this;!function(t,e){t.I.push(e),gh(t,t.i.then(function(){!t.l&&K(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(mh(t)))}))}(this,function(){t.next(dh(e))})},e.uc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){v(t)?t(dh(r)):v(t.next)&&t.next(dh(r))}),this.Rb(t,e,n)},e.tc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){r.O=r.getUid(),v(t)?t(dh(r)):v(t.next)&&t.next(dh(r))}),this.Sb(t,e,n)},e.$b=function(t){var e=this;return gh(this,this.i.then(function(){return dh(e)?dh(e).F(t).then(function(t){return{accessToken:t}}):null}))},e.Ec=function(t){var e=this;return this.i.then(function(){return fh(e,Is(e.c,vs,{token:t}))}).then(function(t){var n=t.user;return qc(n,\"isAnonymous\",!1),e.Z(n),t})},e.Fc=function(t,e){var n=this;return this.i.then(function(){return fh(n,Is(n.c,bs,{email:t,password:e}))})},e.Ub=function(t,e){var n=this;return this.i.then(function(){return fh(n,Is(n.c,$a,{email:t,password:e}))})},e.Ra=function(t){var e=this;return this.i.then(function(){return fh(e,t.la(e.c))})},e.Dc=function(t){return Vr(\"firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead.\"),this.Ra(t)},e.ob=function(){var t=this;return this.i.then(function(){var e=dh(t);if(e&&e.isAnonymous){var n=jr({providerId:null,isNewUser:!1});return jr({user:e,credential:null,additionalUserInfo:n,operationType:\"signIn\"})}return fh(t,t.c.ob()).then(function(e){var n=e.user;return qc(n,\"isAnonymous\",!0),t.Z(n),e})})},e.getUid=function(){return dh(this)&&dh(this).uid||null},e.Tb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&dh(this)&&_c(dh(this))},e.Bc=function(t){var e=this;U(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&dh(this)&&Ac(dh(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.o.push(t),gh(this,this.i.then(function(){e.l||K(e.o,t)&&t(mh(e))}))},e.removeAuthTokenListener=function(t){W(this.o,function(e){return e==t})},e.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel(\"app-deleted\");return this.N=[],this.h&&(t=this.h).b.removeListener(eh(\"local\"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Za()),Promise.resolve()},e.Xb=function(t){return gh(this,function(t,e){return Is(t,Za,{identifier:e,continueUri:Ir()?er():\"http://localhost\"}).then(function(t){return t.signinMethods||[]})}(this.c,t))},e.nc=function(t){return!!so(t)},e.mb=function(t,e){var n=this;return gh(this,Zt().then(function(){var t=new ri(e);if(!t.c)throw new Zr(\"argument-error\",ai+\" must be true when sending sign in link to email\");return pi(t)}).then(function(e){return n.c.mb(t,e)}).then(function(){}))},e.Rc=function(t){return this.Ka(t).then(function(t){return t.data.email})},e.$a=function(t,e){return gh(this,this.c.$a(t,e).then(function(){}))},e.Ka=function(t){return gh(this,this.c.Ka(t).then(function(t){return new Qr(t)}))},e.Xa=function(t){return gh(this,this.c.Xa(t).then(function(){}))},e.lb=function(t,e){var n=this;return gh(this,Zt().then(function(){return\"undefined\"===typeof e||Y(e)?{}:pi(new ri(e))}).then(function(e){return n.c.lb(t,e)}).then(function(){}))},e.Hc=function(t,e){return gh(this,lc(this,t,e,S(this.Ra,this)))},e.Gc=function(t,e){var n=this;return gh(this,Zt().then(function(){var r=ao(t,e||er());return n.Ra(r)}))},vh.prototype.render=function(){},vh.prototype.reset=function(){},vh.prototype.getResponse=function(){},vh.prototype.execute=function(){};var wh=null;function Eh(t,e){return(e=Th(e))&&t.a[e]||null}function Th(t){return(t=\"undefined\"===typeof t?1e12:t)?t.toString():null}function Ih(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h=\"invisible\"!==this.c.size,this.f=Qn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():He(this.f,\"click\",this.i)}function Sh(t){if(t.g)throw Error(\"reCAPTCHA mock was already deleted!\")}function Ch(){}bh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Ih(t,e),this.b++},bh.prototype.reset=function(t){var e=Eh(this,t);t=Th(t),e&&t&&(e.delete(),delete this.a[t])},bh.prototype.getResponse=function(t){return(t=Eh(this,t))?t.getResponse():null},bh.prototype.execute=function(t){(t=Eh(this,t))&&t.execute()},Ih.prototype.getResponse=function(){return Sh(this),this.b},Ih.prototype.execute=function(){Sh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),t--;return e.join(\"\")}();var e=t.c.callback,n=t.c[\"expired-callback\"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()},6e4)},500))},Ih.prototype.delete=function(){Sh(this),this.g=!0,clearTimeout(this.a),this.a=null,Je(this.f,\"click\",this.i)},Ch.prototype.g=function(){return wh||(wh=new bh),Zt(wh)},Ch.prototype.c=function(){};var _h=null;function Ah(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a=\"__rcb\"+Math.floor(1e6*Math.random()).toString()}var Nh=new Z(nt,\"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}\"),Dh=new Rr(3e4,6e4);Ah.prototype.g=function(t){var e=this;return new Gt(function(n,r){var i=setTimeout(function(){r(new Zr(\"network-request-failed\"))},Dh.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new Zr(\"internal-error\"));delete u[e.a]},Zt(ba(at(Nh,{onload:e.a,hl:t||\"\"}))).s(function(){clearTimeout(i),r(new Zr(\"internal-error\",\"Unable to load external reCAPTCHA dependencies!\"))})):(clearTimeout(i),n(u.grecaptcha))})},Ah.prototype.c=function(){this.b--};var kh=null;function Oh(t,e,n,r,i,o,a){if(Ur(this,\"type\",\"recaptcha\"),this.c=this.f=null,this.D=!1,this.l=e,this.g=null,a?(_h||(_h=new Ch),a=_h):(kh||(kh=new Ah),a=kh),this.o=a,this.a=n||{theme:\"light\",type:\"image\"},this.h=[],this.a[Ph])throw new Zr(\"argument-error\",\"sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.\");if(this.i=\"invisible\"===this.a[Lh],!u.document)throw new Zr(\"operation-not-supported-in-this-environment\",\"RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.\");if(!Qn(e)||!this.i&&Qn(e).hasChildNodes())throw new Zr(\"argument-error\",\"reCAPTCHA container is either not found or already contains inner elements!\");this.u=new _a(t,o||null,i||null),this.v=r||function(){return null};var s=this;this.m=[];var c=this.a[Rh];this.a[Rh]=function(t){if(xh(s,t),\"function\"===typeof c)c(t);else if(\"string\"===typeof c){var e=wr(c,u);\"function\"===typeof e&&e(t)}};var h=this.a[Mh];this.a[Mh]=function(){if(xh(s,null),\"function\"===typeof h)h();else if(\"string\"===typeof h){var t=wr(h,u);\"function\"===typeof t&&t()}}}var Rh=\"callback\",Mh=\"expired-callback\",Ph=\"sitekey\",Lh=\"size\";function xh(t,e){for(var n=0;n<t.m.length;n++)try{t.m[n](e)}catch(r){}}function qh(t,e){return t.h.push(e),e.ia(function(){Q(t.h,e)}),e}function Vh(t){if(t.D)throw new Zr(\"internal-error\",\"RecaptchaVerifier instance has been destroyed.\")}function Fh(t,e,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new Zr(\"argument-error\",\"No firebase.app.App instance is currently initialized.\")}if(!this.b.options||!this.b.options.apiKey)throw new Zr(\"invalid-api-key\");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().ya()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?vr(r.a.SDK_VERSION,a):null,Oh.call(this,n,t,e,function(){try{var t=o.b.auth().ea()}catch(e){t=null}return t},a,Ti(wi),i)}function Uh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Zr(\"internal-error\",\"Argument validator encountered a required argument after an optional argument.\");i++}if(o=e.length,n.length<i||o<n.length)r=\"Expected \"+(i==o?1==i?\"1 argument\":i+\" arguments\":i+\"-\"+o+\" arguments\")+\" but got \"+n.length+\".\";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Bh.length)throw new Zr(\"internal-error\",\"Argument validator received an unsupported number of arguments.\");n=Bh[i],r=(r?\"\":n+\" argument \")+(e.name?'\"'+e.name+'\" ':\"\")+\"must be \"+e.K+\".\";break t}r=null}}if(r)throw new Zr(\"argument-error\",t+\" failed: \"+r)}(e=Oh.prototype).za=function(){var t=this;return this.f?this.f:this.f=qh(this,Zt().then(function(){if(Ir()&&!lr())return ur();throw new Zr(\"operation-not-supported-in-this-environment\",\"RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.\")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,Is(t.u,cs,{})}).then(function(e){t.a[Ph]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},e.render=function(){Vh(this);var t=this;return qh(this,this.za().then(function(){if(null===t.c){var e=t.l;if(!t.i){var n=Qn(e);e=zn(\"DIV\"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},e.verify=function(){Vh(this);var t=this;return qh(this,this.render().then(function(e){return new Gt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){W(t.m,function(t){return t==e})}(t,i),n(e))};t.m.push(i),t.i&&t.g.execute(t.c)}})}))},e.reset=function(){Vh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Vh(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel(\"RecaptchaVerifier instance has been destroyed.\");if(!this.i){t=Qn(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},A(Fh,Oh);var Bh=\"First Second Third Fourth Fifth Sixth Seventh Eighth Ninth\".split(\" \");function jh(t,e){return{name:t||\"\",K:\"a valid string\",optional:!!e,M:c}}function Kh(t,e){return{name:t||\"\",K:\"a boolean\",optional:!!e,M:h}}function Qh(t,e){return{name:t||\"\",K:\"a valid object\",optional:!!e,M:b}}function Wh(t,e){return{name:t||\"\",K:\"a function\",optional:!!e,M:v}}function Gh(t,e){return{name:t||\"\",K:\"null\",optional:!!e,M:m}}function zh(t){return{name:t?t+\"Credential\":\"credential\",K:t?\"a valid \"+t+\" credential\":\"a valid credential\",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function Hh(){return{name:\"applicationVerifier\",K:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,M:function(t){return!!(t&&c(t.type)&&v(t.verify))}}}function Yh(t,e,n,r){return{name:n||\"\",K:t.K+\" or \"+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Xh(t,e){for(var n in e){var r=e[n].name;t[r]=Zh(r,t[n],e[n].j)}}function Jh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:C(function(t){return this[t]},n),set:C(function(t,e,n,r){Uh(t,[n],[r],!0),this[e]=r},r,n,e[n].vb),enumerable:!0})}}function $h(t,e,n,r){t[e]=Zh(e,n,r)}function Zh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Uh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split(\".\"))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Xh(ah.prototype,{Xa:{name:\"applyActionCode\",j:[jh(\"code\")]},Ka:{name:\"checkActionCode\",j:[jh(\"code\")]},$a:{name:\"confirmPasswordReset\",j:[jh(\"code\"),jh(\"newPassword\")]},Ub:{name:\"createUserWithEmailAndPassword\",j:[jh(\"email\"),jh(\"password\")]},Xb:{name:\"fetchSignInMethodsForEmail\",j:[jh(\"email\")]},fa:{name:\"getRedirectResult\",j:[]},nc:{name:\"isSignInWithEmailLink\",j:[jh(\"emailLink\")]},tc:{name:\"onAuthStateChanged\",j:[Yh(Qh(),Wh(),\"nextOrObserver\"),Wh(\"opt_error\",!0),Wh(\"opt_completed\",!0)]},uc:{name:\"onIdTokenChanged\",j:[Yh(Qh(),Wh(),\"nextOrObserver\"),Wh(\"opt_error\",!0),Wh(\"opt_completed\",!0)]},lb:{name:\"sendPasswordResetEmail\",j:[jh(\"email\"),Yh(Qh(\"opt_actionCodeSettings\",!0),Gh(null,!0),\"opt_actionCodeSettings\",!0)]},mb:{name:\"sendSignInLinkToEmail\",j:[jh(\"email\"),Qh(\"actionCodeSettings\")]},nb:{name:\"setPersistence\",j:[jh(\"persistence\")]},Dc:{name:\"signInAndRetrieveDataWithCredential\",j:[zh()]},ob:{name:\"signInAnonymously\",j:[]},Ra:{name:\"signInWithCredential\",j:[zh()]},Ec:{name:\"signInWithCustomToken\",j:[jh(\"token\")]},Fc:{name:\"signInWithEmailAndPassword\",j:[jh(\"email\"),jh(\"password\")]},Gc:{name:\"signInWithEmailLink\",j:[jh(\"email\"),jh(\"emailLink\",!0)]},Hc:{name:\"signInWithPhoneNumber\",j:[jh(\"phoneNumber\"),Hh()]},Ic:{name:\"signInWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},Jc:{name:\"signInWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},Oc:{name:\"updateCurrentUser\",j:[Yh({name:\"user\",K:\"an instance of Firebase User\",optional:!1,M:function(t){return!!(t&&t instanceof Ec)}},Gh(),\"user\")]},pb:{name:\"signOut\",j:[]},toJSON:{name:\"toJSON\",j:[jh(null,!0)]},Qc:{name:\"useDeviceLanguage\",j:[]},Rc:{name:\"verifyPasswordResetCode\",j:[jh(\"code\")]}}),Jh(ah.prototype,{lc:{name:\"languageCode\",vb:Yh(jh(),Gh(),\"languageCode\")}}),ah.Persistence=gu,ah.Persistence.LOCAL=\"local\",ah.Persistence.SESSION=\"session\",ah.Persistence.NONE=\"none\",Xh(Ec.prototype,{delete:{name:\"delete\",j:[]},ac:{name:\"getIdTokenResult\",j:[Kh(\"opt_forceRefresh\",!0)]},F:{name:\"getIdToken\",j:[Kh(\"opt_forceRefresh\",!0)]},oc:{name:\"linkAndRetrieveDataWithCredential\",j:[zh()]},fb:{name:\"linkWithCredential\",j:[zh()]},pc:{name:\"linkWithPhoneNumber\",j:[jh(\"phoneNumber\"),Hh()]},qc:{name:\"linkWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},rc:{name:\"linkWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},xc:{name:\"reauthenticateAndRetrieveDataWithCredential\",j:[zh()]},hb:{name:\"reauthenticateWithCredential\",j:[zh()]},yc:{name:\"reauthenticateWithPhoneNumber\",j:[jh(\"phoneNumber\"),Hh()]},zc:{name:\"reauthenticateWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},Ac:{name:\"reauthenticateWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty(\"isOAuthProvider\"))}}]},reload:{name:\"reload\",j:[]},kb:{name:\"sendEmailVerification\",j:[Yh(Qh(\"opt_actionCodeSettings\",!0),Gh(null,!0),\"opt_actionCodeSettings\",!0)]},toJSON:{name:\"toJSON\",j:[jh(null,!0)]},Nc:{name:\"unlink\",j:[jh(\"provider\")]},rb:{name:\"updateEmail\",j:[jh(\"email\")]},sb:{name:\"updatePassword\",j:[jh(\"password\")]},Pc:{name:\"updatePhoneNumber\",j:[zh(\"phone\")]},tb:{name:\"updateProfile\",j:[Qh(\"profile\")]}}),Xh(bh.prototype,{execute:{name:\"execute\"},render:{name:\"render\"},reset:{name:\"reset\"},getResponse:{name:\"getResponse\"}}),Xh(vh.prototype,{execute:{name:\"execute\"},render:{name:\"render\"},reset:{name:\"reset\"},getResponse:{name:\"getResponse\"}}),Xh(Gt.prototype,{ia:{name:\"finally\"},s:{name:\"catch\"},then:{name:\"then\"}}),Jh(cc.prototype,{appVerificationDisabled:{name:\"appVerificationDisabledForTesting\",vb:Kh(\"appVerificationDisabledForTesting\")}}),Xh(hc.prototype,{confirm:{name:\"confirm\",j:[jh(\"verificationCode\")]}}),$h(Vi,\"fromJSON\",function(t){t=c(t)?JSON.parse(t):t;for(var e,n=[Wi,io,co,ji],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[Yh(jh(),Qh(),\"json\")]),$h(oo,\"credential\",function(t,e){return new ro(t,e)},[jh(\"email\"),jh(\"password\")]),Xh(ro.prototype,{w:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(Yi.prototype,{ua:{name:\"addScope\",j:[jh(\"scope\")]},Da:{name:\"setCustomParameters\",j:[Qh(\"customOAuthParameters\")]}}),$h(Yi,\"credential\",Xi,[Yh(jh(),Qh(),\"token\")]),$h(oo,\"credentialWithLink\",ao,[jh(\"email\"),jh(\"emailLink\")]),Xh(Ji.prototype,{ua:{name:\"addScope\",j:[jh(\"scope\")]},Da:{name:\"setCustomParameters\",j:[Qh(\"customOAuthParameters\")]}}),$h(Ji,\"credential\",$i,[Yh(jh(),Qh(),\"token\")]),Xh(Zi.prototype,{ua:{name:\"addScope\",j:[jh(\"scope\")]},Da:{name:\"setCustomParameters\",j:[Qh(\"customOAuthParameters\")]}}),$h(Zi,\"credential\",to,[Yh(jh(),Yh(Qh(),Gh()),\"idToken\"),Yh(jh(),Gh(),\"accessToken\",!0)]),Xh(eo.prototype,{Da:{name:\"setCustomParameters\",j:[Qh(\"customOAuthParameters\")]}}),$h(eo,\"credential\",no,[Yh(jh(),Qh(),\"token\"),jh(\"secret\",!0)]),Xh(Hi.prototype,{ua:{name:\"addScope\",j:[jh(\"scope\")]},credential:{name:\"credential\",j:[Yh(jh(),Yh(Qh(),Gh()),\"optionsOrIdToken\"),Yh(jh(),Gh(),\"accessToken\",!0)]},Da:{name:\"setCustomParameters\",j:[Qh(\"customOAuthParameters\")]}}),Xh(Ki.prototype,{w:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(Ui.prototype,{w:{name:\"toJSON\",j:[jh(null,!0)]}}),$h(lo,\"credential\",fo,[jh(\"verificationId\"),jh(\"verificationCode\")]),Xh(lo.prototype,{Va:{name:\"verifyPhoneNumber\",j:[jh(\"phoneNumber\"),Hh()]}}),Xh(uo.prototype,{w:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(Zr.prototype,{toJSON:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(To.prototype,{toJSON:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(Eo.prototype,{toJSON:{name:\"toJSON\",j:[jh(null,!0)]}}),Xh(Fh.prototype,{clear:{name:\"clear\",j:[]},render:{name:\"render\",j:[]},verify:{name:\"verify\",j:[]}}),function(){if(\"undefined\"===typeof r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerService)throw Error(\"Cannot find the firebase namespace; be sure to include firebase-app.js before this library.\");var t={Auth:ah,AuthCredential:Vi,Error:Zr};$h(t,\"EmailAuthProvider\",oo,[]),$h(t,\"FacebookAuthProvider\",Yi,[]),$h(t,\"GithubAuthProvider\",Ji,[]),$h(t,\"GoogleAuthProvider\",Zi,[]),$h(t,\"TwitterAuthProvider\",eo,[]),$h(t,\"OAuthProvider\",Hi,[jh(\"providerId\")]),$h(t,\"SAMLAuthProvider\",zi,[jh(\"providerId\")]),$h(t,\"PhoneAuthProvider\",lo,[{name:\"auth\",K:\"an instance of Firebase Auth\",optional:!0,M:function(t){return!!(t&&t instanceof ah)}}]),$h(t,\"RecaptchaVerifier\",Fh,[Yh(jh(),{name:\"\",K:\"an HTML element\",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},\"recaptchaContainer\"),Qh(\"recaptchaParameters\",!0),{name:\"app\",K:\"an instance of Firebase App\",optional:!0,M:function(t){return!!(t&&t instanceof r.a.app.App)}}]),r.a.INTERNAL.registerService(\"auth\",function(t,e){return e({INTERNAL:{getUid:S((t=new ah(t)).getUid,t),getToken:S(t.$b,t),addAuthTokenListener:S(t.Tb,t),removeAuthTokenListener:S(t.Bc,t)}}),t},t,function(t,e){if(\"create\"===t)try{e.auth()}catch(n){}}),r.a.INTERNAL.extendNamespace({User:Ec})}()}).apply(\"undefined\"!==typeof t?t:\"undefined\"!==typeof self?self:window)}).call(this,n(\"yLpj\"))},vlRD:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){var t=n(\"RNiq\");return{page:t.default||t}}])},wj3C:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var r,i=n(\"mrSG\"),o=n(\"zVF4\"),a=n(\"q/0M\"),s=((r={})[\"no-app\"]=\"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()\",r[\"bad-app-name\"]=\"Illegal App name: '{$appName}\",r[\"duplicate-app\"]=\"Firebase App named '{$appName}' already exists\",r[\"app-deleted\"]=\"Firebase App named '{$appName}' already deleted\",r[\"duplicate-service\"]=\"Firebase service named '{$appName}' already registered\",r[\"invalid-app-argument\"]=\"firebase.{$appName}() takes either no argument or a Firebase App instance.\",r),u=new o.ErrorFactory(\"app\",\"Firebase\",s),c=\"[DEFAULT]\",h=[],l=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){h.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){h=h.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,\"automaticDataCollectionEnabled\",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"name\",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"options\",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(t.services_[i]);o<a.length;o++){var s=a[o];e.push(t.services_[i][s])}return Promise.all(e.filter(function(t){return\"INTERNAL\"in t}).map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=c),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==c?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;o.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(h.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),h=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create(\"app-deleted\",{appName:this.name_})},t}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log(\"dc\");var f=\"6.3.2\";var p=new a.Logger(\"@firebase/app\");if(o.isBrowser()&&void 0!==self.firebase){p.warn(\"\\n    Warning: Firebase is already defined in the global scope. Please make sure\\n    Firebase library is only loaded once.\\n  \");var d=self.firebase.SDK_VERSION;d&&d.indexOf(\"LITE\")>=0&&p.warn(\"\\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\\n    \")}var m=function t(){var e=function(t){var e={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){if(void 0===r&&(r={}),\"object\"!==typeof r||null===r){var a=r;r={name:a}}var s=r;void 0===s.name&&(s.name=c);var l=s.name;if(\"string\"!==typeof l||!l)throw u.create(\"bad-app-name\",{appName:String(l)});if(o.contains(e,l))throw u.create(\"duplicate-app\",{appName:l});var f=new t(n,s,i);return e[l]=f,h(f,\"create\"),f},app:a,apps:null,SDK_VERSION:f,INTERNAL:{registerService:function(e,c,h,l,f){if(void 0===f&&(f=!1),n[e])throw u.create(\"duplicate-service\",{appName:e});function p(t){if(void 0===t&&(t=a()),\"function\"!==typeof t[e])throw u.create(\"invalid-app-argument\",{appName:e});return t[e]()}return n[e]=c,l&&(r[e]=l,s().forEach(function(t){l(\"create\",t)})),void 0!==h&&o.deepExtend(p,h),i[e]=p,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getService.bind(this,e).apply(this,f?t:[])},p},removeApp:function(t){h(e[t],\"delete\"),delete e[t]},factories:n,useAsService:l}};function a(t){if(t=t||c,!o.contains(e,t))throw u.create(\"no-app\",{appName:t});return e[t]}function s(){return Object.keys(e).map(function(t){return e[t]})}function h(t,e){for(var i=0,o=Object.keys(n);i<o.length;i++){var a=l(0,o[i]);if(null===a)return;r[a]&&r[a](e,t)}}function l(t,e){return\"serverAuth\"===e?null:e}return i.default=i,Object.defineProperty(i,\"apps\",{get:s}),a.App=t,i}(l);return e.INTERNAL=i.__assign({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}(),y=m.initializeApp;m.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.isNode()&&p.warn('\\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\\n      run in a Node environment.  If running in a Node environment, make sure you\\n      are using the bundle specified by the \"main\" field in package.json.\\n      \\n      If you are using Webpack, you can specify \"main\" as the first item in\\n      \"resolve.mainFields\":\\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\\n      \\n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify \"main\"\\n      as the first item in \"mainFields\", e.g. [\\'main\\', \\'module\\'].\\n      https://github.com/rollup/rollup-plugin-node-resolve\\n      '),y.apply(void 0,t)};var g=m;e.default=g,e.firebase=g},x7I3:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"ErrorCode\",function(){return ur}),n.d(e,\"EventType\",function(){return cr}),n.d(e,\"WebChannel\",function(){return hr}),n.d(e,\"XhrIo\",function(){return lr}),n.d(e,\"createWebChannelTransport\",function(){return sr});var r,i=\"undefined\"!==typeof globalThis?globalThis:window,o=o||{},a=i;function s(t){return\"string\"==typeof t}function u(t){return\"number\"==typeof t}function c(t,e){t=t.split(\".\"),e=e||a;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function h(){}function l(t){var e=typeof t;if(\"object\"==e){if(!t)return\"null\";if(t instanceof Array)return\"array\";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if(\"[object Window]\"==n)return\"object\";if(\"[object Array]\"==n||\"number\"==typeof t.length&&\"undefined\"!=typeof t.splice&&\"undefined\"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==n||\"undefined\"!=typeof t.call&&\"undefined\"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"call\"))return\"function\"}else if(\"function\"==e&&\"undefined\"==typeof t.call)return\"object\";return e}function f(t){return\"array\"==l(t)}function p(t){var e=l(t);return\"array\"==e||\"object\"==e&&\"number\"==typeof t.length}function d(t){var e=typeof t;return\"object\"==e&&null!=t||\"function\"==e}var m=\"closure_uid_\"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?g:v).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now||function(){return+new Date};function T(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function I(){this.j=this.j,this.i=this.i}I.prototype.j=!1,I.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[m]||(this[m]=++y)},I.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(\"\"):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function _(t){return Array.prototype.concat.apply([],arguments)}function A(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t){return/^[\\s\\xa0]*$/.test(t)}var D,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var M=a.navigator;if(M){var P=M.userAgent;if(P){D=P;break t}}D=\"\"}function L(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function x(t){var e,n={};for(e in t)n[e]=t[e];return n}var q=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function V(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<q.length;o++)n=q[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function F(t){return F[\" \"](t),t}F[\" \"]=h;var U,B=O(D,\"Opera\"),j=O(D,\"Trident\")||O(D,\"MSIE\"),K=O(D,\"Edge\"),Q=K||j,W=O(D,\"Gecko\")&&!(O(D.toLowerCase(),\"webkit\")&&!O(D,\"Edge\"))&&!(O(D,\"Trident\")||O(D,\"MSIE\"))&&!O(D,\"Edge\"),G=O(D.toLowerCase(),\"webkit\")&&!O(D,\"Edge\");function z(){var t=a.document;return t?t.documentMode:void 0}t:{var H=\"\",Y=function(){var t=D;return W?/rv:([^\\);]+)(\\)|;)/.exec(t):K?/Edge\\/([\\d\\.]+)/.exec(t):j?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(t):G?/WebKit\\/(\\S+)/.exec(t):B?/(?:Version)[ \\/]?(\\S+)/.exec(t):void 0}();if(Y&&(H=Y?Y[1]:\"\"),j){var X=z();if(null!=X&&X>parseFloat(H)){U=String(X);break t}}U=H}var J,$={};function Z(t){return function(t,e){var n=$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=k(String(U)).split(\".\"),r=k(String(t)).split(\".\"),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||\"\",s=r[o]||\"\";do{if(a=/(\\d*)(\\D*)(.*)/.exec(a)||[\"\",\"\",\"\",\"\"],s=/(\\d*)(\\D*)(.*)/.exec(s)||[\"\",\"\",\"\",\"\"],0==a[0].length&&0==s[0].length)break;e=R(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||R(0==a[2].length,0==s[2].length)||R(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var tt=a.document;J=tt&&j?z()||(\"CSS1Compat\"==tt.compatMode?parseInt(U,10):5):void 0;var et=!j||9<=Number(J),nt=j&&!Z(\"9\"),rt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},\"passive\",{get:function(){t=!0}});try{a.addEventListener(\"test\",h,e),a.removeEventListener(\"test\",h,e)}catch(n){}return t}();function it(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function ot(t,e){if(it.call(this,t?t.type:\"\"),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(W){t:{try{F(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else\"mouseover\"==n?e=t.fromElement:\"mouseout\"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||\"\",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:at[t.pointerType]||\"\",this.c=t,t.defaultPrevented&&this.b()}}it.prototype.b=function(){this.Ja=!1},T(ot,it);var at={2:\"touch\",3:\"pen\",4:\"mouse\"};ot.prototype.b=function(){ot.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,nt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var st=\"closure_listenable_\"+(1e6*Math.random()|0),ut=0;function ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ut,this.X=this.Z=!1}function ht(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function lt(t){this.src=t,this.a={},this.b=0}function ft(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=S(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ht(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=pt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new ct(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var dt=\"closure_lm_\"+(1e6*Math.random()|0),mt={};function yt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(f(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}r=St(r);return e&&e[st]?e.Ba(n,r,d(i)?!!i.capture:!!i,o):gt(e,n,r,!0,i,o)}(t,e,n,r,i);if(f(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=St(n),t&&t[st]?t.Aa(e,n,d(r)?!!r.capture:!!r,i):gt(t,e,n,!1,r,i)}function gt(t,e,n,r,i,o){if(!e)throw Error(\"Invalid event type\");var a=d(i)?!!i.capture:!!i;if(a&&!et)return null;var s=Tt(t);if(s||(t[dt]=s=new lt(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Et,e=et?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)rt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(bt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");t.addListener(r)}return n}function vt(t){if(!u(t)&&t&&!t.X){var e=t.src;if(e&&e[st])ft(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(bt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Tt(e))?(ft(n,t),0==n.b&&(n.src=null,e[dt]=null)):ht(t)}}}function bt(t){return t in mt?mt[t]:mt[t]=\"on\"+t}function wt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&vt(t),n.call(r,e)}function Et(t,e){return!!t.X||(et?wt(t,new ot(e,this)):wt(t,e=new ot(e||c(\"window.event\"),this)))}function Tt(t){return(t=t[dt])instanceof lt?t:null}var It=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);function St(t){return\"function\"==l(t)?t:(t[It]||(t[It]=function(e){return t.handleEvent(e)}),t[It])}function Ct(){I.call(this),this.c=new lt(this),this.J=this,this.B=null}function _t(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&ft(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}T(Ct,I),Ct.prototype[st]=!0,(r=Ct.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(f(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=d(i)?!!i.capture:!!i,r=St(r),e&&e[st]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=pt(a=e.a[n],r,i,o))&&(ht(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=Tt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=pt(n,r,i,o)),(r=-1<e?n[e]:null)&&vt(r))}(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(s(t))t=new it(t,n);else if(t instanceof it)t.target=t.target||n;else{var i=t;V(t=new it(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=_t(a,r,!0,t)&&i}if(i=_t(a=t.a=n,r,!0,t)&&i,i=_t(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=_t(a=t.a=e[o],r,!1,t)&&i;return i},r.G=function(){if(Ct.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ht(n[r]);delete e.a[t],e.b--}}this.B=null},r.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},r.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var At=a.JSON.stringify;function Nt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Dt(){this.b=this.a=null}Nt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var kt,Ot=new Nt(function(){return new Mt},function(t){t.reset()});function Rt(){var t=qt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Mt(){this.next=this.b=this.a=null}function Pt(t){a.setTimeout(function(){throw t},0)}function Lt(t,e){kt||function(){var t=a.Promise.resolve(void 0);kt=function(){t.then(Vt)}}(),xt||(kt(),xt=!0),qt.add(t,e)}Dt.prototype.add=function(t,e){var n=Ot.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Mt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var xt=!1,qt=new Dt;function Vt(){for(var t;t=Rt();){try{t.a.call(t.b)}catch(n){Pt(n)}var e=Ot;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}xt=!1}function Ft(t,e){Ct.call(this),this.b=t||1,this.a=e||a,this.f=b(this.gb,this),this.g=E()}function Ut(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Bt(t,e,n){if(\"function\"==l(t))n&&(t=b(t,n));else{if(!t||\"function\"!=typeof t.handleEvent)throw Error(\"Invalid listener argument\");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function jt(t,e,n){I.call(this),this.f=null!=n?b(t,n):t,this.c=e,this.b=b(this.ab,this),this.a=[]}function Kt(t){t.U=Bt(t.b,t.c),t.f.apply(null,t.a)}function Qt(t){I.call(this),this.b=t,this.a={}}T(Ft,Ct),(r=Ft.prototype).ba=!1,r.L=null,r.gb=function(){if(this.ba){var t=E()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent(\"tick\"),this.ba&&(Ut(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=E())},r.G=function(){Ft.N.G.call(this),Ut(this),delete this.a},T(jt,I),(r=jt.prototype).ea=!1,r.U=null,r.Ua=function(t){this.a=arguments,this.U?this.ea=!0:Kt(this)},r.G=function(){jt.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.ab=function(){this.U=null,this.ea&&(this.ea=!1,Kt(this))},T(Qt,I);var Wt=[];function Gt(t,e,n,r){f(n)||(n&&(Wt[0]=n.toString()),n=Wt);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function zt(t){L(t.a,function(t,e){this.a.hasOwnProperty(e)&&vt(t)},t),t.a={}}function Ht(){}Qt.prototype.G=function(){Qt.N.G.call(this),zt(this)},Qt.prototype.handleEvent=function(){throw Error(\"EventHandler.handleEvent not implemented\")};var Yt=new Ct;function Xt(t){it.call(this,\"serverreachability\",t)}function Jt(t){Yt.dispatchEvent(new Xt(Yt,t))}function $t(t){it.call(this,\"statevent\",t)}function Zt(t){Yt.dispatchEvent(new $t(Yt,t))}function te(t){it.call(this,\"timingevent\",t)}function ee(t,e){if(\"function\"!=l(t))throw Error(\"Fn must not be null and must be a function\");return a.setTimeout(function(){t()},e)}T(Xt,it),T($t,it),T(te,it);var ne={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},re={jb:\"complete\",wb:\"success\",Na:\"error\",Ma:\"abort\",ub:\"ready\",vb:\"readystatechange\",TIMEOUT:\"timeout\",qb:\"incrementaldata\",tb:\"progress\",lb:\"downloadprogress\",xb:\"uploadprogress\"};function ie(){}function oe(t){var e;return(e=t.a)||(e=t.a={}),e}function ae(){}ie.prototype.a=null;var se,ue={OPEN:\"a\",ib:\"b\",Na:\"c\",rb:\"d\"};function ce(){it.call(this,\"d\")}function he(){it.call(this,\"c\")}function le(){}function fe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Qt(this),this.O=pe,t=Q?125:void 0,this.P=new Ft(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}T(ce,it),T(he,it),T(le,ie),se=new le;var pe=45e3,de={},me={};function ye(t,e,n){t.F=1,t.f=Be(Pe(e)),t.l=n,t.H=!0,ve(t,null)}function ge(t,e,n,r){t.F=1,t.f=Be(Pe(e)),t.l=null,t.H=n,ve(t,r)}function ve(t,e){t.v=E(),Ee(t),t.D=Pe(t.f),Ue(t.D,\"t\",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new jt(b(t.Ka,t,t.a),t.J)),Gt(t.I,t.a,\"readystatechange\",t.eb),e=t.h?x(t.h):{},t.l?(t.w||(t.w=\"POST\"),e[\"Content-Type\"]=\"application/x-www-form-urlencoded\",t.a.ca(t.D,t.w,t.l,e)):(t.w=\"GET\",t.a.ca(t.D,t.w,null,e)),Jt(1)}function be(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=we(t,n);if(i==me){4==e&&(t.c=4,Zt(14),r=!1);break}if(i==de){t.c=4,Zt(15),r=!1;break}_e(t,i)}4==e&&0==n.length&&(t.c=1,Zt(16),r=!1),t.b=t.b&&r,r||(Ce(t),Se(t))}function we(t,e){var n=t.A,r=e.indexOf(\"\\n\",n);return-1==r?me:(n=Number(e.substring(n,r)),isNaN(n)?de:(r+=1)+n>e.length?me:(e=e.substr(r,n),t.A=r+n,e))}function Ee(t){t.R=E()+t.O,Te(t,t.O)}function Te(t,e){if(null!=t.i)throw Error(\"WatchDog timer not null\");t.i=ee(b(t.bb,t),e)}function Ie(t){t.i&&(a.clearTimeout(t.i),t.i=null)}function Se(t){t.g.Da()||t.m||t.g.na(t)}function Ce(t){Ie(t);var e=t.B;e&&\"function\"==typeof e.la&&e.la(),t.B=null,Ut(t.P),zt(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function _e(t,e){try{t.g.Ga(t,e),Jt(4)}catch(n){}}function Ae(t,e){if(t.forEach&&\"function\"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||s(t))C(t,e,void 0);else{if(t.K&&\"function\"==typeof t.K)var n=t.K();else if(t.C&&\"function\"==typeof t.C)n=void 0;else if(p(t)||s(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&\"function\"==typeof t.C)return t.C();if(s(t))return t.split(\"\");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ne(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error(\"Uneven number of arguments\");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ne)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function De(t,e){Oe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ke(t))}function ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Oe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Oe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(r=fe.prototype).setTimeout=function(t){this.O=t},r.eb=function(t){t=t.target;var e=this.B;e&&3==Pn(t)?e.Ua():this.Ka(t)},r.Ka=function(t){try{if(t==this.a)t:{var e=Pn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!Q&&!this.a.aa())){this.m||4!=e||7==n||Jt(8==n||0>=r?3:2),Ie(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=Ln(this.a,\"X-HTTP-Initial-Response\");if(a&&!N(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,Zt(12),Ce(this),Se(this);break t}this.s=!0,_e(this,s)}this.H?(be(this,e,o),Q&&this.b&&3==e&&(Gt(this.I,this.P,\"tick\",this.cb),this.P.start())):_e(this,o),4==e&&Ce(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ee(this)))}else 400==i&&0<o.indexOf(\"Unknown SID\")?(this.c=3,Zt(12)):(this.c=0,Zt(13)),Ce(this),Se(this)}}}catch(u){}},r.cb=function(){if(this.a){var t=Pn(this.a),e=this.a.aa();this.A<e.length&&(Ie(this),be(this,t,e),this.b&&4!=t&&Ee(this))}},r.cancel=function(){this.m=!0,Ce(this)},r.bb=function(){this.i=null;var t=E();0<=t-this.R?(2!=this.F&&(Jt(3),Zt(17)),Ce(this),this.c=2,Se(this)):Te(this,this.R-t)},(r=Ne.prototype).C=function(){ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},r.K=function(){return ke(this),this.a.concat()},r.get=function(t,e){return Oe(this.b,t)?this.b[t]:e},r.set=function(t,e){Oe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},r.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Re=/^(?:([^:\\/?#.]+):)?(?:\\/\\/(?:([^\\/?#]*)@)?([^\\/#?]*?)(?::([0-9]+))?(?=[\\/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;function Me(t,e){var n;this.b=this.j=this.f=\"\",this.i=null,this.g=this.a=\"\",this.h=!1,t instanceof Me?(this.h=void 0!==e?e:t.h,Le(this,t.f),this.j=t.j,xe(this,t.b),qe(this,t.i),this.a=t.a,Ve(this,en(t.c)),this.g=t.g):t&&(n=String(t).match(Re))?(this.h=!!e,Le(this,n[1]||\"\",!0),this.j=je(n[2]||\"\"),xe(this,n[3]||\"\",!0),qe(this,n[4]),this.a=je(n[5]||\"\",!0),Ve(this,n[6]||\"\",!0),this.g=je(n[7]||\"\")):(this.h=!!e,this.c=new Xe(null,this.h))}function Pe(t){return new Me(t)}function Le(t,e,n){t.f=n?je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,\"\"))}function xe(t,e,n){t.b=n?je(e,!0):e}function qe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error(\"Bad port number \"+e);t.i=e}else t.i=null}function Ve(t,e,n){e instanceof Xe?(t.c=e,function(t,e){e&&!t.f&&(Je(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&($e(this,e),tn(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=Ke(e,He)),t.c=new Xe(e,t.h))}function Fe(t,e,n){t.c.set(e,n)}function Ue(t,e,n){f(n)||(n=[String(n)]),tn(t.c,e,n)}function Be(t){return Fe(t,\"zx\",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^E()).toString(36)),t}function je(t,e){return t?e?decodeURI(t.replace(/%25/g,\"%2525\")):decodeURIComponent(t):\"\"}function Ke(t,e,n){return s(t)?(t=encodeURI(t).replace(e,Qe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),t):null}function Qe(t){return\"%\"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Me.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ke(e,We,!0),\":\");var n=this.b;return(n||\"file\"==e)&&(t.push(\"//\"),(e=this.j)&&t.push(Ke(e,We,!0),\"@\"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(n=this.i)&&t.push(\":\",String(n))),(n=this.a)&&(this.b&&\"/\"!=n.charAt(0)&&t.push(\"/\"),t.push(Ke(n,\"/\"==n.charAt(0)?ze:Ge,!0))),(n=this.c.toString())&&t.push(\"?\",n),(n=this.g)&&t.push(\"#\",Ke(n,Ye)),t.join(\"\")},Me.prototype.resolve=function(t){var e=Pe(this),n=!!t.f;n?Le(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?xe(e,t.b):n=null!=t.i;var r=t.a;if(n)qe(e,t.i);else if(n=!!t.a){if(\"/\"!=r.charAt(0))if(this.b&&!this.a)r=\"/\"+r;else{var i=e.a.lastIndexOf(\"/\");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(\"..\"==(i=r)||\".\"==i)r=\"\";else if(O(i,\"./\")||O(i,\"/.\")){r=0==i.lastIndexOf(\"/\",0),i=i.split(\"/\");for(var o=[],a=0;a<i.length;){var s=i[a++];\".\"==s?r&&a==i.length&&o.push(\"\"):\"..\"==s?((1<o.length||1==o.length&&\"\"!=o[0])&&o.pop(),r&&a==i.length&&o.push(\"\")):(o.push(s),r=!0)}r=o.join(\"/\")}else r=i}return n?e.a=r:n=\"\"!==t.c.toString(),n?Ve(e,en(t.c)):n=!!t.g,n&&(e.g=t.g),e};var We=/[#\\/\\?@]/g,Ge=/[#\\?:]/g,ze=/[#\\?]/g,He=/[#\\?@]/g,Ye=/#/g;function Xe(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Je(t){t.a||(t.a=new Ne,t.b=0,t.c&&function(t,e){if(t){t=t.split(\"&\");for(var n=0;n<t.length;n++){var r=t[n].indexOf(\"=\"),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\\+/g,\" \")):\"\")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\\+/g,\" \")),n)}))}function $e(t,e){Je(t),e=nn(t,e),Oe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,De(t.a,e))}function Ze(t,e){return Je(t),e=nn(t,e),Oe(t.a.b,e)}function tn(t,e,n){$e(t,e),0<n.length&&(t.c=null,t.a.set(nn(t,e),A(n)),t.b+=n.length)}function en(t){var e=new Xe;return e.c=t.c,t.a&&(e.a=new Ne(t.a),e.b=t.b),e}function nn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function rn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function on(t){var e=t.a.F.a;if(null!=e)Zt(4),e?(Zt(10),zn(t.a,t,!1)):(Zt(11),zn(t.a,t,!0));else{t.b=new fe(t,void 0,void 0),t.b.h=t.h,e=$n(e=t.a,e.Y()?t.f:null,t.i),Zt(4),Ue(e,\"TYPE\",\"xmlhttp\");var n=t.a.j,r=t.a.I;n&&r&&Fe(e,n,r),ge(t.b,e,!1,t.f)}}function an(){this.a=this.b=null}function sn(){this.a=new Ne}function un(t){var e=typeof t;return\"object\"==e&&t||\"function\"==e?\"o\"+(t[m]||(t[m]=++y)):e.charAt(0)+t}function cn(t,e){this.b=t,this.a=e}function hn(t){this.g=t||ln,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType(\"navigation\")).length&&(\"hq\"==t[0].nextHopProtocol||\"h2\"==t[0].nextHopProtocol):t=!!(a.ka&&a.ka.Ea&&a.ka.Ea()&&a.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new sn),this.b=null,this.c=[]}(r=Xe.prototype).add=function(t,e){Je(this),this.c=null,t=nn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},r.forEach=function(t,e){Je(this),this.a.forEach(function(n,r){C(n,function(n){t.call(e,n,r,this)},this)},this)},r.K=function(){Je(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.C=function(t){Je(this);var e=[];if(s(t))Ze(this,t)&&(e=_(e,this.a.get(nn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=_(e,t[n])}return e},r.set=function(t,e){return Je(this),this.c=null,Ze(this,t=nn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},r.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},r.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;\"\"!==r[o]&&(a+=\"=\"+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join(\"&\")},T(function(){},function(){}),(r=rn.prototype).M=null,r.$=function(t){return this.a.$(t)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Da=function(){return!1},r.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Ln(t,\"X-Client-Wire-Protocol\");this.l=n||null,this.a.j&&(t=Ln(t,\"X-HTTP-Session-Id\"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){return(e=this.a).m=this.c,void Xn(e,2)}this.f=r[0]}else(e=this.a).m=this.c,Xn(e,2)}else 1==this.M&&(this.g?Zt(6):\"11111\"==e?(Zt(5),this.g=!0,(!j||10<=Number(J))&&(this.c=200,this.b.cancel(),Zt(11),zn(this.a,this,!0))):(Zt(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,on(this)):1==this.M&&(this.g?(Zt(11),zn(this.a,this,!0)):(Zt(10),zn(this.a,this,!1)));else{0==this.M?Zt(8):1==this.M&&Zt(9);var t=this.a;t.m=this.c,Xn(t,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},sn.prototype.add=function(t){this.a.set(un(t),t)},sn.prototype.C=function(){return this.a.C()};var ln=10;function fn(t,e){!t.a&&(O(e,\"spdy\")||O(e,\"quic\")||O(e,\"h2\"))&&(t.f=t.g,t.a=new sn,t.b&&(yn(t,t.b),t.b=null))}function pn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function dn(t){return t.b?1:t.a?t.a.a.c:0}function mn(t,e){return t.b?t=t.b==e:t.a?(e=un(e),t=Oe(t.a.a.b,e)):t=!1,t}function yn(t,e){t.a?t.a.add(e):t.b=e}function gn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=un(e),n=Oe(t.a.a.b,n)),n&&De(t.a.a,un(e)))}function vn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return C(t.a.C(),function(t){e=e.concat(t.j)}),e}return A(t.c)}function bn(){}function wn(){this.a=new bn}function En(t,e,n){var r=n||\"\";try{Ae(t,function(t,n){var i=t;d(t)&&(i=At(t)),e.push(r+n+\"=\"+encodeURIComponent(i))})}catch(i){throw e.push(r+\"type=\"+encodeURIComponent(\"_badmap\")),i}}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}hn.prototype.cancel=function(){var t;this.c=vn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(C(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},bn.prototype.stringify=function(t){return a.JSON.stringify(t,void 0)},bn.prototype.parse=function(t){return a.JSON.parse(t,void 0)};var In=a.JSON.parse;function Sn(t){Ct.call(this),this.headers=new Ne,this.H=t||null,this.b=!1,this.s=this.a=null,this.A=\"\",this.h=0,this.f=\"\",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}T(Sn,Ct);var Cn=\"\",_n=/^https?$/i,An=[\"POST\",\"PUT\"];function Nn(t){return\"content-type\"==t.toLowerCase()}function Dn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,kn(t),Rn(t)}function kn(t){t.v||(t.v=!0,t.dispatchEvent(\"complete\"),t.dispatchEvent(\"error\"))}function On(t){if(t.b&&\"undefined\"!=typeof o&&(!t.s[1]||4!=Pn(t)||2!=t.T()))if(t.l&&4==Pn(t))Bt(t.Fa,0,t);else if(t.dispatchEvent(\"readystatechange\"),4==Pn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.A).match(Re)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!_n.test(s?s.toLowerCase():\"\")}e=i}e?(t.dispatchEvent(\"complete\"),t.dispatchEvent(\"success\")):(t.h=6,t.f=t.za()+\" [\"+t.T()+\"]\",kn(t))}finally{Rn(t)}}}function Rn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent(\"ready\");try{n.onreadystatechange=r}catch(i){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(a.clearTimeout(t.m),t.m=null)}function Pn(t){return t.a?t.a.readyState:0}function Ln(t,e){return t.a?t.a.getResponseHeader(e):null}function xn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e=\"\";return L(t,function(t,n){e+=n,e+=\":\",e+=t,e+=\"\\r\\n\"}),e}(n),s(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?\"=\"+encodeURIComponent(String(n)):\"\"){if(0>(n=t.indexOf(\"#\"))&&(n=t.length),0>(r=t.indexOf(\"?\"))||r>n){r=n;var i=\"\"}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+\"&\"+e:e:n,t=t[0]+(t[1]?\"?\"+t[1]:\"\")+t[2]}return t}return Fe(t,e,n),t}function qn(t){this.f=[],this.F=new an,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!c(\"internalChannelParams.failFast\",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=c(\"internalChannelParams.baseRetryDelayMs\",t)||5e3,this.Sa=c(\"internalChannelParams.retryDelaySeedMs\",t)||1e4,this.Qa=c(\"internalChannelParams.forwardChannelMaxRetries\",t)||2,this.qa=c(\"internalChannelParams.forwardChannelRequestTimeoutMs\",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H=\"\",this.b=new hn(t&&t.concurrentRequestLimit),this.ja=new wn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Vn(t){if(Fn(t),3==t.u){var e=t.P++,n=Pe(t.B);Fe(n,\"SID\",t.H),Fe(n,\"RID\",e),Fe(n,\"TYPE\",\"terminate\"),Kn(t,n),(e=new fe(t,e,void 0)).F=2,e.f=Be(Pe(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(e.f.toString(),\"\")),!n&&a.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=E(),Ee(e)}Jn(t)}function Fn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(a.clearTimeout(t.l),t.l=null),Hn(t),t.b.cancel(),t.h&&(u(t.h)&&a.clearTimeout(t.h),t.h=null)}function Un(t,e){t.f.push(new cn(t.Ra++,e)),3==t.u&&Bn(t)}function Bn(t){pn(t.b)||t.h||(t.h=!0,Lt(t.Ia,t),t.A=0)}function jn(t,e){var n;n=e?e.W:t.P++;var r=Pe(t.B);Fe(r,\"SID\",t.H),Fe(r,\"RID\",n),Fe(r,\"AID\",t.O),Kn(t,r),t.g&&t.i&&xn(r,t.g,t.i),n=new fe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),yn(t.b,n),ye(n,r,e)}function Kn(t,e){t.c&&Ae({},function(t,n){Fe(e,n,t)})}function Qn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?b(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=[\"count=\"+n];-1==o?0<n?(o=i[0].b,a.push(\"ofs=\"+o)):o=0:a.push(\"ofs=\"+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{En(h,a,\"req\"+c+\"_\")}catch(l){r&&r(h)}}if(s){r=a.join(\"&\");break t}}return t=t.f.splice(0,n),e.j=t,r}function Wn(t){t.a||t.l||(t.S=1,Lt(t.Ha,t),t.v=0)}function Gn(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ee(b(t.Ha,t),Yn(t,t.v)),t.v++,!0)}function zn(t,e,n){var r=e.l;r&&fn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=$n(t,null,t.ha),Bn(t)}function Hn(t){null!=t.s&&(a.clearTimeout(t.s),t.s=null)}function Yn(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function Xn(t,e){if(2==e){var n=null;t.c&&(n=null);var r=b(t.fb,t);n||(n=new Me(\"//www.google.com/images/cleardot.gif\"),a.location&&\"http\"==a.location.protocol||Le(n,\"https\"),Be(n)),function(t,e){var n=new Ht;if(a.Image){var r=new Image;r.onload=w(Tn,n,r,\"TestLoadImage: loaded\",!0,e),r.onerror=w(Tn,n,r,\"TestLoadImage: error\",!1,e),r.onabort=w(Tn,n,r,\"TestLoadImage: abort\",!1,e),r.ontimeout=w(Tn,n,r,\"TestLoadImage: timeout\",!1,e),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Zt(2);t.u=0,t.c&&t.c.ta(e),Jn(t),Fn(t)}function Jn(t){t.u=0,t.m=-1,t.c&&(0==vn(t.b).length&&0==t.f.length||(t.b.c.length=0,A(t.f),t.f.length=0),t.c.sa())}function $n(t,e,n){var r=function(t){return t instanceof Me?Pe(t):new Me(t,void 0)}(n);if(\"\"!=r.b)e&&xe(r,e+\".\"+r.b),qe(r,r.i);else{var i,o=a.location;i=e?e+\".\"+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Me(null,void 0);return t&&Le(i,t),e&&xe(i,e),n&&qe(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&L(t.V,function(t,e){Fe(r,e,t)}),e=t.j,n=t.I,e&&n&&Fe(r,e,n),Fe(r,\"VER\",t.wa),Kn(t,r),r}function Zn(){}function tr(){if(j&&!(10<=Number(J)))throw Error(\"Environmental error: no available transport.\")}function er(t,e){Ct.call(this),this.a=new qn(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf(\"/\",0)?e=i:((r=\"\"==e)||(r=0<=(r=e.length-1)&&e.indexOf(\"/\",r)==r),e+=r?i:\"/\"+i)}return e}(this.g,\"test\"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t[\"X-Client-Protocol\"]=\"webchannel\":t={\"X-Client-Protocol\":\"webchannel\"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t[\"X-WebChannel-Content-Type\"]=e.messageContentType:t={\"X-WebChannel-Content-Type\":e.messageContentType}),e&&e.xa&&(t?t[\"X-WebChannel-Client-Profile\"]=e.xa:t={\"X-WebChannel-Client-Profile\":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!N(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!N(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new ir(this)}function nr(t){ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){he.call(this),this.status=1}function ir(t){this.a=t}(r=Sn.prototype).ca=function(t,e,n,r){if(this.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.A+\"; newUri=\"+t);e=e?e.toUpperCase():\"GET\",this.A=t,this.f=\"\",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?oe(this.H):oe(se),this.a.onreadystatechange=b(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void Dn(this,o)}t=n||\"\";var i=new Ne(this.headers);r&&Ae(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Nn,n=t.length,r=s(t)?t.split(\"\"):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}(i.K()),n=a.FormData&&t instanceof a.FormData,!(0<=S(An,e))||r||n||i.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),\"withCredentials\"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=function(t){return j&&Z(9)&&u(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.Ca,this)):this.m=Bt(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Dn(this,o)}},r.Ca=function(){\"undefined\"!=typeof o&&this.a&&(this.f=\"Timed out after \"+this.o+\"ms, aborting\",this.h=8,this.dispatchEvent(\"timeout\"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),Rn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Rn(this,!0)),Sn.N.G.call(this)},r.Fa=function(){this.j||(this.w||this.l||this.g?On(this):this.$a())},r.$a=function(){On(this)},r.T=function(){try{return 2<Pn(this)?this.a.status:-1}catch(t){return-1}},r.za=function(){try{return 2<Pn(this)?this.a.statusText:\"\"}catch(t){return\"\"}},r.aa=function(){try{return this.a?this.a.responseText:\"\"}catch(t){return\"\"}},r.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),In(e)}},r.ya=function(){return this.h},r.Ya=function(){return s(this.f)?this.f:String(this.f)},(r=qn.prototype).wa=8,r.u=1,r.Da=function(){return 0==this.u},r.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new fe(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?V(r=x(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o=\"__data__\"in o.a&&s(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),Fe(i=Pe(this.B),\"RID\",t),Fe(i,\"CVER\",22),this.o&&this.j&&Fe(i,\"X-HTTP-Session-Id\",this.j),Kn(this,i),this.g&&r&&xn(i,this.g,r),yn(this.b,n),this.W?(Fe(i,\"$req\",e),Fe(i,\"SID\",\"null\"),n.S=!0,ye(n,i,null)):ye(n,i,e),this.u=2}}else 3==this.u&&(t?jn(this,t):0==this.f.length||pn(this.b)||jn(this))},r.Ha=function(){this.l=null,this.a=new fe(this,\"rpc\",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Pe(this.pa);Fe(t,\"RID\",\"rpc\"),Fe(t,\"SID\",this.H),Fe(t,\"CI\",this.ia?\"0\":\"1\"),Fe(t,\"AID\",this.O),Kn(this,t),Fe(t,\"TYPE\",\"xmlhttp\"),this.g&&this.i&&xn(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),ge(this.a,t,!0,this.ga)},r.Ga=function(t,e){if(0!=this.u&&(this.a==t||mn(this.b,t)))if(this.m=t.o,!t.s&&mn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(f(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Hn(this),this.a.cancel(),this.a=null}Gn(this),Zt(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ee(b(this.Za,this),6e3));if(1>=dn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else Xn(this,11)}else if((t.s||this.a==t)&&Hn(this),!N(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if(\"c\"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Ln(r,\"X-Client-Wire-Protocol\"))&&fn(this.b,i),this.j&&(r=Ln(r,\"X-HTTP-Session-Id\")))&&(this.I=r,Fe(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=$n(this,this.Y()?this.ga:null,this.ha),r.s?(gn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ie(r),Ee(r)),this.a=r):Wn(this),0<this.f.length&&Bn(this)}else\"stop\"!=r[0]&&\"close\"!=r[0]||Xn(this,7);else 3==this.u&&(\"stop\"==r[0]||\"close\"==r[0]?\"stop\"==r[0]?Xn(this,7):Vn(this):\"noop\"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Gn(this),Zt(19))},r.na=function(t){var e=null;if(this.a==t){Hn(this),this.a=null;var n=2}else{if(!mn(this.b,t))return;e=t.j,gn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=E()-t.v,Yt.dispatchEvent(new te(Yt,t.l?t.l.length:0,e,this.A)),Bn(this)):Wn(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(dn(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Pa?0:t.Qa))&&(t.h=ee(b(t.Ia,t,e),Yn(t,t.A)),t.A++,!0))}(this,t)||2==n&&Gn(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:Xn(this,5);break;case 4:Xn(this,10);break;case 3:Xn(this,6);break;default:Xn(this,2)}}},r.fb=function(t){Zt(t?2:1)},r.$=function(t){if(t&&!this.R)throw Error(\"Can't create secondary domain capable XhrIo object.\");return(t=new Sn(this.La)).F=this.R,t},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=Zn.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Ta=function(){},tr.prototype.a=function(t,e){return new er(t,e)},T(er,Ct),(r=er.prototype).addEventListener=function(t,e,n,r){er.N.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){er.N.removeEventListener.call(this,t,e,n,r)},r.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Zt(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new rn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=xn(e,t.g,t.i)),(t=t.w).i=n,e=$n(t.a,null,t.i),Zt(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,on(t)):(Ue(e,\"MODE\",\"init\"),!t.a.o&&t.a.j&&Ue(e,\"X-HTTP-Session-Id\",t.a.j),t.b=new fe(t,void 0,void 0),t.b.h=t.h,ge(t.b,e,!1,null),t.M=0)},r.close=function(){Vn(this.a)},r.Xa=function(t){if(s(t)){var e={};e.__data__=t,Un(this.a,e)}else this.h?((e={}).__data__=At(t),Un(this.a,e)):Un(this.a,t)},r.G=function(){this.a.c=null,delete this.f,Vn(this.a),delete this.a,er.N.G.call(this)},T(nr,ce),T(rr,he),T(ir,Zn),ir.prototype.va=function(){this.a.dispatchEvent(\"a\")},ir.prototype.ua=function(t){this.a.dispatchEvent(new nr(t))},ir.prototype.ta=function(t){this.a.dispatchEvent(new rr(t))},ir.prototype.sa=function(){this.a.dispatchEvent(\"b\")};var or=w(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},tr);tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.Xa,er.prototype.open=er.prototype.Wa,er.prototype.close=er.prototype.close,ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,re.COMPLETE=\"complete\",ae.EventType=ue,ue.OPEN=\"a\",ue.CLOSE=\"b\",ue.ERROR=\"c\",ue.MESSAGE=\"d\",Ct.prototype.listen=Ct.prototype.Aa,Sn.prototype.listenOnce=Sn.prototype.Ba,Sn.prototype.getLastError=Sn.prototype.Ya,Sn.prototype.getLastErrorCode=Sn.prototype.ya,Sn.prototype.getStatus=Sn.prototype.T,Sn.prototype.getStatusText=Sn.prototype.za,Sn.prototype.getResponseJson=Sn.prototype.Va,Sn.prototype.getResponseText=Sn.prototype.aa,Sn.prototype.send=Sn.prototype.ca;var ar={createWebChannelTransport:or,ErrorCode:ne,EventType:re,WebChannel:ae,XhrIo:Sn},sr=ar.createWebChannelTransport,ur=ar.ErrorCode,cr=ar.EventType,hr=ar.WebChannel,lr=ar.XhrIo;e.default=ar},xQ8M:function(t,e){t.exports=function(t){var e=typeof t;return!!t&&(\"object\"==e||\"function\"==e)}},zVF4:function(t,e,n){\"use strict\";(function(t){Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(\"mrSG\"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:\"${JSCORE_VERSION}\"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error(\"Firebase Database (\"+i.SDK_VERSION+\") INTERNAL ASSERT FAILED: \"+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+\"+/=\"},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+\"-_.\"},HAS_NATIVE_SUPPORT:\"function\"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error(\"encodeByteArray takes an array as a parameter\");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join(\"\")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join(\"\")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var h=a<<4&240|s>>2;if(r.push(h),64!==u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return u.decodeString(t,!0)}catch(e){console.error(\"base64Decode failed: \",e)}return null};function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}var l=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),\"function\"===typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function f(){return\"undefined\"!==typeof navigator&&\"string\"===typeof navigator.userAgent?navigator.userAgent:\"\"}var p=\"FirebaseError\",d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=p,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+\"/\"+t,o=this.errors[t],a=o?function(t,e){return t.replace(y,function(t,n){var r=e[n];return null!=r?r.toString():\"<\"+n+\"?>\"})}(o,r):\"Error\",s=this.serviceName+\": \"+a+\" (\"+i+\").\",u=new d(i,s),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];\"_\"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field \"'+l+'\" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();var y=/\\{\\$([^}]+)}/g;function g(t){return JSON.parse(t)}var v=function(t){var e={},n={},r={},i=\"\";try{var o=t.split(\".\");e=g(c(o[0])||\"\"),n=g(c(o[1])||\"\"),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}};var b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if(\"string\"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if(\"string\"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error(\"Missing Observer.\");void 0===(r=function(t,e){if(\"object\"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&\"function\"===typeof t[i])return!0}return!1}(t,[\"next\",\"error\",\"complete\"])?t:{next:t,error:e,complete:n}).next&&(r.next=E),void 0===r.error&&(r.error=E),void 0===r.complete&&(r.complete=E);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){\"undefined\"!==typeof console&&console.error&&console.error(r)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function E(){}function T(t,e,n){var r=\"\";switch(e){case 1:r=n?\"first\":\"First\";break;case 2:r=n?\"second\":\"Second\";break;case 3:r=n?\"third\":\"Third\";break;case 4:r=n?\"fourth\":\"Fourth\";break;default:throw new Error(\"errorPrefix called with argumentNumber > 4.  Need to update it?\")}var i=t+\" failed: \";return i+=r+\" argument \"}e.CONSTANTS=i,e.Deferred=l,e.ErrorFactory=m,e.FirebaseError=d,e.Sha1=b,e.assert=o,e.assertionError=a,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=u,e.base64Decode=c,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=v,e.deepCopy=function(t){return h(void 0,t)},e.deepExtend=h,e.errorPrefix=T,e.getUA=f,e.isAdmin=function(t){var e=v(t).claims;return\"object\"===typeof e&&!0===e.admin},e.isBrowser=function(){return\"object\"===typeof self&&self.self===self},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isMobileCordova=function(){return!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=function(){try{return\"[object process]\"===Object.prototype.toString.call(t.process)}catch(e){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return\"object\"===typeof navigator&&\"ReactNative\"===navigator.product},e.isValidFormat=function(t){var e=v(t).claims;return!!e&&\"object\"===typeof e&&e.hasOwnProperty(\"iat\")},e.isValidTimestamp=function(t){var e=v(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return\"object\"===typeof e&&(e.hasOwnProperty(\"nbf\")?r=e.nbf:e.hasOwnProperty(\"iat\")&&(r=e.iat),i=e.hasOwnProperty(\"exp\")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=v(t).claims;return\"object\"===typeof e&&e.hasOwnProperty(\"iat\")?e.iat:null},e.jsonEval=g,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?\"&\"+e.join(\"&\"):\"\"},e.querystringDecode=function(t){var e={};return t.replace(/^\\?/,\"\").split(\"&\").forEach(function(t){if(t){var n=t.split(\"=\");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;o(++r<t.length,\"Surrogate pair missing trail surrogate.\"),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i=\"at least \"+e:r>n&&(i=0===n?\"none\":\"no more than \"+n),i)throw new Error(t+\" failed: Was called with \"+r+(1===r?\" argument.\":\" arguments.\")+\" Expects \"+i+\".\")},e.validateCallback=function(t,e,n,r){if((!r||n)&&\"function\"!==typeof n)throw new Error(T(t,e,r)+\"must be a valid function.\")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&(\"object\"!==typeof n||null===n))throw new Error(T(t,e,r)+\"must be a valid context object.\")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&\"string\"!==typeof n)throw new Error(T(t,e,r)+\"must be a valid firebase namespace.\")}}).call(this,n(\"yLpj\"))}},[[\"vlRD\",1,0,6]]]);"}